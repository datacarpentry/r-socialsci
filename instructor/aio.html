<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>R for Social Scientists: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/dc/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicons/dc/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicons/dc/favicon-16x16.png">
<link rel="manifest" href="../favicons/dc/site.webmanifest">
<link rel="mask-icon" href="../favicons/dc/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav data"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="dc-logo" alt="Data Carpentry" src="../assets/images/data-logo.svg">
</div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav data" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Data Carpentry" src="../assets/images/data-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      R for Social Scientists
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            R for Social Scientists
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="reference.html"></a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  R for Social Scientists
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress data">
    <div class="progress-bar data" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-intro.html">1. Before we Start</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="01-intro-to-r.html">2. Introduction to R</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="02-starting-with-data.html">3. Starting with Data</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="03-dplyr.html">4. Data Wrangling with dplyr</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="04-tidyr.html">5. Data Wrangling with tidyr</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="05-ggplot2.html">6. Data Visualisation with ggplot2</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="06-rmarkdown.html">7. Getting started with R Markdown (Optional)</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="07-json.html">8. Processing JSON data (Optional)</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="reference.html"></a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-00-intro"><p>Content from <a href="00-intro.html">Before we Start</a></p>
<hr>
<p>Last updated on 2025-07-01 |

        <a href="https://github.com/datacarpentry/r-socialsci/edit/main/episodes/00-intro.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<ul>
<li>The main goal here is to help the learners be comfortable with the
RStudio interface.</li>
<li>Go very slowly in the “Getting set up” section. Make sure everyone
is following along (remind learners to use the stickies). Plan with the
helpers at this point to go around the room, and be available to help.
It’s important to make sure that learners are in the correct working
directory, and that they create a <code>data</code> (all lowercase)
subfolder.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How to find your way around RStudio?</li>
<li>How to interact with R?</li>
<li>How to manage your environment?</li>
<li>How to install packages?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Install latest version of R.</li>
<li>Install latest version of RStudio.</li>
<li>Navigate the RStudio GUI.</li>
<li>Install additional packages using the packages tab.</li>
<li>Install additional packages using R code.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="what-is-r-what-is-rstudio">What is R? What is RStudio?<a class="anchor" aria-label="anchor" href="#what-is-r-what-is-rstudio"></a>
</h2>
<hr class="half-width">
<p>The term “<code>R</code>” is used to refer to both the programming
language and the software that interprets the scripts written using
it.</p>
<p><a href="https://rstudio.com" class="external-link">RStudio</a> is currently a very popular
way to not only write your R scripts but also to interact with the R
software. To function correctly, RStudio needs R and therefore both need
to be installed on your computer.</p>
<p>To make it easier to interact with R, we will use RStudio. RStudio is
the most popular IDE (Integrated Development Environment) for R. An IDE
is a piece of software that provides tools to make programming
easier.</p>
<p>You can also use the R Presentations feature to present your work in
an HTML5 presentation mixing Markdown and R code. You can display these
within R Studio or your browser. There are many options for customising
your presentation slides, including an option for showing LaTeX
equations. This can help you collaborate with others and also has an
application in teaching and classroom use.</p>
</section><section><h2 class="section-heading" id="why-learn-r">Why learn R?<a class="anchor" aria-label="anchor" href="#why-learn-r"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="r-does-not-involve-lots-of-pointing-and-clicking-and-thats-a-good-thing">R does not involve lots of pointing and clicking, and that’s a good
thing<a class="anchor" aria-label="anchor" href="#r-does-not-involve-lots-of-pointing-and-clicking-and-thats-a-good-thing"></a>
</h3>
<p>The learning curve might be steeper than with other software but with
R, the results of your analysis do not rely on remembering a succession
of pointing and clicking, but instead on a series of written commands,
and that’s a good thing! So, if you want to redo your analysis because
you collected more data, you don’t have to remember which button you
clicked in which order to obtain your results; you just have to run your
script again.</p>
<p>Working with scripts makes the steps you used in your analysis clear,
and the code you write can be inspected by someone else who can give you
feedback and spot mistakes.</p>
<p>Working with scripts forces you to have a deeper understanding of
what you are doing, and facilitates your learning and comprehension of
the methods you use.</p>
</div>
<div class="section level3">
<h3 id="r-code-is-great-for-reproducibility">R code is great for reproducibility<a class="anchor" aria-label="anchor" href="#r-code-is-great-for-reproducibility"></a>
</h3>
<p>Reproducibility is when someone else (including your future self) can
obtain the same results from the same dataset when using the same
analysis.</p>
<p>R integrates with other tools to generate manuscripts from your code.
If you collect more data, or fix a mistake in your dataset, the figures
and the statistical tests in your manuscript are updated
automatically.</p>
<p>An increasing number of journals and funding agencies expect analyses
to be reproducible, so knowing R will give you an edge with these
requirements.</p>
<p>To further support reproducibility and transparency, there are also
packages that help you with dependency management: keeping track of
which packages we are loading and how they depend on the package version
you are using. This helps you make sure existing workflows work
consistently and continue doing what they did before.</p>
<p>Packages like renv let you “save” and “load” the state of your
project library, also keeping track of the package version you use and
the source it can be retrieved from.</p>
</div>
<div class="section level3">
<h3 id="r-is-interdisciplinary-and-extensible">R is interdisciplinary and extensible<a class="anchor" aria-label="anchor" href="#r-is-interdisciplinary-and-extensible"></a>
</h3>
<p>With 10,000+ packages that can be installed to extend its
capabilities, R provides a framework that allows you to combine
statistical approaches from many scientific disciplines to best suit the
analytical framework you need to analyze your data. For instance, R has
packages for image analysis, GIS, time series, population genetics, and
a lot more.</p>
</div>
<div class="section level3">
<h3 id="r-works-on-data-of-all-shapes-and-sizes">R works on data of all shapes and sizes<a class="anchor" aria-label="anchor" href="#r-works-on-data-of-all-shapes-and-sizes"></a>
</h3>
<p>The skills you learn with R scale easily with the size of your
dataset. Whether your dataset has hundreds or millions of lines, it
won’t make much difference to you.</p>
<p>R is designed for data analysis. It comes with special data
structures and data types that make handling of missing data and
statistical factors convenient.</p>
<p>R can connect to spreadsheets, databases, and many other data
formats, on your computer or on the web.</p>
</div>
<div class="section level3">
<h3 id="r-produces-high-quality-graphics">R produces high-quality graphics<a class="anchor" aria-label="anchor" href="#r-produces-high-quality-graphics"></a>
</h3>
<p>The plotting functionalities in R are endless, and allow you to
adjust any aspect of your graph to convey most effectively the message
from your data.</p>
</div>
<div class="section level3">
<h3 id="r-has-a-large-and-welcoming-community">R has a large and welcoming community<a class="anchor" aria-label="anchor" href="#r-has-a-large-and-welcoming-community"></a>
</h3>
<p>Thousands of people use R daily. Many of them are willing to help you
through mailing lists and websites such as <a href="https://stackoverflow.com/" class="external-link">Stack Overflow</a>, or on the <a href="https://community.rstudio.com/" class="external-link">RStudio community</a>. Questions
which are backed up with <a href="https://www.tidyverse.org/help/" class="external-link">short, reproducible code
snippets</a> are more likely to attract knowledgeable responses.</p>
</div>
<div class="section level3">
<h3 id="not-only-is-r-free-but-it-is-also-open-source-and-cross-platform">Not only is R free, but it is also open-source and
cross-platform<a class="anchor" aria-label="anchor" href="#not-only-is-r-free-but-it-is-also-open-source-and-cross-platform"></a>
</h3>
<p>Anyone can inspect the source code to see how R works. Because of
this transparency, there is less chance for mistakes, and if you (or
someone else) find some, you can report and fix bugs.</p>
<p>Because R is open source and is supported by a large community of
developers and users, there is a very large selection of third-party
add-on packages which are freely available to extend R’s native
capabilities.</p>
<figure><div class="row">
<div class="col-md-6">
<figure><img src="../fig/r-manual.jpeg" alt="RStudio extends what R can do, and makes it easier to write R code and interact with R." width="100%" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="col-md-6">
<figure><img src="../fig/r-automatic.jpeg" alt="automatic car gear shift representing the ease of RStudio" width="100%" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
<figcaption><p>RStudio extends what R can do, and makes it easier to write R code
and interact with R.
<a href="https://unsplash.com/photos/D19rXKDUPYM" class="external-link">Left photo credit</a>;
<a href="https://unsplash.com/photos/Wec3M4dY_LE" class="external-link">Right photo
credit</a>.</p>
</figcaption></figure>
</div>
</section><section><h2 class="section-heading" id="a-tour-of-rstudio">A tour of RStudio<a class="anchor" aria-label="anchor" href="#a-tour-of-rstudio"></a>
</h2>
<hr class="half-width"></section><section><h2 class="section-heading" id="knowing-your-way-around-rstudio">Knowing your way around RStudio<a class="anchor" aria-label="anchor" href="#knowing-your-way-around-rstudio"></a>
</h2>
<hr class="half-width">
<p>Let’s start by learning about <a href="https://www.rstudio.com/" class="external-link">RStudio</a>, which is an Integrated
Development Environment (IDE) for working with R.</p>
<p>The RStudio IDE open-source product is free under the <a href="https://www.gnu.org/licenses/agpl-3.0.en.html" class="external-link">Affero General
Public License (AGPL) v3</a>. The RStudio IDE is also available with a
commercial license and priority email support from RStudio, Inc.</p>
<p>We will use the RStudio IDE to write code, navigate the files on our
computer, inspect the variables we create, and visualize the plots we
generate. RStudio can also be used for other things (e.g., version
control, developing packages, writing Shiny apps) that we will not cover
during the workshop.</p>
<p>One of the advantages of using RStudio is that all the information
you need to write code is available in a single window. Additionally,
RStudio provides many shortcuts, autocompletion, and highlighting for
the major file types you use while developing in R. RStudio makes typing
easier and less error-prone.</p>
</section><section><h2 class="section-heading" id="getting-set-up">Getting set up<a class="anchor" aria-label="anchor" href="#getting-set-up"></a>
</h2>
<hr class="half-width">
<p>It is good practice to keep a set of related data, analyses, and text
self-contained in a single folder called the <strong>working
directory</strong>. All of the scripts within this folder can then use
<em>relative paths</em> to files. Relative paths indicate where inside
the project a file is located (as opposed to absolute paths, which point
to where a file is on a specific computer). Working this way makes it a
lot easier to move your project around on your computer and share it
with others without having to directly modify file paths in the
individual scripts.</p>
<p>RStudio provides a helpful set of tools to do this through its
“Projects” interface, which not only creates a working directory for you
but also remembers its location (allowing you to quickly navigate to
it). The interface also (optionally) preserves custom settings and open
files to make it easier to resume work after a break.</p>
<div class="section level3">
<h3 id="create-a-new-project">Create a new project<a class="anchor" aria-label="anchor" href="#create-a-new-project"></a>
</h3>
<ul>
<li>Under the <code>File</code> menu, click on <code>New project</code>,
choose <code>New directory</code>, then <code>New project</code>
</li>
<li>Enter a name for this new folder (or “directory”) and choose a
convenient location for it. This will be your <strong>working
directory</strong> for the rest of the day (e.g.,
<code>~/data-carpentry</code>)</li>
<li>Click on <code>Create project</code>
</li>
<li>Create a new file where we will type our scripts. Go to File &gt;
New File &gt; R script. Click the save icon on your toolbar and save
your script as “<code>script.R</code>”.</li>
</ul>
<p>The simplest way to open an RStudio project once it has been created
is to navigate through your files to where the project was saved and
double click on the <code>.Rproj</code> (blue cube) file. This will open
RStudio and start your R session in the <strong>same</strong> directory
as the <code>.Rproj</code> file. All your data, plots and scripts will
now be relative to the project directory. RStudio projects have the
added benefit of allowing you to open multiple projects at the same time
each open to its own project directory. This allows you to keep multiple
projects open without them interfering with each other.</p>
</div>
<div class="section level3">
<h3 id="the-rstudio-interface">The RStudio Interface<a class="anchor" aria-label="anchor" href="#the-rstudio-interface"></a>
</h3>
<p>Let’s take a quick tour of RStudio.</p>
<figure><img src="../fig/R_00_Rstudio_01.png" alt="Screenshot of the RStudio_startup screen" class="figure mx-auto d-block"></figure><p>RStudio is divided into four “panes”. The placement of these panes
and their content can be customized (see menu, Tools -&gt; Global
Options -&gt; Pane Layout).</p>
<p>The Default Layout is:</p>
<ul>
<li>Top Left - <strong>Source</strong>: your scripts and documents</li>
<li>Bottom Left - <strong>Console</strong>: what R would look and be
like without RStudio</li>
<li>Top Right - <strong>Environment/History</strong>: look here to see
what you have done</li>
<li>Bottom Right - <strong>Files</strong> and more: see the contents of
the project/working directory here, like your Script.R file</li>
</ul>
</div>
<div class="section level3">
<h3 id="organizing-your-working-directory">Organizing your working directory<a class="anchor" aria-label="anchor" href="#organizing-your-working-directory"></a>
</h3>
<p>Using a consistent folder structure across your projects will help
keep things organized and make it easy to find/file things in the
future. This can be especially helpful when you have multiple projects.
In general, you might create directories (folders) for
<strong>scripts</strong>, <strong>data</strong>, and
<strong>documents</strong>. Here are some examples of suggested
directories:</p>
<ul>
<li>
<strong><code>data/</code></strong> Use this folder to store your
raw data and intermediate datasets. For the sake of transparency and <a href="https://en.wikipedia.org/wiki/Provenance" class="external-link">provenance</a>, you
should <em>always</em> keep a copy of your raw data accessible and do as
much of your data cleanup and preprocessing programmatically (i.e., with
scripts, rather than manually) as possible.</li>
<li>
<strong><code>data_output/</code></strong> When you need to modify
your raw data, it might be useful to store the modified versions of the
datasets in a different folder.</li>
<li>
<strong><code>documents/</code></strong> Used for outlines, drafts,
and other text.</li>
<li>
<strong><code>fig_output/</code></strong> This folder can store the
graphics that are generated by your scripts.</li>
<li>
<strong><code>scripts/</code></strong> A place to keep your R
scripts for different analyses or plotting.</li>
</ul>
<p>You may want additional directories or subdirectories depending on
your project needs, but these should form the backbone of your working
directory.</p>
<figure><img src="../fig/rstudio_project_files.jpeg" alt="Example of a working directory structure" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="the-working-directory">The working directory<a class="anchor" aria-label="anchor" href="#the-working-directory"></a>
</h3>
<p>The working directory is an important concept to understand. It is
the place where R will look for and save files. When you write code for
your project, your scripts should refer to files in relation to the root
of your working directory and only to files within this structure.</p>
<p>Using RStudio projects makes this easy and ensures that your working
directory is set up properly. If you need to check it, you can use
<code>getwd()</code>. If for some reason your working directory is not
the same as the location of your RStudio project, it is likely that you
opened an R script or RMarkdown file <strong>not</strong> your
<code>.Rproj</code> file. You should close out of RStudio and open the
<code>.Rproj</code> file by double clicking on the blue cube! If you
ever need to modify your working directory in a script,
<code>setwd('my/path')</code> changes the working directory. This should
be used with caution since it makes analyses hard to share across
devices and with other users.</p>
</div>
<div class="section level3">
<h3 id="downloading-the-data-and-getting-set-up">Downloading the data and getting set up<a class="anchor" aria-label="anchor" href="#downloading-the-data-and-getting-set-up"></a>
</h3>
<p>For this lesson we will use the following folders in our working
directory: <strong><code>data/</code></strong>,
<strong><code>data_output/</code></strong> and
<strong><code>fig_output/</code></strong>. Let’s write them all in
lowercase to be consistent. We can create them using the RStudio
interface by clicking on the “New Folder” button in the file pane
(bottom right), or directly from R by typing at console:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dir.create</span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span></span>
<span><span class="fu">dir.create</span><span class="op">(</span><span class="st">"data_output"</span><span class="op">)</span></span>
<span><span class="fu">dir.create</span><span class="op">(</span><span class="st">"fig_output"</span><span class="op">)</span></span></code></pre>
</div>
<p>You can either download the data used for this lesson from GitHub or
with R. You can copy the data from this <a href="https://github.com/datacarpentry/r-socialsci/blob/main/episodes/data/SAFI_clean.csv" class="external-link">GitHub
link</a> and paste it into a file called <code>SAFI_clean.csv</code> in
the <code>data/</code> directory you just created. Or you can do this
directly from R by copying and pasting this in your terminal (your
instructor can place this chunk of code in the Etherpad):</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">download.file</span><span class="op">(</span></span>
<span>  <span class="st">"https://raw.githubusercontent.com/datacarpentry/r-socialsci/main/episodes/data/SAFI_clean.csv"</span>,</span>
<span>  <span class="st">"data/SAFI_clean.csv"</span>, mode <span class="op">=</span> <span class="st">"wb"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="interacting-with-r">Interacting with R<a class="anchor" aria-label="anchor" href="#interacting-with-r"></a>
</h2>
<hr class="half-width">
<p>The basis of programming is that we write down instructions for the
computer to follow, and then we tell the computer to follow those
instructions. We write, or <em>code</em>, instructions in R because it
is a common language that both the computer and we can understand. We
call the instructions <em>commands</em> and we tell the computer to
follow the instructions by <em>executing</em> (also called
<em>running</em>) those commands.</p>
<p>There are two main ways of interacting with R: by using the console
or by using script files (plain text files that contain your code). The
console pane (in RStudio, the bottom left panel) is the place where
commands written in the R language can be typed and executed immediately
by the computer. It is also where the results will be shown for commands
that have been executed. You can type commands directly into the console
and press <kbd>Enter</kbd> to execute those commands, but they will be
forgotten when you close the session.</p>
<p>Because we want our code and workflow to be reproducible, it is
better to type the commands we want in the script editor and save the
script. This way, there is a complete record of what we did, and anyone
(including our future selves!) can easily replicate the results on their
computer.</p>
<p>RStudio allows you to execute commands directly from the script
editor by using the <kbd>Ctrl</kbd> + <kbd>Enter</kbd> shortcut (on Mac,
<kbd>Cmd</kbd> + <kbd>Return</kbd> will work). The command on the
current line in the script (indicated by the cursor) or all of the
commands in selected text will be sent to the console and executed when
you press <kbd>Ctrl</kbd> + <kbd>Enter</kbd>. If there is information in
the console you do not need anymore, you can clear it with
<kbd>Ctrl</kbd> + <kbd>L</kbd>. You can find other keyboard shortcuts in
this <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/rstudio-ide.pdf" class="external-link">RStudio
cheatsheet about the RStudio IDE</a>.</p>
<p>At some point in your analysis, you may want to check the content of
a variable or the structure of an object without necessarily keeping a
record of it in your script. You can type these commands and execute
them directly in the console. RStudio provides the <kbd>Ctrl</kbd> +
<kbd>1</kbd> and <kbd>Ctrl</kbd> + <kbd>2</kbd> shortcuts allow you to
jump between the script and the console panes.</p>
<p>If R is ready to accept commands, the R console shows a
<code>&gt;</code> prompt. If R receives a command (by typing,
copy-pasting, or sent from the script editor using <kbd>Ctrl</kbd> +
<kbd>Enter</kbd>), R will try to execute it and, when ready, will show
the results and come back with a new <code>&gt;</code> prompt to wait
for new commands.</p>
<p>If R is still waiting for you to enter more text, the console will
show a <code>+</code> prompt. It means that you haven’t finished
entering a complete command. This is likely because you have not
‘closed’ a parenthesis or quotation, i.e. you don’t have the same number
of left-parentheses as right-parentheses or the same number of opening
and closing quotation marks. When this happens, and you thought you
finished typing your command, click inside the console window and press
<kbd>Esc</kbd>; this will cancel the incomplete command and return you
to the <code>&gt;</code> prompt. You can then proofread the command(s)
you entered and correct the error.</p>
</section><section><h2 class="section-heading" id="installing-additional-packages-using-the-packages-tab">Installing additional packages using the packages tab<a class="anchor" aria-label="anchor" href="#installing-additional-packages-using-the-packages-tab"></a>
</h2>
<hr class="half-width">
<p>In addition to the core R installation, there are in excess of 10,000
additional packages which can be used to extend the functionality of R.
Many of these have been written by R users and have been made available
in central repositories, like the one hosted at CRAN, for anyone to
download and install into their own R environment. You should have
already installed the packages ‘ggplot2’ and ’dplyr. If you have not,
please do so now using these instructions.</p>
<p>You can see if you have a package installed by looking in the
<code>packages</code> tab (on the lower-right by default). You can also
type the command <code>installed.packages()</code> into the console and
examine the output.</p>
<figure><img src="../fig/packages_pane.png" alt="Screenshot of Packages pane" class="figure mx-auto d-block"></figure><p>Additional packages can be installed from the ‘packages’ tab. On the
packages tab, click the ‘Install’ icon and start typing the name of the
package you want in the text box. As you type, packages matching your
starting characters will be displayed in a drop-down list so that you
can select them.</p>
<figure><img src="../fig/R_00_Rstudio_03.png" alt="Screenshot of Install Packages Window" class="figure mx-auto d-block"></figure><p>At the bottom of the Install Packages window is a check box to
‘Install’ dependencies. This is ticked by default, which is usually what
you want. Packages can (and do) make use of functionality built into
other packages, so for the functionality contained in the package you
are installing to work properly, there may be other packages which have
to be installed with them. The ‘Install dependencies’ option makes sure
that this happens.</p>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>Use both the Console and the Packages tab to confirm that you have
the tidyverse installed.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Scroll through packages tab down to ‘tidyverse’. You can also type a
few characters into the searchbox. The ‘tidyverse’ package is really a
package of packages, including ‘ggplot2’ and ‘dplyr’, both of which
require other packages to run correctly. All of these packages will be
installed automatically. Depending on what packages have previously been
installed in your R environment, the install of ‘tidyverse’ could be
very quick or could take several minutes. As the install proceeds,
messages relating to its progress will be written to the console. You
will be able to see all of the packages which are actually being
installed.</p>
</div>
</div>
</div>
</div>
<p>Because the install process accesses the CRAN repository, you will
need an Internet connection to install packages.</p>
<p>It is also possible to install packages from other repositories, as
well as Github or the local file system, but we won’t be looking at
these options in this lesson.</p>
</section><section><h2 class="section-heading" id="installing-additional-packages-using-r-code">Installing additional packages using R code<a class="anchor" aria-label="anchor" href="#installing-additional-packages-using-r-code"></a>
</h2>
<hr class="half-width">
<p>If you were watching the console window when you started the install
of ‘tidyverse’, you may have noticed that the line</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></span></code></pre>
</div>
<p>was written to the console before the start of the installation
messages.</p>
<p>You could also have installed the
<strong><code>tidyverse</code></strong> packages by running this command
directly at the R terminal.</p>
<p>We will be using another package called
<strong><code>here</code></strong> throughout the workshop to manage
paths and directories. We will discuss it more detail in a later
episode, but we will install it now in the console:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"here"</span><span class="op">)</span></span></code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use RStudio to write and run R programs.</li>
<li>Use <code>install.packages()</code> to install packages
(libraries).</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-01-intro-to-r"><p>Content from <a href="01-intro-to-r.html">Introduction to R</a></p>
<hr>
<p>Last updated on 2025-07-01 |

        <a href="https://github.com/datacarpentry/r-socialsci/edit/main/episodes/01-intro-to-r.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 80 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<ul>
<li>The main goal is to introduce users to the various objects in R,
from atomic types to creating your own objects.</li>
<li>While this epsiode is foundational, be careful not to get caught in
the weeds as the variety of types and operations can be overwhelming for
new users, especially before they understand how this fits into their
own “workflow.”</li>
</ul>
</div>
</div>
</div>
</div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What data types are available in R?</li>
<li>What is an object?</li>
<li>How can objects of different data types be assigned to names?</li>
<li>What arithmetic and logical operators can be used?</li>
<li>How can subsets be extracted from vectors?</li>
<li>How does R treat missing values?</li>
<li>How can we deal with missing values in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Define the following terms as they relate to R: object, assign,
call, function, arguments, options.</li>
<li>Assign values to names in R.</li>
<li>Learn how to name objects.</li>
<li>Use comments to inform script.</li>
<li>Solve simple arithmetic operations in R.</li>
<li>Call functions and use arguments to change their default
options.</li>
<li>Inspect the content of vectors and manipulate their content.</li>
<li>Subset values from vectors.</li>
<li>Analyze vectors with missing data.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="creating-objects-in-r">Creating objects in R<a class="anchor" aria-label="anchor" href="#creating-objects-in-r"></a>
</h2>
<hr class="half-width">
<p>You can get output from R simply by typing math in the console:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">3</span> <span class="op">+</span> <span class="fl">5</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 8</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">12</span> <span class="op">/</span> <span class="fl">7</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.714286</code></pre>
</div>
<p>Everything that exists in <code>R</code> is an objects: from simple
numerical values, to strings, to more complex objects like vectors,
matrices, and lists. Even expressions and functions are objects in
<code>R</code>.</p>
<p>However, to do useful and interesting things, we need to name
objects. To do so, we need to give a <em>name</em> followed by the
assignment operator <code>&lt;-</code>, and the <em>object</em> we want
to be named:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">area_hectares</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span></code></pre>
</div>
<p><code>&lt;-</code> is the assignment operator. It assigns values
(objects) on the right to names (also called <em>symbols</em>) on the
left. So, after executing <code>x &lt;- 3</code>, the value of
<code>x</code> is <code>3</code>. The arrow can be read as 3
<strong>goes into</strong> <code>x</code>. For historical reasons, you
can also use <code>=</code> for assignments, but not in every context.
Because of the <a href="https://blog.revolutionanalytics.com/2008/12/use-equals-or-arrow-for-assignment.html" class="external-link">slight
differences</a> in syntax, it is good practice to always use
<code>&lt;-</code> for assignments. More generally we prefer the
<code>&lt;-</code> syntax over <code>=</code> because it makes it clear
what direction the assignment is operating (left assignment), and it
increases the read-ability of the code.</p>
<p>In RStudio, typing <kbd>Alt</kbd> + <kbd>-</kbd> (push <kbd>Alt</kbd>
at the same time as the <kbd>-</kbd> key) will write <code>&lt;-</code>
in a single keystroke in a PC, while typing <kbd>Option</kbd> +
<kbd>-</kbd> (push <kbd>Option</kbd> at the same time as the
<kbd>-</kbd> key) does the same in a Mac.</p>
<p>Objects can be given any name such as <code>x</code>,
<code>current_temperature</code>, or <code>subject_id</code>. You want
your object names to be explicit and not too long. They cannot start
with a number (<code>2x</code> is not valid, but <code>x2</code> is). R
is case sensitive (e.g., <code>age</code> is different from
<code>Age</code>). There are some names that cannot be used because they
are the names of fundamental objects in R (e.g., <code>if</code>,
<code>else</code>, <code>for</code>, see <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Reserved.html" class="external-link">here</a>
for a complete list). In general, even if it’s allowed, it’s best to not
use them (e.g., <code>c</code>, <code>T</code>, <code>mean</code>,
<code>data</code>, <code>df</code>, <code>weights</code>). If in doubt,
check the help to see if the name is already in use. It’s also best to
avoid dots (<code>.</code>) within an object name as in
<code>my.dataset</code>. There are many objects in R with dots in their
names for historical reasons, but because dots have a special meaning in
R (for methods) and other programming languages, it’s best to avoid
them. The recommended writing style is called snake_case, which implies
using only lowercaseletters and numbers and separating each word with
underscores (e.g., animals_weight, average_income). It is also
recommended to use nouns for object names, and verbs for function names.
It’s important to be consistent in the styling of your code (where you
put spaces, how you name objects, etc.). Using a consistent coding style
makes your code clearer to read for your future self and your
collaborators. In R, three popular style guides are <a href="https://google.github.io/styleguide/Rguide.xml" class="external-link">Google’s</a>, <a href="https://jef.works/R-style-guide/" class="external-link">Jean Fan’s</a> and the <a href="https://style.tidyverse.org/" class="external-link">tidyverse’s</a>. The tidyverse’s is
very comprehensive and may seem overwhelming at first. You can install
the <a href="https://github.com/jimhester/lintr" class="external-link"><strong><code>lintr</code></strong></a>
package to automatically check for issues in the styling of your
code.</p>
<div id="objects-vs.-variables" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="objects-vs.-variables" class="callout-inner">
<h3 class="callout-title">Objects vs. variables</h3>
<div class="callout-content">
<p>The naming of objects in <code>R</code> is somehow related to
<code>variables</code> in many other programming languages. In many
programming languages, a variable has three aspects: a name, a memory
location, and the current value stored in this location. <code>R</code>
abstracts from modifiable memory locations. In <code>R</code> we only
have objects which cn be named. Depending on the context,
<code>name (of an object)</code> and <code>variable</code> can have
drastically different meanings. However, in this lesson, the two words
are used synonymously. For more information see: <a href="https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Objects" class="external-link">https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Objects</a></p>
</div>
</div>
</div>
<p>When assigning an value to a name, R does not print anything. You can
force R to print the value by using parentheses or by typing the object
name:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">area_hectares</span> <span class="op">&lt;-</span> <span class="fl">1.0</span>    <span class="co"># doesn't print anything</span></span>
<span><span class="op">(</span><span class="va">area_hectares</span> <span class="op">&lt;-</span> <span class="fl">1.0</span><span class="op">)</span>  <span class="co"># putting parenthesis around the call prints the value of `area_hectares`</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">area_hectares</span>         <span class="co"># and so does typing the name of the object</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1</code></pre>
</div>
<p>Now that R has <code>area_hectares</code> in memory, we can do
arithmetic with it. For instance, we may want to convert this area into
acres (area in acres is 2.47 times the area in hectares):</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2.47</span> <span class="op">*</span> <span class="va">area_hectares</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2.47</code></pre>
</div>
<p>We can also change an the value assigned to an name by assigning it a
new one:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">area_hectares</span> <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span><span class="fl">2.47</span> <span class="op">*</span> <span class="va">area_hectares</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 6.175</code></pre>
</div>
<p>This means that assigning a value to one name does not change the
values of other names. For example, let’s name the plot’s area in acres
<code>area_acres</code>:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">area_acres</span> <span class="op">&lt;-</span> <span class="fl">2.47</span> <span class="op">*</span> <span class="va">area_hectares</span></span></code></pre>
</div>
<p>and then change (reassign) <code>area_hectares</code> to 50.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">area_hectares</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></code></pre>
</div>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>What do you think is the current value of <code>area_acres</code>?
123.5 or 6.175?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>The value of <code>area_acres</code> is still 6.175 because you have
not re-run the line <code>area_acres &lt;- 2.47 * area_hectares</code>
since changing the value of <code>area_hectares</code>.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="comments">Comments<a class="anchor" aria-label="anchor" href="#comments"></a>
</h2>
<hr class="half-width">
<p>All programming languages allow the programmer to include comments in
their code. Including comments to your code has many advantages: it
helps you explain your reasoning and it forces you to be tidy. A
commented code is also a great tool not only to your collaborators, but
to your future self. Comments are the key to a reproducible
analysis.</p>
<p>To do this in R we use the <code>#</code> character. Anything to the
right of the <code>#</code> sign and up to the end of the line is
treated as a comment and is ignored by R. You can start lines with
comments or include them after any code on the line.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">area_hectares</span> <span class="op">&lt;-</span> <span class="fl">1.0</span>      <span class="co"># land area in hectares</span></span>
<span><span class="va">area_acres</span> <span class="op">&lt;-</span> <span class="va">area_hectares</span> <span class="op">*</span> <span class="fl">2.47</span>  <span class="co"># convert to acres</span></span>
<span><span class="va">area_acres</span>        <span class="co"># print land area in acres.</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2.47</code></pre>
</div>
<p>RStudio makes it easy to comment or uncomment a paragraph: after
selecting the lines you want to comment, press at the same time on your
keyboard <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>C</kbd>. If you only
want to comment out one line, you can put the cursor at any location of
that line (i.e. no need to select the whole line), then press
<kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>C</kbd>.</p>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>Create two variables <code>r_length</code> and <code>r_width</code>
and assign them values. It should be noted that, because
<code>length</code> is a built-in R function, R Studio might add “()”
after you type <code>length</code> and if you leave the parentheses you
will get unexpected results. This is why you might see other programmers
abbreviate common words. Create a third variable <code>r_area</code> and
give it a value based on the current values of <code>r_length</code> and
<code>r_width</code>. Show that changing the values of either
<code>r_length</code> and <code>r_width</code> does not affect the value
of <code>r_area</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r_length</span> <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span><span class="va">r_width</span> <span class="op">&lt;-</span> <span class="fl">3.2</span></span>
<span><span class="va">r_area</span> <span class="op">&lt;-</span> <span class="va">r_length</span> <span class="op">*</span> <span class="va">r_width</span></span>
<span><span class="va">r_area</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 8</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># change the values of r_length and r_width</span></span>
<span><span class="va">r_length</span> <span class="op">&lt;-</span> <span class="fl">7.0</span></span>
<span><span class="va">r_width</span> <span class="op">&lt;-</span> <span class="fl">6.5</span></span>
<span><span class="co"># the value of r_area isn't changed</span></span>
<span><span class="va">r_area</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 8</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="functions-and-their-arguments">Functions and their arguments<a class="anchor" aria-label="anchor" href="#functions-and-their-arguments"></a>
</h3>
<p>Functions are “canned scripts” that automate more complicated sets of
commands including operations assignments, etc. Many functions are
predefined, or can be made available by importing R <em>packages</em>
(more on that later). A function usually gets one or more inputs called
<em>arguments</em>. Functions often (but not always) return a
<em>value</em>. A typical example would be the function
<code>sqrt()</code>. The input (the argument) must be a number, and the
return value (in fact, the output) is the square root of that number.
Executing a function (‘running it’) is called <em>calling</em> the
function. An example of a function call is:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">sqrt</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></code></pre>
</div>
<p>Here, the value of <code>a</code> is given to the <code>sqrt()</code>
function, the <code>sqrt()</code> function calculates the square root,
and returns the value which is then assigned to the name <code>b</code>.
This function is very simple, because it takes just one argument.</p>
<p>The return ‘value’ of a function need not be numerical (like that of
<code>sqrt()</code>), and it also does not need to be a single item: it
can be a set of things, or even a dataset. We’ll see that when we read
data files into R.</p>
<p>Arguments can be anything, not only numbers or filenames, but also
other objects. Exactly what each argument means differs per function,
and must be looked up in the documentation (see below). Some functions
take arguments which may either be specified by the user, or, if left
out, take on a <em>default</em> value: these are called
<em>options</em>. Options are typically used to alter the way the
function operates, such as whether it ignores ‘bad values’, or what
symbol to use in a plot. However, if you want something specific, you
can specify a value of your choice which will be used instead of the
default.</p>
<p>Let’s try a function that can take multiple arguments:
<code>round()</code>.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">round</span><span class="op">(</span><span class="fl">3.14159</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3</code></pre>
</div>
<p>Here, we’ve called <code>round()</code> with just one argument,
<code>3.14159</code>, and it has returned the value <code>3</code>.
That’s because the default is to round to the nearest whole number. If
we want more digits we can see how to do that by getting information
about the <code>round</code> function. We can use
<code>args(round)</code> or look at the help for this function using
<code>?round</code>.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">args</span><span class="op">(</span><span class="va">round</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="kw">function</span> <span class="op">(</span><span class="va">x</span>, <span class="va">digits</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="cn">NULL</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">round</span></span></code></pre>
</div>
<p>We see that if we want a different number of digits, we can type
<code>digits=2</code> or however many we want.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">round</span><span class="op">(</span><span class="fl">3.14159</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.14</code></pre>
</div>
<p>If you provide the arguments in the exact same order as they are
defined you don’t have to name them:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">round</span><span class="op">(</span><span class="fl">3.14159</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.14</code></pre>
</div>
<p>And if you do name the arguments, you can switch their order:</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">round</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span>, x <span class="op">=</span> <span class="fl">3.14159</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.14</code></pre>
</div>
<p>It’s good practice to put the non-optional arguments (like the number
you’re rounding) first in your function call, and to specify the names
of all optional arguments. If you don’t, someone reading your code might
have to look up the definition of a function with unfamiliar arguments
to understand what you’re doing.</p>
<div id="exercise-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>Type in <code>?round</code> at the console and then look at the
output in the Help pane. What other functions exist that are similar to
<code>round</code>? How do you use the <code>digits</code> parameter in
the round function?</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="vectors-and-data-types">Vectors and data types<a class="anchor" aria-label="anchor" href="#vectors-and-data-types"></a>
</h2>
<hr class="half-width">
<p>A vector is the most common and basic data type in R, and is pretty
much the workhorse of R. A vector is composed by a series of values,
which can be either numbers or characters. We can assign a series of
values to a vector using the <code>c()</code> function. For example we
can create a vector of the number of household members for the
households we’ve interviewed and assign it to
<code>hh_members</code>:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hh_members</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">10</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">hh_members</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  3  7 10  6</code></pre>
</div>
<p>A vector can also contain characters. For example, we can have a
vector of the building material used to construct our interview
respondents’ walls (<code>respondent_wall_type</code>):</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">respondent_wall_type</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"muddaub"</span>, <span class="st">"burntbricks"</span>, <span class="st">"sunbricks"</span><span class="op">)</span></span>
<span><span class="va">respondent_wall_type</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "muddaub"     "burntbricks" "sunbricks"  </code></pre>
</div>
<p>The quotes around “muddaub”, etc. are essential here. Without the
quotes R will assume there are objects called <code>muddaub</code>,
<code>burntbricks</code> and <code>sunbricks</code>. As these names
don’t exist in R’s memory, there will be an error message.</p>
<p>There are many functions that allow you to inspect the content of a
vector. <code>length()</code> tells you how many elements are in a
particular vector:</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">length</span><span class="op">(</span><span class="va">hh_members</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">length</span><span class="op">(</span><span class="va">respondent_wall_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3</code></pre>
</div>
<p>An important feature of a vector, is that all of the elements are the
same type of data. The function <code>typeof()</code> indicates the type
of an object:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="va">hh_members</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "double"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="va">respondent_wall_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
<p>The function <code>str()</code> provides an overview of the structure
of an object and its elements. It is a useful function when working with
large and complex objects:</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">hh_members</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> num [1:4] 3 7 10 6</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">respondent_wall_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> chr [1:3] "muddaub" "burntbricks" "sunbricks"</code></pre>
</div>
<p>You can use the <code>c()</code> function to add other elements to
your vector:</p>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">possessions</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"bicycle"</span>, <span class="st">"radio"</span>, <span class="st">"television"</span><span class="op">)</span></span>
<span><span class="va">possessions</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">possessions</span>, <span class="st">"mobile_phone"</span><span class="op">)</span> <span class="co"># add to the end of the vector</span></span>
<span><span class="va">possessions</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"car"</span>, <span class="va">possessions</span><span class="op">)</span> <span class="co"># add to the beginning of the vector</span></span>
<span><span class="va">possessions</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "car"          "bicycle"      "radio"        "television"   "mobile_phone"</code></pre>
</div>
<p>In the first line, we take the original vector
<code>possessions</code>, add the value <code>"mobile_phone"</code> to
the end of it, and save the result back into <code>possessions</code>.
Then we add the value <code>"car"</code> to the beginning, again saving
the result back into <code>possessions</code>.</p>
<p>We can do this over and over again to grow a vector, or assemble a
dataset. As we program, this may be useful to add results that we are
collecting or calculating.</p>
<p>An <strong>atomic vector</strong> is the simplest R <strong>data
type</strong> and is a linear vector of a single type. Above, we saw 2
of the 6 main <strong>atomic vector</strong> types that R uses:
<code>"character"</code> and <code>"numeric"</code> (or
<code>"double"</code>). These are the basic building blocks that all R
objects are built from. The other 4 <strong>atomic vector</strong> types
are:</p>
<ul>
<li>
<code>"logical"</code> for <code>TRUE</code> and <code>FALSE</code>
(the boolean data type)</li>
<li>
<code>"integer"</code> for integer numbers (e.g., <code>2L</code>,
the <code>L</code> indicates to R that it’s an integer)</li>
<li>
<code>"complex"</code> to represent complex numbers with real and
imaginary parts (e.g., <code>1 + 4i</code>) and that’s all we’re going
to say about them</li>
<li>
<code>"raw"</code> for bitstreams that we won’t discuss further</li>
</ul>
<p>You can check the type of your vector using the <code>typeof()</code>
function and inputting your vector as the argument.</p>
<p>Vectors are one of the many <strong>data structures</strong> that R
uses. Other important ones are lists (<code>list</code>), matrices
(<code>matrix</code>), data frames (<code>data.frame</code>), factors
(<code>factor</code>) and arrays (<code>array</code>).</p>
<div id="exercise-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-3" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>We’ve seen that atomic vectors can be of type character, numeric (or
double), integer, and logical. But what happens if we try to mix these
types in a single vector?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>R implicitly converts them to all be the same type.</p>
</div>
</div>
</div>
</div>
<div id="exercise-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-3" class="callout-inner">
<h3 class="callout-title">Exercise<em> (continued)</em>
</h3>
<div class="callout-content">
<p>What will happen in each of these examples? (hint: use
<code>class()</code> to check the data type of your objects):</p>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_char</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="st">"a"</span><span class="op">)</span></span>
<span><span class="va">num_logical</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">char_logical</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">tricky</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="st">"4"</span><span class="op">)</span></span></code></pre>
</div>
<p>Why do you think it happens?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>Vectors can be of only one data type. R tries to convert (coerce) the
content of this vector to find a “common denominator” that doesn’t lose
any information.</p>
</div>
</div>
</div>
</div>
<div id="exercise-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-3" class="callout-inner">
<h3 class="callout-title">Exercise<em> (continued)</em>
</h3>
<div class="callout-content">
<p>How many values in <code>combined_logical</code> are
<code>"TRUE"</code> (as a character) in the following example:</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_logical</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">char_logical</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">combined_logical</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">num_logical</span>, <span class="va">char_logical</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<p>Only one. There is no memory of past data types, and the coercion
happens the first time the vector is evaluated. Therefore, the
<code>TRUE</code> in <code>num_logical</code> gets converted into a
<code>1</code> before it gets converted into <code>"1"</code> in
<code>combined_logical</code>.</p>
</div>
</div>
</div>
</div>
<div id="exercise-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-3" class="callout-inner">
<h3 class="callout-title">Exercise<em> (continued)</em>
</h3>
<div class="callout-content">
<p>You’ve probably noticed that objects of different types get converted
into a single, shared type within a vector. In R, we call converting
objects from one class into another class <em>coercion</em>. These
conversions happen according to a hierarchy, whereby some types get
preferentially coerced into other types. Can you draw a diagram that
represents the hierarchy of how these data types are coerced?</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="subsetting-vectors">Subsetting vectors<a class="anchor" aria-label="anchor" href="#subsetting-vectors"></a>
</h2>
<hr class="half-width">
<p>Subsetting (sometimes referred to as extracting or indexing) involves
accessing out one or more values based on their numeric placement or
“index” within a vector. If we want to subset one or several values from
a vector, we must provide one index or several indices in square
brackets. For instance:</p>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">respondent_wall_type</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"muddaub"</span>, <span class="st">"burntbricks"</span>, <span class="st">"sunbricks"</span><span class="op">)</span></span>
<span><span class="va">respondent_wall_type</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "burntbricks"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">respondent_wall_type</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "sunbricks"   "burntbricks"</code></pre>
</div>
<p>We can also repeat the indices to create an object with more elements
than the original one:</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">more_respondent_wall_type</span> <span class="op">&lt;-</span> <span class="va">respondent_wall_type</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">more_respondent_wall_type</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "muddaub"     "burntbricks" "sunbricks"   "burntbricks" "muddaub"
[6] "sunbricks"  </code></pre>
</div>
<p>R indices start at 1. Programming languages like Fortran, MATLAB,
Julia, and R start counting at 1, because that’s what human beings
typically do. Languages in the C family (including C++, Java, Perl, and
Python) count from 0 because that’s simpler for computers to do.</p>
<div class="section level3">
<h3 id="conditional-subsetting">Conditional subsetting<a class="anchor" aria-label="anchor" href="#conditional-subsetting"></a>
</h3>
<p>Another common way of subsetting is by using a logical vector.
<code>TRUE</code> will select the element with the same index, while
<code>FALSE</code> will not:</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hh_members</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">10</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">hh_members</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  3 10  6</code></pre>
</div>
<p>Typically, these logical vectors are not typed by hand, but are the
output of other functions or logical tests. For instance, if you wanted
to select only the values above 5:</p>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hh_members</span> <span class="op">&gt;</span> <span class="fl">5</span>    <span class="co"># will return logicals with TRUE for the indices that meet the condition</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] FALSE  TRUE  TRUE  TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb64">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## so we can use this to select only the values above 5</span></span>
<span><span class="va">hh_members</span><span class="op">[</span><span class="va">hh_members</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  7 10  6</code></pre>
</div>
<p>You can combine multiple tests using <code>&amp;</code> (both
conditions are true, AND) or <code>|</code> (at least one of the
conditions is true, OR):</p>
<div class="codewrapper sourceCode" id="cb66">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hh_members</span><span class="op">[</span><span class="va">hh_members</span> <span class="op">&lt;</span> <span class="fl">4</span> <span class="op">|</span> <span class="va">hh_members</span> <span class="op">&gt;</span> <span class="fl">7</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  3 10</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hh_members</span><span class="op">[</span><span class="va">hh_members</span> <span class="op">&gt;=</span> <span class="fl">4</span> <span class="op">&amp;</span> <span class="va">hh_members</span> <span class="op">&lt;=</span> <span class="fl">7</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 7 6</code></pre>
</div>
<p>Here, <code>&lt;</code> stands for “less than”, <code>&gt;</code> for
“greater than”, <code>&gt;=</code> for “greater than or equal to”, and
<code>==</code> for “equal to”. The double equal sign <code>==</code> is
a test for numerical equality between the left and right hand sides, and
should not be confused with the single <code>=</code> sign, which
performs variable assignment (similar to <code>&lt;-</code>).</p>
<p>A common task is to search for certain strings in a vector. One could
use the “or” operator <code>|</code> to test for equality to multiple
values, but this can quickly become tedious.</p>
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">possessions</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"car"</span>, <span class="st">"bicycle"</span>, <span class="st">"radio"</span>, <span class="st">"television"</span>, <span class="st">"mobile_phone"</span><span class="op">)</span></span>
<span><span class="va">possessions</span><span class="op">[</span><span class="va">possessions</span> <span class="op">==</span> <span class="st">"car"</span> <span class="op">|</span> <span class="va">possessions</span> <span class="op">==</span> <span class="st">"bicycle"</span><span class="op">]</span> <span class="co"># returns both car and bicycle</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "car"     "bicycle"</code></pre>
</div>
<p>The function <code>%in%</code> allows you to test if any of the
elements of a search vector (on the left hand side) are found in the
target vector (on the right hand side):</p>
<div class="codewrapper sourceCode" id="cb72">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">possessions</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"car"</span>, <span class="st">"bicycle"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  TRUE  TRUE FALSE FALSE FALSE</code></pre>
</div>
<p>Note that the output is the same length as the search vector on the
left hand side, because <code>%in%</code> checks whether each element of
the search vector is found somewhere in the target vector. Thus, you can
use <code>%in%</code> to select the elements in the search vector that
appear in your target vector:</p>
<div class="codewrapper sourceCode" id="cb74">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">possessions</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"car"</span>, <span class="st">"bicycle"</span>, <span class="st">"motorcycle"</span>, <span class="st">"truck"</span>, <span class="st">"boat"</span>, <span class="st">"bus"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  TRUE  TRUE FALSE FALSE FALSE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb76">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">possessions</span><span class="op">[</span><span class="va">possessions</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"car"</span>, <span class="st">"bicycle"</span>, <span class="st">"motorcycle"</span>, <span class="st">"truck"</span>, <span class="st">"boat"</span>, <span class="st">"bus"</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "car"     "bicycle"</code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="missing-data">Missing data<a class="anchor" aria-label="anchor" href="#missing-data"></a>
</h2>
<hr class="half-width">
<p>As R was designed to analyze datasets, it includes the concept of
missing data (which is uncommon in other programming languages). Missing
data are represented in vectors as <code>NA</code>.</p>
<p>When doing operations on numbers, most functions will return
<code>NA</code> if the data you are working with include missing values.
This feature makes it harder to overlook the cases where you are dealing
with missing data. You can add the argument <code>na.rm=TRUE</code> to
calculate the result while ignoring the missing values.</p>
<div class="codewrapper sourceCode" id="cb78">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rooms</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">7</span><span class="op">)</span></span>
<span><span class="fu">mean</span><span class="op">(</span><span class="va">rooms</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] NA</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb80">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">max</span><span class="op">(</span><span class="va">rooms</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] NA</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb82">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">rooms</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2.75</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb84">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">max</span><span class="op">(</span><span class="va">rooms</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 7</code></pre>
</div>
<p>If your data include missing values, you may want to become familiar
with the functions <code>is.na()</code>, <code>na.omit()</code>, and
<code>complete.cases()</code>. See below for examples.</p>
<div class="codewrapper sourceCode" id="cb86">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract those elements which are not missing values.</span></span>
<span><span class="co">## The ! character is also called the NOT operator</span></span>
<span><span class="va">rooms</span><span class="op">[</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">rooms</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2 1 1 7</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb88">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Count the number of missing values.</span></span>
<span><span class="co">## The output of is.na() is a logical vector (TRUE/FALSE equivalent to 1/0) so the sum() function here is effectively counting</span></span>
<span><span class="fu">sum</span><span class="op">(</span><span class="fu">is.na</span><span class="op">(</span><span class="va">rooms</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb90">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Returns the object with incomplete cases removed. The returned object is an atomic vector of type `"numeric"` (or `"double"`).</span></span>
<span><span class="fu">na.omit</span><span class="op">(</span><span class="va">rooms</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2 1 1 7
attr(,"na.action")
[1] 4
attr(,"class")
[1] "omit"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb92">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract those elements which are complete cases. The returned object is an atomic vector of type `"numeric"` (or `"double"`).</span></span>
<span><span class="va">rooms</span><span class="op">[</span><span class="fu">complete.cases</span><span class="op">(</span><span class="va">rooms</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2 1 1 7</code></pre>
</div>
<p>Recall that you can use the <code>typeof()</code> function to find
the type of your atomic vector.</p>
<div id="exercise-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-4" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Using this vector of rooms, create a new vector with the NAs
removed.</li>
</ol>
<div class="codewrapper sourceCode" id="cb94">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rooms</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li><p>Use the function <code>median()</code> to calculate the median of
the <code>rooms</code> vector.</p></li>
<li><p>Use R to figure out how many households in the set use more than
2 rooms for sleeping.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb95">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rooms</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">rooms_no_na</span> <span class="op">&lt;-</span> <span class="va">rooms</span><span class="op">[</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">rooms</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># or</span></span>
<span><span class="va">rooms_no_na</span> <span class="op">&lt;-</span> <span class="fu">na.omit</span><span class="op">(</span><span class="va">rooms</span><span class="op">)</span></span>
<span><span class="co"># 2.</span></span>
<span><span class="fu">median</span><span class="op">(</span><span class="va">rooms</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb97">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3.</span></span>
<span><span class="va">rooms_above_2</span> <span class="op">&lt;-</span> <span class="va">rooms_no_na</span><span class="op">[</span><span class="va">rooms_no_na</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu">length</span><span class="op">(</span><span class="va">rooms_above_2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Now that we have learned how to write scripts, and the basics of R’s
data structures, we are ready to start working with the SAFI dataset we
have been using in the other lessons, and learn about data frames.</p>
</section><section><h2 class="section-heading" id="getting-help">Getting help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h2>
<hr class="half-width">
<p>As mentioned in the <a href="#functions-and-their-arguments">functions and their arguments
section</a>, you can use a question mark <code>?</code> to know more
about a function (for example, typing <code>?round</code>).</p>
<p>However, there are several other ways that people often get help when
they are stuck with their R code.</p>
<ul>
<li>Search the internet: paste the last line of your error message or
“R” and a short description of what you want to do into your favorite
search engine and you will usually find several examples where other
people have encountered the same problem and came looking for help.
<ul>
<li>Stack Overflow can be particularly helpful for this: answers to
questions are presented as a ranked thread ordered according to how
useful other users found them to be. You can search using the
<code>[r]</code> tag.</li>
<li>
<strong>Take care</strong>: copying and pasting code written by
somebody else is risky unless you understand exactly what it is
doing!</li>
</ul>
</li>
<li>Ask somebody “in the real world”. If you have a colleague or friend
with more expertise in R than you have, show them the problem you are
having and ask them for help.</li>
<li>Sometimes, the act of articulating your question can help you to
identify what is going wrong. This is known as <a href="https://en.wikipedia.org/wiki/Rubber_duck_debugging" class="external-link">“rubber duck
debugging”</a> among programmers.</li>
</ul>
<div class="section level3">
<h3 id="generative-ai">Generative AI<a class="anchor" aria-label="anchor" href="#generative-ai"></a>
</h3>
<div id="accordionInstructor2" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor2" aria-expanded="false" aria-controls="collapseInstructor2">
  <h3 class="accordion-header" id="headingInstructor2">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Choose how to teach this section </h3>
</button>
<div id="collapseInstructor2" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor2" aria-labelledby="headingInstructor2">
<div class="accordion-body">
<p>The section on generative AI is intended to be concise but
Instructors may choose to devote more time to the topic in a workshop.
Depending on your own level of experience and comfort with talking about
and using these tools, you could choose to do any of the following:</p>
<ul>
<li>Explain how large language models work and are trained, and/or the
difference between generative AI, other forms of AI that currently
exist, and the limits of what LLMs can do (e.g., they can’t
“reason”).</li>
<li>Demonstrate how you recommend that learners use generative AI.</li>
<li>Discuss the ethical concerns listed below, as well as others that
you are aware of, to help learners make an informed choice about whether
or not to use generative AI tools.</li>
</ul>
<p>This is a fast-moving technology. If you are preparing to teach this
section and you feel it has become outdated, please open an issue on the
lesson repository to let the Maintainers know and/or a pull request to
suggest updates and improvements.</p>
</div>
</div>
</div>
</div>
<p>It is increasingly common for people to use <em>generative AI</em>
chatbots such as ChatGPT to get help while coding. You will probably
receive some useful guidance by presenting your error message to the
chatbot and asking it what went wrong.</p>
<p>However, the way this help is provided by the chatbot is different.
Answers on Stack Overflow have (probably) been given by a human as a
direct response to the question asked. But generative AI chatbots, which
are based on advanced statistical models called Large Language Models
(or LLMs), respond by generating the <em>most likely</em> sequence of
text that would follow the prompt they are given.</p>
<p>While responses from generative AI tools can often be helpful, they
are not always reliable. These tools sometimes generate plausible but
incorrect or misleading information, so (just as with an answer found on
the internet) it is essential to verify their accuracy. You need the
knowledge and skills to be able to understand these responses, to judge
whether or not they are accurate, and to fix any errors in the code it
offers you.</p>
<p>In addition to asking for help, programmers can use generative AI
tools to generate code from scratch; extend, improve and reorganize
existing code; translate code between programming languages; figure out
what terms to use in a search of the internet; and more. However, there
are drawbacks that you should be aware of.</p>
<p>The models used by these tools have been “trained” on very large
volumes of data, much of it taken from the internet, and the responses
they produce reflect that training data, and may recapitulate its
inaccuracies or biases. The environmental costs (energy and water use)
of LLMs are a lot higher than other technologies, both during
development (known as training) and when an individual user uses one
(also called inference). For more information see the <a href="https://huggingface.co/blog/sasha/ai-environment-primer" class="external-link">AI
Environmental Impact Primer</a> developed by researchers at HuggingFace,
an AI hosting platform. Concerns also exist about the way the data for
this training was obtained, with questions raised about whether the
people developing the LLMs had permission to use it. Other ethical
concerns have also been raised, such as reports that workers were
exploited during the training process.</p>
<p><strong>We recommend that you avoid getting help from generative AI
during the workshop</strong> for several reasons:</p>
<ol style="list-style-type: decimal">
<li>For most problems you will encounter at this stage, help and answers
can be found among the first results returned by searching the
internet.</li>
<li>The foundational knowledge and skills you will learn in this lesson
by writing and fixing your own programs are essential to be able to
evaluate the correctness and safety of any code you receive from online
help or a generative AI chatbot. If you choose to use these tools in the
future, the expertise you gain from learning and practicing these
fundamentals on your own will help you use them more effectively.</li>
<li>As you start out with programming, the mistakes you make will be the
kinds that have also been made – and overcome! – by everybody else who
learned to program before you. Since these mistakes and the questions
you are likely to have at this stage are common, they are also better
represented than other, more specialized problems and tasks in the data
that was used to train generative AI tools. This means that a generative
AI chatbot is <em>more likely to produce accurate responses</em> to
questions that novices ask, which could give you a false impression of
how reliable they will be when you are ready to do things that are more
advanced.</li>
</ol>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Access individual values by location using <code>[]</code>.</li>
<li>Access arbitrary sets of data using <code>[c(...)]</code>.</li>
<li>Use logical operations and logical vectors to access subsets of
data.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-02-starting-with-data"><p>Content from <a href="02-starting-with-data.html">Starting with Data</a></p>
<hr>
<p>Last updated on 2025-07-01 |

        <a href="https://github.com/datacarpentry/r-socialsci/edit/main/episodes/02-starting-with-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 80 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p>The two main goals for this lessons are:</p>
<ul>
<li>To make sure that learners are comfortable with working with data
frames, and can use the bracket notation to select slices/columns.</li>
<li>To expose learners to factors. Their behavior is not necessarily
intuitive, and so it is important that they are guided through it the
first time they are exposed to it. The content of the lesson should be
enough for learners to avoid common mistakes with them.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is a data.frame?</li>
<li>How can I read a complete csv file into R?</li>
<li>How can I get basic summary information about my dataset?</li>
<li>How can I change the way R treats strings in my dataset?</li>
<li>Why would I want strings to be treated differently?</li>
<li>How are dates represented in R and how can I change the format?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe what a data frame is.</li>
<li>Load external data from a .csv file into a data frame.</li>
<li>Summarize the contents of a data frame.</li>
<li>Subset values from data frames.</li>
<li>Describe the difference between a factor and a string.</li>
<li>Convert between strings and factors.</li>
<li>Reorder and rename factors.</li>
<li>Change how character strings are handled in a data frame.</li>
<li>Examine and change date formats.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="what-are-data-frames">What are data frames?<a class="anchor" aria-label="anchor" href="#what-are-data-frames"></a>
</h2>
<hr class="half-width">
<p>Data frames are the <em>de facto</em> data structure for tabular data
in <code>R</code>, and what we use for data processing, statistics, and
plotting.</p>
<p>A data frame is the representation of data in the format of a table
where the columns are vectors that all have the same length. Data frames
are analogous to the more familiar spreadsheet in programs such as
Excel, with one key difference. Because columns are vectors, each column
must contain a single type of data (e.g., characters, integers,
factors). For example, here is a figure depicting a data frame
comprising a numeric, a character, and a logical vector.</p>
<figure><img src="../fig/data-frame.svg" alt="A 3 by 3 data frame with columns showing numeric, character and logical values." class="figure mx-auto d-block"></figure><p>Data frames can be created by hand, but most commonly they are
generated by the functions <code>read_csv()</code> or
<code>read_table()</code>; in other words, when importing spreadsheets
from your hard drive (or the web). We will now demonstrate how to import
tabular data using <code>read_csv()</code>.</p>
</section><section><h2 class="section-heading" id="presentation-of-the-safi-data">Presentation of the SAFI Data<a class="anchor" aria-label="anchor" href="#presentation-of-the-safi-data"></a>
</h2>
<hr class="half-width">
<p>SAFI (Studying African Farmer-Led Irrigation) is a study looking at
farming and irrigation methods in Tanzania and Mozambique. The survey
data was collected through interviews conducted between November 2016
and June 2017. For this lesson, we will be using a subset of the
available data. For information about the full teaching dataset used in
other lessons in this workshop, see the <a href="https://datacarpentry.org/socialsci-workshop/index.html#data" class="external-link">dataset
description</a>.</p>
<p>We will be using a subset of the cleaned version of the dataset that
was produced through cleaning in OpenRefine
(<code>data/SAFI_clean.csv</code>). In this dataset, the missing data is
encoded as “NULL”, each row holds information for a single interview
respondent, and the columns represent:</p>
<table class="table">
<colgroup>
<col width="13%">
<col width="86%">
</colgroup>
<thead><tr class="header">
<th>column_name</th>
<th>description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>key_id</td>
<td>Added to provide a unique Id for each observation. (The InstanceID
field does this as well but it is not as convenient to use)</td>
</tr>
<tr class="even">
<td>village</td>
<td>Village name</td>
</tr>
<tr class="odd">
<td>interview_date</td>
<td>Date of interview</td>
</tr>
<tr class="even">
<td>no_membrs</td>
<td>How many members in the household?</td>
</tr>
<tr class="odd">
<td>years_liv</td>
<td>How many years have you been living in this village or neighboring
village?</td>
</tr>
<tr class="even">
<td>respondent_wall_type</td>
<td>What type of walls does their house have (from list)</td>
</tr>
<tr class="odd">
<td>rooms</td>
<td>How many rooms in the main house are used for sleeping?</td>
</tr>
<tr class="even">
<td>memb_assoc</td>
<td>Are you a member of an irrigation association?</td>
</tr>
<tr class="odd">
<td>affect_conflicts</td>
<td>Have you been affected by conflicts with other irrigators in the
area?</td>
</tr>
<tr class="even">
<td>liv_count</td>
<td>Number of livestock owned.</td>
</tr>
<tr class="odd">
<td>items_owned</td>
<td>Which of the following items are owned by the household? (list)</td>
</tr>
<tr class="even">
<td>no_meals</td>
<td>How many meals do people in your household normally eat in a
day?</td>
</tr>
<tr class="odd">
<td>months_lack_food</td>
<td>Indicate which months, In the last 12 months have you faced a
situation when you did not have enough food to feed the household?</td>
</tr>
<tr class="even">
<td>instanceID</td>
<td>Unique identifier for the form data submission</td>
</tr>
</tbody>
</table></section><section><h2 class="section-heading" id="importing-data">Importing data<a class="anchor" aria-label="anchor" href="#importing-data"></a>
</h2>
<hr class="half-width">
<p>You are going to load the data in R’s memory using the function
<code>read_csv()</code> from the <strong><code>readr</code></strong>
package, which is part of the <strong><code>tidyverse</code></strong>;
learn more about the <strong><code>tidyverse</code></strong> collection
of packages <a href="https://www.tidyverse.org/" class="external-link">here</a>.
<strong><code>readr</code></strong> gets installed as part as the
<strong><code>tidyverse</code></strong> installation. When you load the
<strong><code>tidyverse</code></strong>
(<code><a href="https://tidyverse.tidyverse.org" class="external-link">library(tidyverse)</a></code>), the core packages (the packages used
in most data analyses) get loaded, including
<strong><code>readr</code></strong>.</p>
<p>Before proceeding, however, this is a good opportunity to talk about
conflicts. Certain packages we load can end up introducing function
names that are already in use by pre-loaded R packages. For instance,
when we load the tidyverse package below, we will introduce two
conflicting functions: <code>filter()</code> and <code>lag()</code>.
This happens because <code>filter</code> and <code>lag</code> are
already functions used by the stats package (already pre-loaded in R).
What will happen now is that if we, for example, call the
<code>filter()</code> function, R will use the
<code>dplyr::filter()</code> version and not the
<code>stats::filter()</code> one. This happens because, if conflicted,
by default R uses the function from the most recently loaded package.
Conflicted functions may cause you some trouble in the future, so it is
important that we are aware of them so that we can properly handle them,
if we want.</p>
<p>To do so, we just need the following functions from the conflicted
package:</p>
<ul>
<li>
<code>conflicted::conflict_scout()</code>: Shows us any conflicted
functions.<br>
</li>
<li>
<code>conflict_prefer("function", "package_prefered")</code>: Allows
us to choose the default function we want from now on.</li>
</ul>
<p>It is also important to know that we can, at any time, just call the
function directly from the package we want, such as
<code>stats::filter()</code>.</p>
<p>Even with the use of an RStudio project, it can be difficult to learn
how to specify paths to file locations. Enter the <strong>here</strong>
package! The here package creates paths relative to the top-level
directory (your RStudio project). These relative paths work
<em>regardless</em> of where the associated source file lives inside
your project, like analysis projects with data and reports in different
subdirectories. This is an important contrast to using
<code>setwd()</code>, which depends on the way you order your files on
your computer.</p>
<figure><img src="../fig/here_horst.png" alt="Monsters at a fork in the road, with signs saying here, and not here. One direction, not here, leads to a scary dark forest with spiders and absolute filepaths, while the other leads to a sunny, green meadow, and a city below a rainbow and a world free of absolute filepaths. Art by Allison Horst" width="100%" style="display: block; margin: auto;" class="figure"><figcaption>
Image credit:
<a href="https://github.com/allisonhorst/stats-illustrations" class="external-link">Allison
Horst</a>
</figcaption></figure><p>Before we can use the <code>read_csv()</code> and <code>here()</code>
functions, we need to load the tidyverse and here packages.</p>
<p>Also, if you recall, the missing data is encoded as “NULL” in the
dataset. We’ll tell it to the function, so R will automatically convert
all the “NULL” entries in the dataset into <code>NA</code>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">here</span><span class="op">)</span></span>
<span></span>
<span><span class="va">interviews</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span></span>
<span>  <span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"SAFI_clean.csv"</span><span class="op">)</span>, </span>
<span>  na <span class="op">=</span> <span class="st">"NULL"</span><span class="op">)</span></span></code></pre>
</div>
<p>In the above code, we notice the <code>here()</code> function takes
folder and file names as inputs (e.g., <code>"data"</code>,
<code>"SAFI_clean.csv"</code>), each enclosed in quotations
(<code>""</code>) and separated by a comma. The <code>here()</code> will
accept as many names as are necessary to navigate to a particular file
(e.g.,
<code>here("analysis", "data", "surveys", "clean", "SAFI_clean.csv)</code>).</p>
<p>The <code>here()</code> function can accept the folder and file names
in an alternate format, using a slash (“/”) rather than commas to
separate the names. The two methods are equivalent, so that
<code>here("data", "SAFI_clean.csv")</code> and
<code>here("data/SAFI_clean.csv")</code> produce the same result. (The
slash is used on all operating systems; backslashes are not used.)</p>
<p>If you were to type in the code above, it is likely that the
<code>read.csv()</code> function would appear in the automatically
populated list of functions. This function is different from the
<code>read_csv()</code> function, as it is included in the “base”
packages that come pre-installed with R. Overall,
<code>read.csv()</code> behaves similar to <code>read_csv()</code>, with
a few notable differences. First, <code>read.csv()</code> coerces column
names with spaces and/or special characters to different names
(e.g. <code>interview date</code> becomes <code>interview.date</code>).
Second, <code>read.csv()</code> stores data as a
<code>data.frame</code>, where <code>read_csv()</code> stores data as a
different kind of data frame called a <code>tibble</code>. We prefer
tibbles because they have nice printing properties among other desirable
qualities. Read more about tibbles <a href="https://tibble.tidyverse.org/" class="external-link">here</a>.</p>
<p>The second statement in the code above creates a data frame but
doesn’t output any data because, as you might recall, assignments
(<code>&lt;-</code>) don’t display anything. (Note, however, that
<code>read_csv</code> may show informational text about the data frame
that is created.) If we want to check that our data has been loaded, we
can see the contents of the data frame by typing its name:
<code>interviews</code> in the console.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span></span>
<span><span class="co">## Try also</span></span>
<span><span class="co">## view(interviews)</span></span>
<span><span class="co">## head(interviews)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 131 × 14
   key_ID village  interview_date      no_membrs years_liv respondent_wall_type
    &lt;dbl&gt; &lt;chr&gt;    &lt;dttm&gt;                  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
 1      1 God      2016-11-17 00:00:00         3         4 muddaub
 2      2 God      2016-11-17 00:00:00         7         9 muddaub
 3      3 God      2016-11-17 00:00:00        10        15 burntbricks
 4      4 God      2016-11-17 00:00:00         7         6 burntbricks
 5      5 God      2016-11-17 00:00:00         7        40 burntbricks
 6      6 God      2016-11-17 00:00:00         3         3 muddaub
 7      7 God      2016-11-17 00:00:00         6        38 muddaub
 8      8 Chirodzo 2016-11-16 00:00:00        12        70 burntbricks
 9      9 Chirodzo 2016-11-16 00:00:00         8         6 burntbricks
10     10 Chirodzo 2016-12-16 00:00:00        12        23 burntbricks
# ℹ 121 more rows
# ℹ 8 more variables: rooms &lt;dbl&gt;, memb_assoc &lt;chr&gt;, affect_conflicts &lt;chr&gt;,
#   liv_count &lt;dbl&gt;, items_owned &lt;chr&gt;, no_meals &lt;dbl&gt;, months_lack_food &lt;chr&gt;,
#   instanceID &lt;chr&gt;</code></pre>
</div>
<div id="note" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note" class="callout-inner">
<h3 class="callout-title">Note</h3>
<div class="callout-content">
<p><code>read_csv()</code> assumes that fields are delimited by commas.
However, in several countries, the comma is used as a decimal separator
and the semicolon (;) is used as a field delimiter. If you want to read
in this type of files in R, you can use the <code>read_csv2</code>
function. It behaves exactly like <code>read_csv</code> but uses
different parameters for the decimal and the field separators. If you
are working with another format, they can be both specified by the user.
Check out the help for <code>read_csv()</code> by typing
<code>?read_csv</code> to learn more. There is also the
<code>read_tsv()</code> for tab-separated data files, and
<code>read_delim()</code> allows you to specify more details about the
structure of your file.</p>
</div>
</div>
</div>
<p>Note that <code>read_csv()</code> actually loads the data as a
tibble. A tibble is an extension of <code>R</code> data frames used by
the <strong><code>tidyverse</code></strong>. When the data is read using
<code>read_csv()</code>, it is stored in an object of class
<code>tbl_df</code>, <code>tbl</code>, and <code>data.frame</code>. You
can see the class of an object with</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">interviews</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "spec_tbl_df" "tbl_df"      "tbl"         "data.frame" </code></pre>
</div>
<p>As a <code>tibble</code>, the type of data included in each column is
listed in an abbreviated fashion below the column names. For instance,
here <code>key_ID</code> is a column of floating point numbers
(abbreviated <code>&lt;dbl&gt;</code> for the word ‘double’),
<code>village</code> is a column of characters
(<code>&lt;chr&gt;</code>) and the <code>interview_date</code> is a
column in the “date and time” format (<code>&lt;dttm&gt;</code>).</p>
</section><section><h2 class="section-heading" id="inspecting-data-frames">Inspecting data frames<a class="anchor" aria-label="anchor" href="#inspecting-data-frames"></a>
</h2>
<hr class="half-width">
<p>When calling a <code>tbl_df</code> object (like
<code>interviews</code> here), there is already a lot of information
about our data frame being displayed such as the number of rows, the
number of columns, the names of the columns, and as we just saw the
class of data stored in each column. However, there are functions to
extract this information from data frames. Here is a non-exhaustive list
of some of these functions. Let’s try them out!</p>
<p>Size:</p>
<ul>
<li>
<code>dim(interviews)</code> - returns a vector with the number of
rows as the first element, and the number of columns as the second
element (the <strong>dim</strong>ensions of the object)</li>
<li>
<code>nrow(interviews)</code> - returns the number of rows</li>
<li>
<code>ncol(interviews)</code> - returns the number of columns</li>
</ul>
<p>Content:</p>
<ul>
<li>
<code>head(interviews)</code> - shows the first 6 rows</li>
<li>
<code>tail(interviews)</code> - shows the last 6 rows</li>
</ul>
<p>Names:</p>
<ul>
<li>
<code>names(interviews)</code> - returns the column names (synonym
of <code>colnames()</code> for <code>data.frame</code> objects)</li>
</ul>
<p>Summary:</p>
<ul>
<li>
<code>str(interviews)</code> - structure of the object and
information about the class, length and content of each column</li>
<li>
<code>summary(interviews)</code> - summary statistics for each
column</li>
<li>
<code>glimpse(interviews)</code> - returns the number of columns and
rows of the tibble, the names and class of each column, and previews as
many values will fit on the screen. Unlike the other inspecting
functions listed above, <code>glimpse()</code> is not a “base R”
function so you need to have the <code>dplyr</code> or
<code>tibble</code> packages loaded to be able to execute it.</li>
</ul>
<p>Note: most of these functions are “generic.” They can be used on
other types of objects besides data frames or tibbles.</p>
</section><section><h2 class="section-heading" id="subsetting-data-frames">Subsetting data frames<a class="anchor" aria-label="anchor" href="#subsetting-data-frames"></a>
</h2>
<hr class="half-width">
<p>Our <code>interviews</code> data frame has rows and columns (it has 2
dimensions). In practice, we may not need the entire data frame; for
instance, we may only be interested in a subset of the observations (the
rows) or a particular set of variables (the columns). If we want to
access some specific data from it, we need to specify the “coordinates”
(i.e., indices) we want from it. Row numbers come first, followed by
column numbers.</p>
<div id="tip" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip" class="callout-inner">
<h3 class="callout-title">Tip</h3>
<div class="callout-content">
<p>Subsetting a <code>tibble</code> with <code>[</code> always results
in a <code>tibble</code>. However, note this is not true in general for
data frames, so be careful! Different ways of specifying these
coordinates can lead to results with different classes. This is covered
in the Software Carpentry lesson <a href="https://swcarpentry.github.io/r-novice-gapminder/" class="external-link">R for
Reproducible Scientific Analysis</a>.</p>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## first element in the first column of the tibble</span></span>
<span><span class="va">interviews</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 1
  key_ID
   &lt;dbl&gt;
1      1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## first element in the 6th column of the tibble </span></span>
<span><span class="va">interviews</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">6</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 1
  respondent_wall_type
  &lt;chr&gt;
1 muddaub             </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## first column of the tibble (as a vector)</span></span>
<span><span class="va">interviews</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18
 [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36
 [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54
 [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71 127
 [73] 133 152 153 155 178 177 180 181 182 186 187 195 196 197 198 201 202  72
 [91]  73  76  83  85  89 101 103 102  78  80 104 105 106 109 110 113 118 125
[109] 119 115 108 116 117 144 143 150 159 160 165 166 167 174 175 189 191 192
[127] 126 193 194 199 200</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## first column of the tibble</span></span>
<span><span class="va">interviews</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 131 × 1
   key_ID
    &lt;dbl&gt;
 1      1
 2      2
 3      3
 4      4
 5      5
 6      6
 7      7
 8      8
 9      9
10     10
# ℹ 121 more rows</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## first three elements in the 7th column of the tibble</span></span>
<span><span class="va">interviews</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">7</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 1
  rooms
  &lt;dbl&gt;
1     1
2     1
3     1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## the 3rd row of the tibble</span></span>
<span><span class="va">interviews</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 14
  key_ID village interview_date      no_membrs years_liv respondent_wall_type
   &lt;dbl&gt; &lt;chr&gt;   &lt;dttm&gt;                  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
1      3 God     2016-11-17 00:00:00        10        15 burntbricks
# ℹ 8 more variables: rooms &lt;dbl&gt;, memb_assoc &lt;chr&gt;, affect_conflicts &lt;chr&gt;,
#   liv_count &lt;dbl&gt;, items_owned &lt;chr&gt;, no_meals &lt;dbl&gt;, months_lack_food &lt;chr&gt;,
#   instanceID &lt;chr&gt;</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## equivalent to head_interviews &lt;- head(interviews)</span></span>
<span><span class="va">head_interviews</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="op">]</span></span></code></pre>
</div>
<p><code>:</code> is a special function that creates numeric vectors of
integers in increasing or decreasing order, test <code>1:10</code> and
<code>10:1</code> for instance.</p>
<p>You can also exclude certain indices of a data frame using the
“<code>-</code>” sign:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>          <span class="co"># The whole tibble, except the first column</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 131 × 13
   village  interview_date      no_membrs years_liv respondent_wall_type rooms
   &lt;chr&gt;    &lt;dttm&gt;                  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                &lt;dbl&gt;
 1 God      2016-11-17 00:00:00         3         4 muddaub                  1
 2 God      2016-11-17 00:00:00         7         9 muddaub                  1
 3 God      2016-11-17 00:00:00        10        15 burntbricks              1
 4 God      2016-11-17 00:00:00         7         6 burntbricks              1
 5 God      2016-11-17 00:00:00         7        40 burntbricks              1
 6 God      2016-11-17 00:00:00         3         3 muddaub                  1
 7 God      2016-11-17 00:00:00         6        38 muddaub                  1
 8 Chirodzo 2016-11-16 00:00:00        12        70 burntbricks              3
 9 Chirodzo 2016-11-16 00:00:00         8         6 burntbricks              1
10 Chirodzo 2016-12-16 00:00:00        12        23 burntbricks              5
# ℹ 121 more rows
# ℹ 7 more variables: memb_assoc &lt;chr&gt;, affect_conflicts &lt;chr&gt;,
#   liv_count &lt;dbl&gt;, items_owned &lt;chr&gt;, no_meals &lt;dbl&gt;, months_lack_food &lt;chr&gt;,
#   instanceID &lt;chr&gt;</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span><span class="op">[</span><span class="op">-</span><span class="fu">c</span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="fl">131</span><span class="op">)</span>, <span class="op">]</span>   <span class="co"># Equivalent to head(interviews)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 14
  key_ID village interview_date      no_membrs years_liv respondent_wall_type
   &lt;dbl&gt; &lt;chr&gt;   &lt;dttm&gt;                  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
1      1 God     2016-11-17 00:00:00         3         4 muddaub
2      2 God     2016-11-17 00:00:00         7         9 muddaub
3      3 God     2016-11-17 00:00:00        10        15 burntbricks
4      4 God     2016-11-17 00:00:00         7         6 burntbricks
5      5 God     2016-11-17 00:00:00         7        40 burntbricks
6      6 God     2016-11-17 00:00:00         3         3 muddaub
# ℹ 8 more variables: rooms &lt;dbl&gt;, memb_assoc &lt;chr&gt;, affect_conflicts &lt;chr&gt;,
#   liv_count &lt;dbl&gt;, items_owned &lt;chr&gt;, no_meals &lt;dbl&gt;, months_lack_food &lt;chr&gt;,
#   instanceID &lt;chr&gt;</code></pre>
</div>
<p><code>tibble</code>s can be subset by calling indices (as shown
previously), but also by calling their column names directly:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span><span class="op">[</span><span class="st">"village"</span><span class="op">]</span>       <span class="co"># Result is a tibble</span></span>
<span></span>
<span><span class="va">interviews</span><span class="op">[</span>, <span class="st">"village"</span><span class="op">]</span>     <span class="co"># Result is a tibble</span></span>
<span></span>
<span><span class="va">interviews</span><span class="op">[[</span><span class="st">"village"</span><span class="op">]</span><span class="op">]</span>     <span class="co"># Result is a vector</span></span>
<span></span>
<span><span class="va">interviews</span><span class="op">$</span><span class="va">village</span>          <span class="co"># Result is a vector</span></span></code></pre>
</div>
<p>In RStudio, you can use the autocompletion feature to get the full
and correct names of the columns.</p>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Create a tibble (<code>interviews_100</code>) containing only the
data in row 100 of the <code>interviews</code> dataset.</li>
</ol>
<p>Now, continue using <code>interviews</code> for each of the following
activities:</p>
<ol start="2" style="list-style-type: decimal">
<li>Notice how <code>nrow()</code> gave you the number of rows in the
tibble?</li>
</ol>
<ul>
<li>Use that number to pull out just that last row in the tibble.</li>
<li>Compare that with what you see as the last row using
<code>tail()</code> to make sure it’s meeting expectations.</li>
<li>Pull out that last row using <code>nrow()</code> instead of the row
number.</li>
<li>Create a new tibble (<code>interviews_last</code>) from that last
row.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><p>Using the number of rows in the interviews dataset that you found
in question 2, extract the row that is in the middle of the dataset.
Store the content of this middle row in an object named
<code>interviews_middle</code>. (hint: This dataset has an odd number of
rows, so finding the middle is a bit trickier than dividing n_rows by 2.
Use the median( ) function and what you’ve learned about sequences in R
to extract the middle row!</p></li>
<li><p>Combine <code>nrow()</code> with the <code>-</code> notation
above to reproduce the behavior of <code>head(interviews)</code>,
keeping just the first through 6th rows of the interviews
dataset.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 1.</span></span>
<span><span class="va">interviews_100</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">[</span><span class="fl">100</span>, <span class="op">]</span></span>
<span><span class="co">## 2.</span></span>
<span><span class="co"># Saving `n_rows` to improve readability and reduce duplication</span></span>
<span><span class="va">n_rows</span> <span class="op">&lt;-</span> <span class="fu">nrow</span><span class="op">(</span><span class="va">interviews</span><span class="op">)</span></span>
<span><span class="va">interviews_last</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">[</span><span class="va">n_rows</span>, <span class="op">]</span></span>
<span><span class="co">## 3.</span></span>
<span><span class="va">interviews_middle</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">[</span><span class="fu">median</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_rows</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="co">## 4.</span></span>
<span><span class="va">interviews_head</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="va">n_rows</span><span class="op">)</span>, <span class="op">]</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="factors">Factors<a class="anchor" aria-label="anchor" href="#factors"></a>
</h2>
<hr class="half-width">
<p>R has a special data class, called factor, to deal with categorical
data that you may encounter when creating plots or doing statistical
analyses. Factors are very useful and actually contribute to making R
particularly well suited to working with data. So we are going to spend
a little time introducing them.</p>
<p>Factors represent categorical data. They are stored as integers
associated with labels and they can be ordered (ordinal) or unordered
(nominal). Factors create a structured relation between the different
levels (values) of a categorical variable, such as days of the week or
responses to a question in a survey. This can make it easier to see how
one element relates to the other elements in a column. While factors
look (and often behave) like character vectors, they are actually
treated as integer vectors by <code>R</code>. So you need to be very
careful when treating them as strings.</p>
<p>Once created, factors can only contain a pre-defined set of values,
known as <em>levels</em>. By default, R always sorts levels in
alphabetical order. For instance, if you have a factor with 2
levels:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">respondent_floor_type</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"earth"</span>, <span class="st">"cement"</span>, <span class="st">"cement"</span>, <span class="st">"earth"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>R will assign <code>1</code> to the level <code>"cement"</code> and
<code>2</code> to the level <code>"earth"</code> (because <code>c</code>
comes before <code>e</code>, even though the first element in this
vector is <code>"earth"</code>). You can see this by using the function
<code>levels()</code> and you can find the number of levels using
<code>nlevels()</code>:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">levels</span><span class="op">(</span><span class="va">respondent_floor_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "cement" "earth" </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nlevels</span><span class="op">(</span><span class="va">respondent_floor_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2</code></pre>
</div>
<p>Sometimes, the order of the factors does not matter. Other times you
might want to specify the order because it is meaningful (e.g., “low”,
“medium”, “high”). It may improve your visualization, or it may be
required by a particular type of analysis. Here, one way to reorder our
levels in the <code>respondent_floor_type</code> vector would be:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">respondent_floor_type</span> <span class="co"># current order</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] earth  cement cement earth
Levels: cement earth</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">respondent_floor_type</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="va">respondent_floor_type</span>, </span>
<span>                                levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"earth"</span>, <span class="st">"cement"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">respondent_floor_type</span> <span class="co"># after re-ordering</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] earth  cement cement earth
Levels: earth cement</code></pre>
</div>
<p>In R’s memory, these factors are represented by integers (1, 2), but
are more informative than integers because factors are self describing:
<code>"cement"</code>, <code>"earth"</code> is more descriptive than
<code>1</code>, and <code>2</code>. Which one is “earth”? You wouldn’t
be able to tell just from the integer data. Factors, on the other hand,
have this information built in. It is particularly helpful when there
are many levels. It also makes renaming levels easier. Let’s say we made
a mistake and need to recode “cement” to “brick”. We can do this using
the <code>fct_recode()</code> function from the
<strong><code>forcats</code></strong> package (included in the
<strong><code>tidyverse</code></strong>) which provides some extra tools
to work with factors.</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">levels</span><span class="op">(</span><span class="va">respondent_floor_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "earth"  "cement"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">respondent_floor_type</span> <span class="op">&lt;-</span> <span class="fu">fct_recode</span><span class="op">(</span><span class="va">respondent_floor_type</span>, brick <span class="op">=</span> <span class="st">"cement"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## as an alternative, we could change the "cement" level directly using the</span></span>
<span><span class="co">## levels() function, but we have to remember that "cement" is the second level</span></span>
<span><span class="co"># levels(respondent_floor_type)[2] &lt;- "brick"</span></span>
<span></span>
<span><span class="fu">levels</span><span class="op">(</span><span class="va">respondent_floor_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "earth" "brick"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">respondent_floor_type</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] earth brick brick earth
Levels: earth brick</code></pre>
</div>
<p>So far, your factor is unordered, like a nominal variable. R does not
know the difference between a nominal and an ordinal variable. You make
your factor an ordered factor by using the <code>ordered=TRUE</code>
option inside your factor function. Note how the reported levels changed
from the unordered factor above to the ordered version below. Ordered
levels use the less than sign <code>&lt;</code> to denote level
ranking.</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">respondent_floor_type_ordered</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="va">respondent_floor_type</span>, </span>
<span>                                        ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">respondent_floor_type_ordered</span> <span class="co"># after setting as ordered factor</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] earth brick brick earth
Levels: earth &lt; brick</code></pre>
</div>
<div class="section level3">
<h3 id="converting-factors">Converting factors<a class="anchor" aria-label="anchor" href="#converting-factors"></a>
</h3>
<p>If you need to convert a factor to a character vector, you use
<code>as.character(x)</code>.</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">as.character</span><span class="op">(</span><span class="va">respondent_floor_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "earth" "brick" "brick" "earth"</code></pre>
</div>
<p>Converting factors where the levels appear as numbers (such as
concentration levels, or years) to a numeric vector is a little
trickier. The <code>as.numeric()</code> function returns the index
values of the factor, not its levels, so it will result in an entirely
new (and unwanted in this case) set of numbers. One method to avoid this
is to convert factors to characters, and then to numbers. Another method
is to use the <code>levels()</code> function. Compare:</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">year_fct</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">1990</span>, <span class="fl">1983</span>, <span class="fl">1977</span>, <span class="fl">1998</span>, <span class="fl">1990</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">as.numeric</span><span class="op">(</span><span class="va">year_fct</span><span class="op">)</span>                     <span class="co"># Wrong! And there is no warning...</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3 2 1 4 3</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">as.numeric</span><span class="op">(</span><span class="fu">as.character</span><span class="op">(</span><span class="va">year_fct</span><span class="op">)</span><span class="op">)</span>       <span class="co"># Works...</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1990 1983 1977 1998 1990</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">as.numeric</span><span class="op">(</span><span class="fu">levels</span><span class="op">(</span><span class="va">year_fct</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="va">year_fct</span><span class="op">]</span>   <span class="co"># The recommended way.</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1990 1983 1977 1998 1990</code></pre>
</div>
<p>Notice that in the recommended <code>levels()</code> approach, three
important steps occur:</p>
<ul>
<li>We obtain all the factor levels using
<code>levels(year_fct)</code>
</li>
<li>We convert these levels to numeric values using
<code>as.numeric(levels(year_fct))</code>
</li>
<li>We then access these numeric values using the underlying integers of
the vector <code>year_fct</code> inside the square brackets</li>
</ul>
</div>
<div class="section level3">
<h3 id="renaming-factors">Renaming factors<a class="anchor" aria-label="anchor" href="#renaming-factors"></a>
</h3>
<p>When your data is stored as a factor, you can use the
<code>plot()</code> function to get a quick glance at the number of
observations represented by each factor level. Let’s extract the
<code>memb_assoc</code> column from our data frame, convert it into a
factor, and use it to look at the number of interview respondents who
were or were not members of an irrigation association:</p>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## create a vector from the data frame column "memb_assoc"</span></span>
<span><span class="va">memb_assoc</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">$</span><span class="va">memb_assoc</span></span>
<span></span>
<span><span class="co">## convert it into a factor</span></span>
<span><span class="va">memb_assoc</span> <span class="op">&lt;-</span> <span class="fu">as.factor</span><span class="op">(</span><span class="va">memb_assoc</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## let's see what it looks like</span></span>
<span><span class="va">memb_assoc</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1] &lt;NA&gt; yes  &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; no   yes  no   no   &lt;NA&gt; yes  no   &lt;NA&gt; yes
 [16] &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; no   &lt;NA&gt; &lt;NA&gt; no   no   no   &lt;NA&gt; no   yes  &lt;NA&gt;
 [31] &lt;NA&gt; yes  no   yes  yes  yes  &lt;NA&gt; yes  &lt;NA&gt; yes  &lt;NA&gt; no   no   &lt;NA&gt; no
 [46] no   yes  &lt;NA&gt; &lt;NA&gt; yes  &lt;NA&gt; no   yes  no   &lt;NA&gt; yes  no   no   &lt;NA&gt; no
 [61] yes  &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; no   yes  no   no   no   no   yes  &lt;NA&gt; no   yes  &lt;NA&gt;
 [76] &lt;NA&gt; yes  no   no   yes  no   no   yes  no   yes  no   no   &lt;NA&gt; yes  yes
 [91] yes  yes  yes  no   no   no   no   yes  no   no   yes  yes  no   &lt;NA&gt; no
[106] no   &lt;NA&gt; no   no   &lt;NA&gt; no   &lt;NA&gt; &lt;NA&gt; no   no   no   no   yes  no   no
[121] no   no   no   no   no   no   no   no   no   yes  &lt;NA&gt;
Levels: no yes</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## bar plot of the number of interview respondents who were</span></span>
<span><span class="co">## members of irrigation association:</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">memb_assoc</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/02-starting-with-data-rendered-factor-plot-default-order-1.png" alt="Yes/no bar graph showing number of individuals who are members of irrigation association" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Looking at the plot compared to the output of the vector, we can see
that in addition to “no”s and “yes”s, there are some respondents for
whom the information about whether they were part of an irrigation
association hasn’t been recorded, and encoded as missing data. These
respondents do not appear on the plot. Let’s encode them differently so
they can be counted and visualized in our plot.</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Let's recreate the vector from the data frame column "memb_assoc"</span></span>
<span><span class="va">memb_assoc</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">$</span><span class="va">memb_assoc</span></span>
<span></span>
<span><span class="co">## replace the missing data with "undetermined"</span></span>
<span><span class="va">memb_assoc</span><span class="op">[</span><span class="fu">is.na</span><span class="op">(</span><span class="va">memb_assoc</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"undetermined"</span></span>
<span></span>
<span><span class="co">## convert it into a factor</span></span>
<span><span class="va">memb_assoc</span> <span class="op">&lt;-</span> <span class="fu">as.factor</span><span class="op">(</span><span class="va">memb_assoc</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## let's see what it looks like</span></span>
<span><span class="va">memb_assoc</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1] undetermined yes          undetermined undetermined undetermined
  [6] undetermined no           yes          no           no
 [11] undetermined yes          no           undetermined yes
 [16] undetermined undetermined undetermined undetermined undetermined
 [21] no           undetermined undetermined no           no
 [26] no           undetermined no           yes          undetermined
 [31] undetermined yes          no           yes          yes
 [36] yes          undetermined yes          undetermined yes
 [41] undetermined no           no           undetermined no
 [46] no           yes          undetermined undetermined yes
 [51] undetermined no           yes          no           undetermined
 [56] yes          no           no           undetermined no
 [61] yes          undetermined undetermined undetermined no
 [66] yes          no           no           no           no
 [71] yes          undetermined no           yes          undetermined
 [76] undetermined yes          no           no           yes
 [81] no           no           yes          no           yes
 [86] no           no           undetermined yes          yes
 [91] yes          yes          yes          no           no
 [96] no           no           yes          no           no
[101] yes          yes          no           undetermined no
[106] no           undetermined no           no           undetermined
[111] no           undetermined undetermined no           no
[116] no           no           yes          no           no
[121] no           no           no           no           no
[126] no           no           no           no           yes
[131] undetermined
Levels: no undetermined yes</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## bar plot of the number of interview respondents who were</span></span>
<span><span class="co">## members of irrigation association:</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">memb_assoc</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/02-starting-with-data-rendered-factor-plot-reorder-1.png" alt="Bar plot of association membership, showing missing responses." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<ul>
<li><p>Rename the levels of the factor to have the first letter in
uppercase: “No”,“Undetermined”, and “Yes”.</p></li>
<li><p>Now that we have renamed the factor level to “Undetermined”, can
you recreate the barplot such that “Undetermined” is last (after
“Yes”)?</p></li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Rename levels.</span></span>
<span><span class="va">memb_assoc</span> <span class="op">&lt;-</span> <span class="fu">fct_recode</span><span class="op">(</span><span class="va">memb_assoc</span>, No <span class="op">=</span> <span class="st">"no"</span>,</span>
<span>                         Undetermined <span class="op">=</span> <span class="st">"undetermined"</span>, Yes <span class="op">=</span> <span class="st">"yes"</span><span class="op">)</span></span>
<span><span class="co">## Reorder levels. Note we need to use the new level names.</span></span>
<span><span class="va">memb_assoc</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="va">memb_assoc</span>, levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"Undetermined"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">memb_assoc</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/02-starting-with-data-rendered-factor-plot-exercise-1.png" alt="bar graph showing number of individuals who are members of irrigation association, including undetermined option" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="formatting-dates">Formatting Dates<a class="anchor" aria-label="anchor" href="#formatting-dates"></a>
</h2>
<hr class="half-width">
<p>One of the most common issues that new (and experienced!) R users
have is converting date and time information into a variable that is
appropriate and usable during analyses. A best practice for dealing with
date data is to ensure that each component of your date is available as
a separate variable. In our dataset, we have a column
<code>interview_date</code> which contains information about the year,
month, and day that the interview was conducted. Let’s convert those
dates into three separate columns.</p>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">interviews</span><span class="op">)</span></span></code></pre>
</div>
<p>We are going to use the package
<strong><code>lubridate</code></strong>, , which is included in the
<strong><code>tidyverse</code></strong> installation and should be
loaded by default. However, if we deal with older versions of tidyverse
(2022 and ealier), we can manually load it by typing
<code><a href="https://lubridate.tidyverse.org" class="external-link">library(lubridate)</a></code>.</p>
<p>If necessary, start by loading the required package:</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">lubridate</span><span class="op">)</span></span></code></pre>
</div>
<p>The lubridate function <code>ymd()</code> takes a vector representing
year, month, and day, and converts it to a <code>Date</code> vector.
<code>Date</code> is a class of data recognized by R as being a date and
can be manipulated as such. The argument that the function requires is
flexible, but, as a best practice, is a character vector formatted as
“YYYY-MM-DD”.</p>
<p>Let’s extract our <code>interview_date</code> column and inspect the
structure:</p>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">$</span><span class="va">interview_date</span></span>
<span><span class="fu">str</span><span class="op">(</span><span class="va">dates</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> POSIXct[1:131], format: "2016-11-17" "2016-11-17" "2016-11-17" "2016-11-17" "2016-11-17" ...</code></pre>
</div>
<p>When we imported the data in R, <code>read_csv()</code> recognized
that this column contained date information. We can now use the
<code>day()</code>, <code>month()</code> and <code>year()</code>
functions to extract this information from the date, and create new
columns in our data frame to store it:</p>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span><span class="op">$</span><span class="va">day</span> <span class="op">&lt;-</span> <span class="fu">day</span><span class="op">(</span><span class="va">dates</span><span class="op">)</span></span>
<span><span class="va">interviews</span><span class="op">$</span><span class="va">month</span> <span class="op">&lt;-</span> <span class="fu">month</span><span class="op">(</span><span class="va">dates</span><span class="op">)</span></span>
<span><span class="va">interviews</span><span class="op">$</span><span class="va">year</span> <span class="op">&lt;-</span> <span class="fu">year</span><span class="op">(</span><span class="va">dates</span><span class="op">)</span></span>
<span><span class="va">interviews</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 131 × 17
   key_ID village  interview_date      no_membrs years_liv respondent_wall_type
    &lt;dbl&gt; &lt;chr&gt;    &lt;dttm&gt;                  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
 1      1 God      2016-11-17 00:00:00         3         4 muddaub
 2      2 God      2016-11-17 00:00:00         7         9 muddaub
 3      3 God      2016-11-17 00:00:00        10        15 burntbricks
 4      4 God      2016-11-17 00:00:00         7         6 burntbricks
 5      5 God      2016-11-17 00:00:00         7        40 burntbricks
 6      6 God      2016-11-17 00:00:00         3         3 muddaub
 7      7 God      2016-11-17 00:00:00         6        38 muddaub
 8      8 Chirodzo 2016-11-16 00:00:00        12        70 burntbricks
 9      9 Chirodzo 2016-11-16 00:00:00         8         6 burntbricks
10     10 Chirodzo 2016-12-16 00:00:00        12        23 burntbricks
# ℹ 121 more rows
# ℹ 11 more variables: rooms &lt;dbl&gt;, memb_assoc &lt;chr&gt;, affect_conflicts &lt;chr&gt;,
#   liv_count &lt;dbl&gt;, items_owned &lt;chr&gt;, no_meals &lt;dbl&gt;, months_lack_food &lt;chr&gt;,
#   instanceID &lt;chr&gt;, day &lt;int&gt;, month &lt;dbl&gt;, year &lt;dbl&gt;</code></pre>
</div>
<p>Notice the three new columns at the end of our data frame.</p>
<p>In our example above, the <code>interview_date</code> column was read
in correctly as a <code>Date</code> variable but generally that is not
the case. Date columns are often read in as <code>character</code>
variables and one can use the <code>as_date()</code> function to convert
them to the appropriate <code>Date/POSIXct</code>format.</p>
<p>Let’s say we have a vector of dates in character format:</p>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">char_dates</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"7/31/2012"</span>, <span class="st">"8/9/2014"</span>, <span class="st">"4/30/2016"</span><span class="op">)</span></span>
<span><span class="fu">str</span><span class="op">(</span><span class="va">char_dates</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> chr [1:3] "7/31/2012" "8/9/2014" "4/30/2016"</code></pre>
</div>
<p>We can convert this vector to dates as :</p>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">as_date</span><span class="op">(</span><span class="va">char_dates</span>, format <span class="op">=</span> <span class="st">"%m/%d/%Y"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "2012-07-31" "2014-08-09" "2016-04-30"</code></pre>
</div>
<p>Argument <code>format</code> tells the function the order to parse
the characters and identify the month, day and year. The format above is
the equivalent of mm/dd/yyyy. A wrong format can lead to parsing errors
or incorrect results.</p>
<p>For example, observe what happens when we use a lower case y instead
of upper case Y for the year.</p>
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">as_date</span><span class="op">(</span><span class="va">char_dates</span>, format <span class="op">=</span> <span class="st">"%m/%d/%y"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: 3 failed to parse.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] NA NA NA</code></pre>
</div>
<p>Here, the <code>%y</code> part of the format stands for a two-digit
year instead of a four-digit year, and this leads to parsing errors.</p>
<p>Or in the following example, observe what happens when the month and
day elements of the format are switched.</p>
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">as_date</span><span class="op">(</span><span class="va">char_dates</span>, format <span class="op">=</span> <span class="st">"%d/%m/%y"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: 3 failed to parse.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] NA NA NA</code></pre>
</div>
<p>Since there is no month numbered 30 or 31, the first and third dates
cannot be parsed.</p>
<p>We can also use functions <code>ymd()</code>, <code>mdy()</code> or
<code>dmy()</code> to convert character variables to date.</p>
<div class="codewrapper sourceCode" id="cb73">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mdy</span><span class="op">(</span><span class="va">char_dates</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "2012-07-31" "2014-08-09" "2016-04-30"</code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use read_csv to read tabular data in R.</li>
<li>Use factors to represent categorical data in R.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-03-dplyr"><p>Content from <a href="03-dplyr.html">Data Wrangling with dplyr</a></p>
<hr>
<p>Last updated on 2025-07-01 |

        <a href="https://github.com/datacarpentry/r-socialsci/edit/main/episodes/03-dplyr.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<ul>
<li>This lesson works better if you have graphics demonstrating dplyr
commands. You can modify <a href="https://docs.google.com/presentation/d/1A9abypFdFp8urAe9z7GCMjFr4aPeIb8mZAtJA2F7H0w/edit#slide=id.g652714585f_0_114" class="external-link">this
Google Slides deck</a> and use it for your workshop.</li>
<li>For this lesson make sure that learners are comfortable using
pipes.</li>
<li>There is also sometimes some confusion on what the arguments of
<code>group_by</code> should be, and when to use <code>filter()</code>
and <code>select()</code>.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I select specific rows and/or columns from a dataframe?</li>
<li>How can I combine multiple commands into a single command?</li>
<li>How can I create new columns or remove existing columns from a
dataframe?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe the purpose of an R package and the
<strong><code>dplyr</code></strong> package.</li>
<li>Select certain columns in a dataframe with the
<strong><code>dplyr</code></strong> function <code>select</code>.</li>
<li>Select certain rows in a dataframe according to filtering conditions
with the <strong><code>dplyr</code></strong> function
<code>filter</code>.</li>
<li>Link the output of one <strong><code>dplyr</code></strong> function
to the input of another function with the ‘pipe’ operator
<code>%&gt;%</code>.</li>
<li>Add new columns to a dataframe that are functions of existing
columns with <code>mutate</code>.</li>
<li>Use the split-apply-combine concept for data analysis.</li>
<li>Use <code>summarize</code>, <code>group_by</code>, and
<code>count</code> to split a dataframe into groups of observations,
apply a summary statistics for each group, and then combine the
results.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p><strong><code>dplyr</code></strong> is a package for making tabular
data wrangling easier by using a limited set of functions that can be
combined to extract and summarize insights from your data.</p>
<p>Like <strong><code>readr</code></strong>,
<strong><code>dplyr</code></strong> is a part of the tidyverse. These
packages were loaded in R’s memory when we called
<code><a href="https://tidyverse.tidyverse.org" class="external-link">library(tidyverse)</a></code> earlier.</p>
<div id="note" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note" class="callout-inner">
<h3 class="callout-title">Note</h3>
<div class="callout-content">
<p>The packages in the tidyverse, namely
<strong><code>dplyr</code></strong>, <strong><code>tidyr</code></strong>
and <strong><code>ggplot2</code></strong> accept both the British
(e.g. <em>summarise</em>) and American (e.g. <em>summarize</em>)
spelling variants of different function and option names. For this
lesson, we utilize the American spellings of different functions;
however, feel free to use the regional variant for where you are
teaching.</p>
</div>
</div>
</div>
<section><h2 class="section-heading" id="what-is-an-r-package">What is an R package?<a class="anchor" aria-label="anchor" href="#what-is-an-r-package"></a>
</h2>
<hr class="half-width">
<p>The package <strong><code>dplyr</code></strong> provides easy tools
for the most common data wrangling tasks. It is built to work directly
with dataframes, with many common tasks optimized by being written in a
compiled language (C++) (not all R packages are written in R!).</p>
<p>There are also packages available for a wide range of tasks including
building plots (<strong><code>ggplot2</code></strong>, which we’ll see
later), downloading data from the NCBI database, or performing
statistical analysis on your data set. Many packages such as these are
housed on, and downloadable from, the <strong>C</strong>omprehensive
<strong>R</strong> <strong>A</strong>rchive <strong>N</strong>etwork
(CRAN) using <code>install.packages</code>. This function makes the
package accessible by your R installation with the command
<code>library()</code>, as you did with <code>tidyverse</code>
earlier.</p>
<p>To easily access the documentation for a package within R or RStudio,
use <code><a href="https://rdrr.io/pkg/package_name/man" class="external-link">help(package = "package_name")</a></code>.</p>
<p>To learn more about <strong><code>dplyr</code></strong> after the
workshop, you may want to check out this <a href="https://github.com/rstudio/cheatsheets/blob/main/data-transformation.pdf" class="external-link">handy
data transformation with <strong><code>dplyr</code></strong>
cheatsheet</a>.</p>
<div id="note-1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note-1" class="callout-inner">
<h3 class="callout-title">Note</h3>
<div class="callout-content">
<p>There are alternatives to the <code>tidyverse</code> packages for
data wrangling, including the package <a href="https://rdatatable.gitlab.io/data.table/" class="external-link"><code>data.table</code></a>.
See this <a href="https://mgimond.github.io/rug_2019_12/Index.html" class="external-link">comparison</a>
for example to get a sense of the differences between using
<code>base</code>, <code>tidyverse</code>, and
<code>data.table</code>.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="learning-dplyr">Learning <strong><code>dplyr</code></strong>
<a class="anchor" aria-label="anchor" href="#learning-dplyr"></a>
</h2>
<hr class="half-width">
<p>To make sure everyone will use the same dataset for this lesson,
we’ll read again the SAFI dataset that we downloaded earlier.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## load the tidyverse</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">here</span><span class="op">)</span></span>
<span></span>
<span><span class="va">interviews</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"SAFI_clean.csv"</span><span class="op">)</span>, na <span class="op">=</span> <span class="st">"NULL"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## inspect the data</span></span>
<span><span class="va">interviews</span></span>
<span></span>
<span><span class="co">## preview the data</span></span>
<span><span class="co"># view(interviews)</span></span></code></pre>
</div>
<p>We’re going to learn some of the most common
<strong><code>dplyr</code></strong> functions:</p>
<ul>
<li>
<code>select()</code>: subset columns</li>
<li>
<code>filter()</code>: subset rows on conditions</li>
<li>
<code>mutate()</code>: create new columns by using information from
other columns</li>
<li>
<code>group_by()</code> and <code>summarize()</code>: create summary
statistics on grouped data</li>
<li>
<code>arrange()</code>: sort results</li>
<li>
<code>count()</code>: count discrete values</li>
</ul></section><section><h2 class="section-heading" id="selecting-columns-and-filtering-rows">Selecting columns and filtering rows<a class="anchor" aria-label="anchor" href="#selecting-columns-and-filtering-rows"></a>
</h2>
<hr class="half-width">
<p>To select columns of a dataframe, use <code>select()</code>. The
first argument to this function is the dataframe
(<code>interviews</code>), and the subsequent arguments are the columns
to keep, separated by commas. Alternatively, if you are selecting
columns adjacent to each other, you can use a <code>:</code> to select a
range of columns, read as “select columns from ___ to ___.” You may have
done something similar in the past using subsetting.
<code>select()</code> is essentially doing the same thing as subsetting,
using a package (<code>dplyr</code>) instead of R’s base functions.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># to select columns throughout the dataframe</span></span>
<span><span class="fu">select</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">village</span>, <span class="va">no_membrs</span>, <span class="va">months_lack_food</span><span class="op">)</span></span>
<span><span class="co"># to do the same thing with subsetting</span></span>
<span><span class="va">interviews</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="st">"village"</span>,<span class="st">"no_membrs"</span>,<span class="st">"months_lack_food"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># to select a series of connected columns</span></span>
<span><span class="fu">select</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">village</span><span class="op">:</span><span class="va">respondent_wall_type</span><span class="op">)</span></span></code></pre>
</div>
<p>To choose rows based on specific criteria, we can use the
<code>filter()</code> function. The argument after the dataframe is the
condition we want our final dataframe to adhere to (e.g. village name is
Chirodzo):</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filters observations where village name is "Chirodzo"</span></span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">village</span> <span class="op">==</span> <span class="st">"Chirodzo"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 39 × 14
   key_ID village  interview_date      no_membrs years_liv respondent_wall_type
    &lt;dbl&gt; &lt;chr&gt;    &lt;dttm&gt;                  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
 1      8 Chirodzo 2016-11-16 00:00:00        12        70 burntbricks
 2      9 Chirodzo 2016-11-16 00:00:00         8         6 burntbricks
 3     10 Chirodzo 2016-12-16 00:00:00        12        23 burntbricks
 4     34 Chirodzo 2016-11-17 00:00:00         8        18 burntbricks
 5     35 Chirodzo 2016-11-17 00:00:00         5        45 muddaub
 6     36 Chirodzo 2016-11-17 00:00:00         6        23 sunbricks
 7     37 Chirodzo 2016-11-17 00:00:00         3         8 burntbricks
 8     43 Chirodzo 2016-11-17 00:00:00         7        29 muddaub
 9     44 Chirodzo 2016-11-17 00:00:00         2         6 muddaub
10     45 Chirodzo 2016-11-17 00:00:00         9         7 muddaub
# ℹ 29 more rows
# ℹ 8 more variables: rooms &lt;dbl&gt;, memb_assoc &lt;chr&gt;, affect_conflicts &lt;chr&gt;,
#   liv_count &lt;dbl&gt;, items_owned &lt;chr&gt;, no_meals &lt;dbl&gt;, months_lack_food &lt;chr&gt;,
#   instanceID &lt;chr&gt;</code></pre>
</div>
<p>You may also have noticed that the output from these call doesn’t run
off the screen anymore. It’s one of the advantages of
<code>tbl_df</code> (also called tibble), the central data class in the
tidyverse, compared to normal dataframes in R.</p>
<p>We can also specify multiple conditions within the
<code>filter()</code> function. We can combine conditions using either
“and” or “or” statements. In an “and” statement, an observation (row)
must meet <strong>every</strong> criteria to be included in the
resulting dataframe. To form “and” statements within dplyr, we can pass
our desired conditions as arguments in the <code>filter()</code>
function, separated by commas:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filters observations with "and" operator (comma)</span></span>
<span><span class="co"># output dataframe satisfies ALL specified conditions</span></span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">village</span> <span class="op">==</span> <span class="st">"Chirodzo"</span>,</span>
<span>                   <span class="va">rooms</span> <span class="op">&gt;</span> <span class="fl">1</span>,</span>
<span>                   <span class="va">no_meals</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 10 × 14
   key_ID village  interview_date      no_membrs years_liv respondent_wall_type
    &lt;dbl&gt; &lt;chr&gt;    &lt;dttm&gt;                  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
 1     10 Chirodzo 2016-12-16 00:00:00        12        23 burntbricks
 2     49 Chirodzo 2016-11-16 00:00:00         6        26 burntbricks
 3     52 Chirodzo 2016-11-16 00:00:00        11        15 burntbricks
 4     56 Chirodzo 2016-11-16 00:00:00        12        23 burntbricks
 5     65 Chirodzo 2016-11-16 00:00:00         8        20 burntbricks
 6     66 Chirodzo 2016-11-16 00:00:00        10        37 burntbricks
 7     67 Chirodzo 2016-11-16 00:00:00         5        31 burntbricks
 8     68 Chirodzo 2016-11-16 00:00:00         8        52 burntbricks
 9    199 Chirodzo 2017-06-04 00:00:00         7        17 burntbricks
10    200 Chirodzo 2017-06-04 00:00:00         8        20 burntbricks
# ℹ 8 more variables: rooms &lt;dbl&gt;, memb_assoc &lt;chr&gt;, affect_conflicts &lt;chr&gt;,
#   liv_count &lt;dbl&gt;, items_owned &lt;chr&gt;, no_meals &lt;dbl&gt;, months_lack_food &lt;chr&gt;,
#   instanceID &lt;chr&gt;</code></pre>
</div>
<p>We can also form “and” statements with the <code>&amp;</code>
operator instead of commas:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filters observations with "&amp;" logical operator</span></span>
<span><span class="co"># output dataframe satisfies ALL specified conditions</span></span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">village</span> <span class="op">==</span> <span class="st">"Chirodzo"</span> <span class="op">&amp;</span></span>
<span>                   <span class="va">rooms</span> <span class="op">&gt;</span> <span class="fl">1</span> <span class="op">&amp;</span></span>
<span>                   <span class="va">no_meals</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 10 × 14
   key_ID village  interview_date      no_membrs years_liv respondent_wall_type
    &lt;dbl&gt; &lt;chr&gt;    &lt;dttm&gt;                  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
 1     10 Chirodzo 2016-12-16 00:00:00        12        23 burntbricks
 2     49 Chirodzo 2016-11-16 00:00:00         6        26 burntbricks
 3     52 Chirodzo 2016-11-16 00:00:00        11        15 burntbricks
 4     56 Chirodzo 2016-11-16 00:00:00        12        23 burntbricks
 5     65 Chirodzo 2016-11-16 00:00:00         8        20 burntbricks
 6     66 Chirodzo 2016-11-16 00:00:00        10        37 burntbricks
 7     67 Chirodzo 2016-11-16 00:00:00         5        31 burntbricks
 8     68 Chirodzo 2016-11-16 00:00:00         8        52 burntbricks
 9    199 Chirodzo 2017-06-04 00:00:00         7        17 burntbricks
10    200 Chirodzo 2017-06-04 00:00:00         8        20 burntbricks
# ℹ 8 more variables: rooms &lt;dbl&gt;, memb_assoc &lt;chr&gt;, affect_conflicts &lt;chr&gt;,
#   liv_count &lt;dbl&gt;, items_owned &lt;chr&gt;, no_meals &lt;dbl&gt;, months_lack_food &lt;chr&gt;,
#   instanceID &lt;chr&gt;</code></pre>
</div>
<p>In an “or” statement, observations must meet <em>at least one</em> of
the specified conditions. To form “or” statements we use the logical
operator for “or,” which is the vertical bar (|):</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filters observations with "|" logical operator</span></span>
<span><span class="co"># output dataframe satisfies AT LEAST ONE of the specified conditions</span></span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">village</span> <span class="op">==</span> <span class="st">"Chirodzo"</span> <span class="op">|</span> <span class="va">village</span> <span class="op">==</span> <span class="st">"Ruaca"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 88 × 14
   key_ID village  interview_date      no_membrs years_liv respondent_wall_type
    &lt;dbl&gt; &lt;chr&gt;    &lt;dttm&gt;                  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
 1      8 Chirodzo 2016-11-16 00:00:00        12        70 burntbricks
 2      9 Chirodzo 2016-11-16 00:00:00         8         6 burntbricks
 3     10 Chirodzo 2016-12-16 00:00:00        12        23 burntbricks
 4     23 Ruaca    2016-11-21 00:00:00        10        20 burntbricks
 5     24 Ruaca    2016-11-21 00:00:00         6         4 burntbricks
 6     25 Ruaca    2016-11-21 00:00:00        11         6 burntbricks
 7     26 Ruaca    2016-11-21 00:00:00         3        20 burntbricks
 8     27 Ruaca    2016-11-21 00:00:00         7        36 burntbricks
 9     28 Ruaca    2016-11-21 00:00:00         2         2 muddaub
10     29 Ruaca    2016-11-21 00:00:00         7        10 burntbricks
# ℹ 78 more rows
# ℹ 8 more variables: rooms &lt;dbl&gt;, memb_assoc &lt;chr&gt;, affect_conflicts &lt;chr&gt;,
#   liv_count &lt;dbl&gt;, items_owned &lt;chr&gt;, no_meals &lt;dbl&gt;, months_lack_food &lt;chr&gt;,
#   instanceID &lt;chr&gt;</code></pre>
</div>
</section><section><h2 class="section-heading" id="pipes">Pipes<a class="anchor" aria-label="anchor" href="#pipes"></a>
</h2>
<hr class="half-width">
<p>What if you want to select and filter at the same time? There are
three ways to do this: use intermediate steps, nested functions, or
pipes.</p>
<p>With intermediate steps, you create a temporary dataframe and use
that as input to the next function, like this:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews2</span> <span class="op">&lt;-</span> <span class="fu">filter</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">village</span> <span class="op">==</span> <span class="st">"Chirodzo"</span><span class="op">)</span></span>
<span><span class="va">interviews_ch</span> <span class="op">&lt;-</span> <span class="fu">select</span><span class="op">(</span><span class="va">interviews2</span>, <span class="va">village</span><span class="op">:</span><span class="va">respondent_wall_type</span><span class="op">)</span></span></code></pre>
</div>
<p>This is readable, but can clutter up your workspace with lots of
objects that you have to name individually. With multiple steps, that
can be hard to keep track of.</p>
<p>You can also nest functions (i.e. one function inside of another),
like this:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_ch</span> <span class="op">&lt;-</span> <span class="fu">select</span><span class="op">(</span><span class="fu">filter</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">village</span> <span class="op">==</span> <span class="st">"Chirodzo"</span><span class="op">)</span>,</span>
<span>                         <span class="va">village</span><span class="op">:</span><span class="va">respondent_wall_type</span><span class="op">)</span></span></code></pre>
</div>
<p>This is handy, but can be difficult to read if too many functions are
nested, as R evaluates the expression from the inside out (in this case,
filtering, then selecting).</p>
<p>The last option, <em>pipes</em>, are a recent addition to R. Pipes
let you take the output of one function and send it directly to the
next, which is useful when you need to do many things to the same
dataset. There are two Pipes in R: 1) <code>%&gt;%</code> (called
magrittr pipe; made available via the
<strong><code>magrittr</code></strong> package, installed automatically
with <strong><code>dplyr</code></strong>) or 2) <code>|&gt;</code>
(called native R pipe and it comes preinstalled with R v4.1.0 onwards).
Both the pipes are, by and large, function similarly with a few
differences (For more information, check: <a href="https://www.tidyverse.org/blog/2023/04/base-vs-magrittr-pipe/" class="external-link uri">https://www.tidyverse.org/blog/2023/04/base-vs-magrittr-pipe/</a>).
The choice of which pipe to be used can be changed in the Global
settings in R studio and once that is done, you can type the pipe
with:</p>
<ul>
<li>
<kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>M</kbd> if you have a PC
or <kbd>Cmd</kbd> + <kbd>Shift</kbd> + <kbd>M</kbd> if you have a
Mac.</li>
</ul>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the following example is run using magrittr pipe but the output will be same with the native pipe</span></span>
<span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="va">village</span> <span class="op">==</span> <span class="st">"Chirodzo"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">village</span><span class="op">:</span><span class="va">respondent_wall_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 39 × 5
   village  interview_date      no_membrs years_liv respondent_wall_type
   &lt;chr&gt;    &lt;dttm&gt;                  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
 1 Chirodzo 2016-11-16 00:00:00        12        70 burntbricks
 2 Chirodzo 2016-11-16 00:00:00         8         6 burntbricks
 3 Chirodzo 2016-12-16 00:00:00        12        23 burntbricks
 4 Chirodzo 2016-11-17 00:00:00         8        18 burntbricks
 5 Chirodzo 2016-11-17 00:00:00         5        45 muddaub
 6 Chirodzo 2016-11-17 00:00:00         6        23 sunbricks
 7 Chirodzo 2016-11-17 00:00:00         3         8 burntbricks
 8 Chirodzo 2016-11-17 00:00:00         7        29 muddaub
 9 Chirodzo 2016-11-17 00:00:00         2         6 muddaub
10 Chirodzo 2016-11-17 00:00:00         9         7 muddaub
# ℹ 29 more rows</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#interviews |&gt;</span></span>
<span><span class="co">#   filter(village == "Chirodzo") |&gt;</span></span>
<span><span class="co">#   select(village:respondent_wall_type)</span></span></code></pre>
</div>
<p>In the above code, we use the pipe to send the
<code>interviews</code> dataset first through <code>filter()</code> to
keep rows where <code>village</code> is “Chirodzo”, then through
<code>select()</code> to keep only the columns from <code>village</code>
to <code>respondent_wall_type</code>. Since <code>%&gt;%</code> takes
the object on its left and passes it as the first argument to the
function on its right, we don’t need to explicitly include the dataframe
as an argument to the <code>filter()</code> and <code>select()</code>
functions any more.</p>
<p>Some may find it helpful to read the pipe like the word “then”. For
instance, in the above example, we take the dataframe
<code>interviews</code>, <em>then</em> we <code>filter</code> for rows
with <code>village == "Chirodzo"</code>, <em>then</em> we
<code>select</code> columns <code>village:respondent_wall_type</code>.
The <strong><code>dplyr</code></strong> functions by themselves are
somewhat simple, but by combining them into linear workflows with the
pipe, we can accomplish more complex data wrangling operations.</p>
<p>If we want to create a new object with this smaller version of the
data, we can assign it a new name:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_ch</span> <span class="op">&lt;-</span> <span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="va">village</span> <span class="op">==</span> <span class="st">"Chirodzo"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">village</span><span class="op">:</span><span class="va">respondent_wall_type</span><span class="op">)</span></span>
<span></span>
<span><span class="va">interviews_ch</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 39 × 5
   village  interview_date      no_membrs years_liv respondent_wall_type
   &lt;chr&gt;    &lt;dttm&gt;                  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
 1 Chirodzo 2016-11-16 00:00:00        12        70 burntbricks
 2 Chirodzo 2016-11-16 00:00:00         8         6 burntbricks
 3 Chirodzo 2016-12-16 00:00:00        12        23 burntbricks
 4 Chirodzo 2016-11-17 00:00:00         8        18 burntbricks
 5 Chirodzo 2016-11-17 00:00:00         5        45 muddaub
 6 Chirodzo 2016-11-17 00:00:00         6        23 sunbricks
 7 Chirodzo 2016-11-17 00:00:00         3         8 burntbricks
 8 Chirodzo 2016-11-17 00:00:00         7        29 muddaub
 9 Chirodzo 2016-11-17 00:00:00         2         6 muddaub
10 Chirodzo 2016-11-17 00:00:00         9         7 muddaub
# ℹ 29 more rows</code></pre>
</div>
<p>Note that the final dataframe (<code>interviews_ch</code>) is the
leftmost part of this expression.</p>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>Using pipes, subset the <code>interviews</code> data to include
interviews where respondents were members of an irrigation association
(<code>memb_assoc</code>) and retain only the columns
<code>affect_conflicts</code>, <code>liv_count</code>, and
<code>no_meals</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="va">memb_assoc</span> <span class="op">==</span> <span class="st">"yes"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">affect_conflicts</span>, <span class="va">liv_count</span>, <span class="va">no_meals</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 33 × 3
   affect_conflicts liv_count no_meals
   &lt;chr&gt;                &lt;dbl&gt;    &lt;dbl&gt;
 1 once                     3        2
 2 never                    2        2
 3 never                    2        3
 4 once                     3        2
 5 frequently               1        3
 6 more_once                5        2
 7 more_once                3        2
 8 more_once                2        3
 9 once                     3        3
10 never                    3        3
# ℹ 23 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="mutate">Mutate<a class="anchor" aria-label="anchor" href="#mutate"></a>
</h2>
<hr class="half-width">
<p>Frequently you’ll want to create new columns based on the values in
existing columns, for example to do unit conversions, or to find the
ratio of values in two columns. For this we’ll use
<code>mutate()</code>.</p>
<p>We might be interested in the ratio of number of household members to
rooms used for sleeping (i.e. avg number of people per room):</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>people_per_room <span class="op">=</span> <span class="va">no_membrs</span> <span class="op">/</span> <span class="va">rooms</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 131 × 15
   key_ID village  interview_date      no_membrs years_liv respondent_wall_type
    &lt;dbl&gt; &lt;chr&gt;    &lt;dttm&gt;                  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
 1      1 God      2016-11-17 00:00:00         3         4 muddaub
 2      2 God      2016-11-17 00:00:00         7         9 muddaub
 3      3 God      2016-11-17 00:00:00        10        15 burntbricks
 4      4 God      2016-11-17 00:00:00         7         6 burntbricks
 5      5 God      2016-11-17 00:00:00         7        40 burntbricks
 6      6 God      2016-11-17 00:00:00         3         3 muddaub
 7      7 God      2016-11-17 00:00:00         6        38 muddaub
 8      8 Chirodzo 2016-11-16 00:00:00        12        70 burntbricks
 9      9 Chirodzo 2016-11-16 00:00:00         8         6 burntbricks
10     10 Chirodzo 2016-12-16 00:00:00        12        23 burntbricks
# ℹ 121 more rows
# ℹ 9 more variables: rooms &lt;dbl&gt;, memb_assoc &lt;chr&gt;, affect_conflicts &lt;chr&gt;,
#   liv_count &lt;dbl&gt;, items_owned &lt;chr&gt;, no_meals &lt;dbl&gt;, months_lack_food &lt;chr&gt;,
#   instanceID &lt;chr&gt;, people_per_room &lt;dbl&gt;</code></pre>
</div>
<p>We may be interested in investigating whether being a member of an
irrigation association had any effect on the ratio of household members
to rooms. To look at this relationship, we will first remove data from
our dataset where the respondent didn’t answer the question of whether
they were a member of an irrigation association. These cases are
recorded as “NULL” in the dataset.</p>
<p>To remove these cases, we could insert a <code>filter()</code> in the
chain:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">memb_assoc</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>people_per_room <span class="op">=</span> <span class="va">no_membrs</span> <span class="op">/</span> <span class="va">rooms</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 92 × 15
   key_ID village  interview_date      no_membrs years_liv respondent_wall_type
    &lt;dbl&gt; &lt;chr&gt;    &lt;dttm&gt;                  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
 1      2 God      2016-11-17 00:00:00         7         9 muddaub
 2      7 God      2016-11-17 00:00:00         6        38 muddaub
 3      8 Chirodzo 2016-11-16 00:00:00        12        70 burntbricks
 4      9 Chirodzo 2016-11-16 00:00:00         8         6 burntbricks
 5     10 Chirodzo 2016-12-16 00:00:00        12        23 burntbricks
 6     12 God      2016-11-21 00:00:00         7        20 burntbricks
 7     13 God      2016-11-21 00:00:00         6         8 burntbricks
 8     15 God      2016-11-21 00:00:00         5        30 sunbricks
 9     21 God      2016-11-21 00:00:00         8        20 burntbricks
10     24 Ruaca    2016-11-21 00:00:00         6         4 burntbricks
# ℹ 82 more rows
# ℹ 9 more variables: rooms &lt;dbl&gt;, memb_assoc &lt;chr&gt;, affect_conflicts &lt;chr&gt;,
#   liv_count &lt;dbl&gt;, items_owned &lt;chr&gt;, no_meals &lt;dbl&gt;, months_lack_food &lt;chr&gt;,
#   instanceID &lt;chr&gt;, people_per_room &lt;dbl&gt;</code></pre>
</div>
<p>The <code>!</code> symbol negates the result of the
<code>is.na()</code> function. Thus, if <code>is.na()</code> returns a
value of <code>TRUE</code> (because the <code>memb_assoc</code> is
missing), the <code>!</code> symbol negates this and says we only want
values of <code>FALSE</code>, where <code>memb_assoc</code> <strong>is
not</strong> missing.</p>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>Create a new dataframe from the <code>interviews</code> data that
meets the following criteria: contains only the <code>village</code>
column and a new column called <code>total_meals</code> containing a
value that is equal to the total number of meals served in the household
per day on average (<code>no_membrs</code> times <code>no_meals</code>).
Only the rows where <code>total_meals</code> is greater than 20 should
be shown in the final dataframe.</p>
<p><strong>Hint</strong>: think about how the commands should be ordered
to produce this data frame!</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_total_meals</span> <span class="op">&lt;-</span> <span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>total_meals <span class="op">=</span> <span class="va">no_membrs</span> <span class="op">*</span> <span class="va">no_meals</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="va">total_meals</span> <span class="op">&gt;</span> <span class="fl">20</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">village</span>, <span class="va">total_meals</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="split-apply-combine-data-analysis-and-the-summarize-function">Split-apply-combine data analysis and the summarize() function<a class="anchor" aria-label="anchor" href="#split-apply-combine-data-analysis-and-the-summarize-function"></a>
</h2>
<hr class="half-width">
<p>Many data analysis tasks can be approached using the
<em>split-apply-combine</em> paradigm: split the data into groups, apply
some analysis to each group, and then combine the results.
<strong><code>dplyr</code></strong> makes this very easy through the use
of the <code>group_by()</code> function.</p>
<div class="section level3">
<h3 id="the-summarize-function">The <code>summarize()</code> function<a class="anchor" aria-label="anchor" href="#the-summarize-function"></a>
</h3>
<p><code>group_by()</code> is often used together with
<code>summarize()</code>, which collapses each group into a single-row
summary of that group. <code>group_by()</code> takes as arguments the
column names that contain the <strong>categorical</strong> variables for
which you want to calculate the summary statistics. So to compute the
average household size by village:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span>mean_no_membrs <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 2
  village  mean_no_membrs
  &lt;chr&gt;             &lt;dbl&gt;
1 Chirodzo           7.08
2 God                6.86
3 Ruaca              7.57</code></pre>
</div>
<p>You can also group by multiple columns:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span>, <span class="va">memb_assoc</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span>mean_no_membrs <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'village'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 9 × 3
# Groups:   village [3]
  village  memb_assoc mean_no_membrs
  &lt;chr&gt;    &lt;chr&gt;               &lt;dbl&gt;
1 Chirodzo no                   8.06
2 Chirodzo yes                  7.82
3 Chirodzo &lt;NA&gt;                 5.08
4 God      no                   7.13
5 God      yes                  8
6 God      &lt;NA&gt;                 6
7 Ruaca    no                   7.18
8 Ruaca    yes                  9.5
9 Ruaca    &lt;NA&gt;                 6.22</code></pre>
</div>
<p>Note that the output is a grouped tibble of nine rows by three
columns which is indicated by the by two first lines with the
<code>#</code>. To obtain an ungrouped tibble, use the
<code>ungroup</code> function:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span>, <span class="va">memb_assoc</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span>mean_no_membrs <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'village'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 9 × 3
  village  memb_assoc mean_no_membrs
  &lt;chr&gt;    &lt;chr&gt;               &lt;dbl&gt;
1 Chirodzo no                   8.06
2 Chirodzo yes                  7.82
3 Chirodzo &lt;NA&gt;                 5.08
4 God      no                   7.13
5 God      yes                  8
6 God      &lt;NA&gt;                 6
7 Ruaca    no                   7.18
8 Ruaca    yes                  9.5
9 Ruaca    &lt;NA&gt;                 6.22</code></pre>
</div>
<p>Notice that the second line with the <code>#</code> that previously
indicated the grouping has disappeared and we now only have a 9x3-tibble
without grouping. When grouping both by <code>village</code> and
<code>membr_assoc</code>, we see rows in our table for respondents who
did not specify whether they were a member of an irrigation association.
We can exclude those data from our table using a filter step.</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">memb_assoc</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span>, <span class="va">memb_assoc</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span>mean_no_membrs <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'village'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 3
# Groups:   village [3]
  village  memb_assoc mean_no_membrs
  &lt;chr&gt;    &lt;chr&gt;               &lt;dbl&gt;
1 Chirodzo no                   8.06
2 Chirodzo yes                  7.82
3 God      no                   7.13
4 God      yes                  8
5 Ruaca    no                   7.18
6 Ruaca    yes                  9.5 </code></pre>
</div>
<p>Once the data are grouped, you can also summarize multiple variables
at the same time (and not necessarily on the same variable). For
instance, we could add a column indicating the minimum household size
for each village for each group (members of an irrigation association vs
not):</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">memb_assoc</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span>, <span class="va">memb_assoc</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span>mean_no_membrs <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span>,</span>
<span>              min_membrs <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'village'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 4
# Groups:   village [3]
  village  memb_assoc mean_no_membrs min_membrs
  &lt;chr&gt;    &lt;chr&gt;               &lt;dbl&gt;      &lt;dbl&gt;
1 Chirodzo no                   8.06          4
2 Chirodzo yes                  7.82          2
3 God      no                   7.13          3
4 God      yes                  8             5
5 Ruaca    no                   7.18          2
6 Ruaca    yes                  9.5           5</code></pre>
</div>
<p>It is sometimes useful to rearrange the result of a query to inspect
the values. For instance, we can sort on <code>min_membrs</code> to put
the group with the smallest household first:</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">memb_assoc</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span>, <span class="va">memb_assoc</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span>mean_no_membrs <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span>,</span>
<span>              min_membrs <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">arrange</span><span class="op">(</span><span class="va">min_membrs</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'village'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 4
# Groups:   village [3]
  village  memb_assoc mean_no_membrs min_membrs
  &lt;chr&gt;    &lt;chr&gt;               &lt;dbl&gt;      &lt;dbl&gt;
1 Chirodzo yes                  7.82          2
2 Ruaca    no                   7.18          2
3 God      no                   7.13          3
4 Chirodzo no                   8.06          4
5 God      yes                  8             5
6 Ruaca    yes                  9.5           5</code></pre>
</div>
<p>To sort in descending order, we need to add the <code>desc()</code>
function. If we want to sort the results by decreasing order of minimum
household size:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">memb_assoc</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span>, <span class="va">memb_assoc</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span>mean_no_membrs <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span>,</span>
<span>              min_membrs <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">min_membrs</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'village'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 4
# Groups:   village [3]
  village  memb_assoc mean_no_membrs min_membrs
  &lt;chr&gt;    &lt;chr&gt;               &lt;dbl&gt;      &lt;dbl&gt;
1 God      yes                  8             5
2 Ruaca    yes                  9.5           5
3 Chirodzo no                   8.06          4
4 God      no                   7.13          3
5 Chirodzo yes                  7.82          2
6 Ruaca    no                   7.18          2</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="counting">Counting<a class="anchor" aria-label="anchor" href="#counting"></a>
</h3>
<p>When working with data, we often want to know the number of
observations found for each factor or combination of factors. For this
task, <strong><code>dplyr</code></strong> provides <code>count()</code>.
For example, if we wanted to count the number of rows of data for each
village, we would do:</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">count</span><span class="op">(</span><span class="va">village</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 2
  village      n
  &lt;chr&gt;    &lt;int&gt;
1 Chirodzo    39
2 God         43
3 Ruaca       49</code></pre>
</div>
<p>For convenience, <code>count()</code> provides the <code>sort</code>
argument to get results in decreasing order:</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">count</span><span class="op">(</span><span class="va">village</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 2
  village      n
  &lt;chr&gt;    &lt;int&gt;
1 Ruaca       49
2 God         43
3 Chirodzo    39</code></pre>
</div>
<div id="exercise-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>How many households in the survey have an average of two meals per
day? Three meals per day? Are there any other numbers of meals
represented?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu">count</span><span class="op">(</span><span class="va">no_meals</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 2
  no_meals     n
     &lt;dbl&gt; &lt;int&gt;
1        2    52
2        3    79</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="exercise-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise<em> (continued)</em>
</h3>
<div class="callout-content">
<p>Use <code>group_by()</code> and <code>summarize()</code> to find the
mean, min, and max number of household members for each village. Also
add the number of observations (hint: see <code>?n</code>).</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>      mean_no_membrs <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span>,</span>
<span>      min_no_membrs <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span>,</span>
<span>      max_no_membrs <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span>,</span>
<span>      n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 5
  village  mean_no_membrs min_no_membrs max_no_membrs     n
  &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt; &lt;int&gt;
1 Chirodzo           7.08             2            12    39
2 God                6.86             3            15    43
3 Ruaca              7.57             2            19    49</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="exercise-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise<em> (continued)</em>
</h3>
<div class="callout-content">
<p>What was the largest household interviewed in each month?</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if not already included, add month, year, and day columns</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">lubridate</span><span class="op">)</span> <span class="co"># load lubridate if not already loaded</span></span>
<span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>month <span class="op">=</span> <span class="fu">month</span><span class="op">(</span><span class="va">interview_date</span><span class="op">)</span>,</span>
<span>           day <span class="op">=</span> <span class="fu">day</span><span class="op">(</span><span class="va">interview_date</span><span class="op">)</span>,</span>
<span>           year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">interview_date</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span>max_no_membrs <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 5 × 3
# Groups:   year [2]
   year month max_no_membrs
  &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
1  2016    11            19
2  2016    12            12
3  2017     4            17
4  2017     5            15
5  2017     6            15</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use the <code>dplyr</code> package to manipulate dataframes.</li>
<li>Use <code>select()</code> to choose variables from a dataframe.</li>
<li>Use <code>filter()</code> to choose data based on values.</li>
<li>Use <code>group_by()</code> and <code>summarize()</code> to work
with subsets of data.</li>
<li>Use <code>mutate()</code> to create new variables.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-04-tidyr"><p>Content from <a href="04-tidyr.html">Data Wrangling with tidyr</a></p>
<hr>
<p>Last updated on 2025-07-01 |

        <a href="https://github.com/datacarpentry/r-socialsci/edit/main/episodes/04-tidyr.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I reformat a data frame to meet my needs?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe the concept of a wide and a long table format and for which
purpose those formats are useful.</li>
<li>Describe the roles of variable names and their associated values
when a table is reshaped.</li>
<li>Reshape a dataframe from long to wide format and back with the
<code>pivot_wider</code> and <code>pivot_longer</code> commands from the
<strong><code>tidyr</code></strong> package.</li>
<li>Export a dataframe to a csv file.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p><strong><code>dplyr</code></strong> pairs nicely with
<strong><code>tidyr</code></strong> which enables you to swiftly convert
between different data formats (long vs. wide) for plotting and
analysis. To learn more about <strong><code>tidyr</code></strong> after
the workshop, you may want to check out this <a href="https://github.com/rstudio/cheatsheets/blob/main/tidyr.pdf" class="external-link">handy
data tidying with <strong><code>tidyr</code></strong>
cheatsheet</a>.</p>
<p>To make sure everyone will use the same dataset for this lesson,
we’ll read again the SAFI dataset that we downloaded earlier.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## load the tidyverse</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">here</span><span class="op">)</span></span>
<span></span>
<span><span class="va">interviews</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"SAFI_clean.csv"</span><span class="op">)</span>, na <span class="op">=</span> <span class="st">"NULL"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## inspect the data</span></span>
<span><span class="va">interviews</span></span>
<span></span>
<span><span class="co">## preview the data</span></span>
<span><span class="co"># view(interviews)</span></span></code></pre>
</div>
<section><h2 class="section-heading" id="reshaping-with-pivot_wider-and-pivot_longer">Reshaping with pivot_wider() and pivot_longer()<a class="anchor" aria-label="anchor" href="#reshaping-with-pivot_wider-and-pivot_longer"></a>
</h2>
<hr class="half-width">
<p>There are essentially three rules that define a “tidy” dataset:</p>
<ol style="list-style-type: decimal">
<li>Each variable has its own column</li>
<li>Each observation has its own row</li>
<li>Each value must have its own cell</li>
</ol>
<p>This graphic visually represents the three rules that define a “tidy”
dataset:</p>
<p><img src="../fig/tidy-data-wickham.png" class="figure"><em>R for Data Science</em>,
Wickham H and Grolemund G (<a href="https://r4ds.had.co.nz/index.html" class="external-link">https://r4ds.had.co.nz/index.html</a>)
© Wickham, Grolemund 2017 This image is licenced under
Attribution-NonCommercial-NoDerivs 3.0 United States (CC-BY-NC-ND 3.0
US)</p>
<p>In this section we will explore how these rules are linked to the
different data formats researchers are often interested in: “wide” and
“long”. This tutorial will help you efficiently transform your data
shape regardless of original format. First we will explore qualities of
the <code>interviews</code> data and how they relate to these different
types of data formats.</p>
<div class="section level3">
<h3 id="long-and-wide-data-formats">Long and wide data formats<a class="anchor" aria-label="anchor" href="#long-and-wide-data-formats"></a>
</h3>
<p>In the <code>interviews</code> data, each row contains the values of
variables associated with each record collected (each interview in the
villages). It is stated that the <code>key_ID</code> was “added to
provide a unique Id for each observation” and the
<code>instanceID</code> “does this as well but it is not as convenient
to use.”</p>
<p>Once we have established that <code>key_ID</code> and
<code>instanceID</code> are both unique we can use either variable as an
identifier corresponding to the 131 interview records.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">key_ID</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">nrow</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 131</code></pre>
</div>
<p>As seen in the code below, for each interview date in each village no
<code>instanceID</code>s are the same. Thus, this format is what is
called a “long” data format, where each observation occupies only one
row in the dataframe.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">village</span> <span class="op">==</span> <span class="st">"Chirodzo"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">key_ID</span>, <span class="va">village</span>, <span class="va">interview_date</span>, <span class="va">instanceID</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">sample_n</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 10 × 4
   key_ID village  interview_date      instanceID
    &lt;dbl&gt; &lt;chr&gt;    &lt;dttm&gt;              &lt;chr&gt;
 1     54 Chirodzo 2016-11-16 00:00:00 uuid:273ab27f-9be3-4f3b-83c9-d3e1592de919
 2     47 Chirodzo 2016-11-17 00:00:00 uuid:2d0b1936-4f82-4ec3-a3b5-7c3c8cd6cc2b
 3     35 Chirodzo 2016-11-17 00:00:00 uuid:ff7496e7-984a-47d3-a8a1-13618b5683ce
 4     53 Chirodzo 2016-11-16 00:00:00 uuid:cc7f75c5-d13e-43f3-97e5-4f4c03cb4b12
 5     62 Chirodzo 2016-11-16 00:00:00 uuid:c6597ecc-cc2a-4c35-a6dc-e62c71b345d6
 6     46 Chirodzo 2016-11-17 00:00:00 uuid:35f297e0-aa5d-4149-9b7b-4965004cfc37
 7     44 Chirodzo 2016-11-17 00:00:00 uuid:f9fadf44-d040-4fca-86c1-2835f79c4952
 8     68 Chirodzo 2016-11-16 00:00:00 uuid:ef04b3eb-b47d-412e-9b09-4f5e08fc66f9
 9     55 Chirodzo 2016-11-16 00:00:00 uuid:883c0433-9891-4121-bc63-744f082c1fa0
10     51 Chirodzo 2016-11-16 00:00:00 uuid:18ac8e77-bdaf-47ab-85a2-e4c947c9d3ce</code></pre>
</div>
<p>We notice that the layout or format of the <code>interviews</code>
data is in a format that adheres to rules 1-3, where</p>
<ul>
<li>each column is a variable</li>
<li>each row is an observation</li>
<li>each value has its own cell</li>
</ul>
<p>This is called a “long” data format. But, we notice that each column
represents a different variable. In the “longest” data format there
would only be three columns, one for the id variable, one for the
observed variable, and one for the observed value (of that variable).
This data format is quite unsightly and difficult to work with, so you
will rarely see it in use.</p>
<p>Alternatively, in a “wide” data format we see modifications to rule
1, where each column no longer represents a single variable. Instead,
columns can represent different levels/values of a variable. For
instance, in some data you encounter the researchers may have chosen for
every survey date to be a different column.</p>
<p>These may sound like dramatically different data layouts, but there
are some tools that make transitions between these layouts much simpler
than you might think! The gif below shows how these two formats relate
to each other, and gives you an idea of how we can use R to shift from
one format to the other.</p>
<p><img src="../fig/tidyr-pivot_wider_longer.gif" class="figure"> Long and wide
dataframe layouts mainly affect readability. You may find that visually
you may prefer the “wide” format, since you can see more of the data on
the screen. However, all of the R functions we have used thus far expect
for your data to be in a “long” data format. This is because the long
format is more machine readable and is closer to the formatting of
databases.</p>
</div>
<div class="section level3">
<h3 id="questions-which-warrant-different-data-formats">Questions which warrant different data formats<a class="anchor" aria-label="anchor" href="#questions-which-warrant-different-data-formats"></a>
</h3>
<p>In interviews, each row contains the values of variables associated
with each record (the unit), values such as the village of the
respondent, the number of household members, or the type of wall their
house had. This format allows for us to make comparisons across
individual surveys, but what if we wanted to look at differences in
households grouped by different types of items owned?</p>
<p>To facilitate this comparison we would need to create a new table
where each row (the unit) was comprised of values of variables
associated with items owned (i.e., <code>items_owned</code>). In
practical terms this means the values of the items in
<code>items_owned</code> (e.g. bicycle, radio, table, etc.) would become
the names of column variables and the cells would contain values of
<code>TRUE</code> or <code>FALSE</code>, for whether that household had
that item.</p>
<p>Once we we’ve created this new table, we can explore the relationship
within and between villages. The key point here is that we are still
following a tidy data structure, but we have <strong>reshaped</strong>
the data according to the observations of interest.</p>
<p>Alternatively, if the interview dates were spread across multiple
columns, and we were interested in visualizing, within each village, how
irrigation conflicts have changed over time. This would require for the
interview date to be included in a single column rather than spread
across multiple columns. Thus, we would need to transform the column
names into values of a variable.</p>
<p>We can do both of these transformations with two <code>tidyr</code>
functions, <code>pivot_wider()</code> and
<code>pivot_longer()</code>.</p>
</div>
</section><section><h2 class="section-heading" id="pivoting-wider">Pivoting wider<a class="anchor" aria-label="anchor" href="#pivoting-wider"></a>
</h2>
<hr class="half-width">
<p><code>pivot_wider()</code> takes three principal arguments:</p>
<ol style="list-style-type: decimal">
<li>the data</li>
<li>the <em>names_from</em> column variable whose values will become new
column names.</li>
<li>the <em>values_from</em> column variable whose values will fill the
new column variables.</li>
</ol>
<p>Further arguments include <code>values_fill</code> which, if set,
fills in missing values with the value provided.</p>
<p>Let’s use <code>pivot_wider()</code> to transform interviews to
create new columns for each item owned by a household. There are a
couple of new concepts in this transformation, so let’s walk through it
line by line. First we create a new object
(<code>interviews_items_owned</code>) based on the
<code>interviews</code> data frame.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>interviews_items_owned <span class="ot">&lt;-</span> interviews <span class="sc">%&gt;%</span></span></code></pre>
</div>
<p>Then we will actually need to make our data frame longer, because we
have multiple items in a single cell. We will use a new function,
<code>separate_longer_delim()</code>, from the
<strong><code>tidyr</code></strong> package to separate the values of
<code>items_owned</code> based on the presence of semi-colons
(<code>;</code>). The values of this variable were multiple items
separated by semi-colons, so this action creates a row for each item
listed in a household’s possession. Thus, we end up with a long format
version of the dataset, with multiple rows for each respondent. For
example, if a respondent has a television and a solar panel, that
respondent will now have two rows, one with “television” and the other
with “solar panel” in the <code>items_owned</code> column.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">separate_longer_delim</span>(items_owned, <span class="at">delim =</span> <span class="st">";"</span>) <span class="sc">%&gt;%</span></span></code></pre>
</div>
<p>After this transformation, you may notice that the
<code>items_owned</code> column contains <code>NA</code> values. This is
because some of the respondents did not own any of the items in the
interviewer’s list. We can use the <code>replace_na()</code> function to
change these <code>NA</code> values to something more meaningful. The
<code>replace_na()</code> function expects for you to give it a
<code>list()</code> of columns that you would like to replace the
<code>NA</code> values in, and the value that you would like to replace
the <code>NA</code>s. This ends up looking like this:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">items_owned =</span> <span class="st">"no_listed_items"</span>)) <span class="sc">%&gt;%</span></span></code></pre>
</div>
<p>Next, we create a new variable named
<code>items_owned_logical</code>, which has one value
(<code>TRUE</code>) for every row. This makes sense, since each item in
every row was owned by that household. We are constructing this variable
so that when we spread the <code>items_owned</code> across multiple
columns, we can fill the values of those columns with logical values
describing whether the household did (<code>TRUE</code>) or did not
(<code>FALSE</code>) own that particular item.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">items_owned_logical =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span></code></pre>
</div>
<figure><img src="../fig/separate_longer.png" alt="Two tables shown side-by-side. The first row of the left table is highlighted in blue, and the first four rows of the right table are also highlighted in blue to show how each of the values of 'items owned' are given their own row with the separate longer delim function. The 'items owned logical' column is highlighted in yellow on the right table to show how the mutate function adds a new column." class="figure mx-auto d-block"></figure><p>At this point, we can also count the number of items owned by each
household, which is equivalent to the number of rows per
<code>key_ID</code>. We can do this with a <code>group_by()</code> and
<code>mutate()</code> pipeline that works similar to
<code>group_by()</code> and <code>summarize()</code> discussed in the
previous episode but instead of creating a summary table, we will add
another column called <code>number_items</code>. We use the
<code>n()</code> function to count the number of rows within each group.
However, there is one difficulty we need to take into account, namely
those households that did not list any items. These households now have
<code>"no_listed_items"</code> under <code>items_owned</code>. We do not
want to count this as an item but instead show zero items. We can
accomplish this using <strong><code>dplyr</code>’s</strong>
<code>if_else()</code> function that evaluates a condition and returns
one value if true and another if false. Here, if the
<code>items_owned</code> column is <code>"no_listed_items"</code>, then
a 0 is returned, otherwise, the number of rows per group is returned
using <code>n()</code>.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">group_by</span>(key_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">number_items =</span> <span class="fu">if_else</span>(items_owned <span class="sc">==</span> <span class="st">"no_listed_items"</span>, <span class="dv">0</span>, <span class="fu">n</span>())) <span class="sc">%&gt;%</span> </span></code></pre>
</div>
<p>Lastly, we use <code>pivot_wider()</code> to switch from long format
to wide format. This creates a new column for each of the unique values
in the <code>items_owned</code> column, and fills those columns with the
values of <code>items_owned_logical</code>. We also declare that for
items that are missing, we want to fill those cells with the value of
<code>FALSE</code> instead of <code>NA</code>.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">items_owned</span>,</span>
<span>            values_from <span class="op">=</span> <span class="va">items_owned_logical</span>,</span>
<span>            values_fill <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>items_owned_logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/pivot_wider.png" alt="Two tables shown side-by-side. The 'items owned' column is highlighted in blue on the left table, and the column names are highlighted in blue on the right table to show how the values of the 'items owned' become the column names in the output of the pivot wider function. The 'items owned logical' column is highlighted in yellow on the left table, and the values of the bicycle, television, and solar panel columns are highlighted in yellow on the right table to show how the values of the 'items owned logical' column became the values of all three of the aforementioned columns." class="figure mx-auto d-block"></figure><p>Combining the above steps, the chunk looks like this. Note that two
new columns are created within the same <code>mutate()</code> call.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_items_owned</span> <span class="op">&lt;-</span> <span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">separate_longer_delim</span><span class="op">(</span><span class="va">items_owned</span>, delim <span class="op">=</span> <span class="st">";"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">replace_na</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>items_owned <span class="op">=</span> <span class="st">"no_listed_items"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">key_ID</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>items_owned_logical <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         number_items <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">items_owned</span> <span class="op">==</span> <span class="st">"no_listed_items"</span>, <span class="fl">0</span>, <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">items_owned</span>,</span>
<span>              values_from <span class="op">=</span> <span class="va">items_owned_logical</span>,</span>
<span>              values_fill <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>items_owned_logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>View the <code>interviews_items_owned</code> data frame. It should
have <code>r nrow(interviews)</code> rows (the same number of rows you
had originally), but extra columns for each item. How many columns were
added? Notice that there is no longer a column titled
<code>items_owned</code>. This is because there is a default parameter
in <code>pivot_wider()</code> that drops the original column. The values
that were in that column have now become columns named
<code>television</code>, <code>solar_panel</code>, <code>table</code>,
etc. You can use <code>dim(interviews)</code> and
<code>dim(interviews_wide)</code> to see how the number of columns has
changed between the two datasets.</p>
<p>This format of the data allows us to do interesting things, like make
a table showing the number of respondents in each village who owned a
particular item:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_items_owned</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">bicycle</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">bicycle</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 3
# Groups:   village [3]
  village  bicycle     n
  &lt;chr&gt;    &lt;lgl&gt;   &lt;int&gt;
1 Chirodzo TRUE       17
2 God      TRUE       23
3 Ruaca    TRUE       20</code></pre>
</div>
<p>Or below we calculate the average number of items from the list owned
by respondents in each village using the <code>number_items</code>
column we created to count the items listed by each household.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_items_owned</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span>mean_items <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">number_items</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 2
  village  mean_items
  &lt;chr&gt;         &lt;dbl&gt;
1 Chirodzo       4.54
2 God            3.98
3 Ruaca          5.57</code></pre>
</div>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>We created <code>interviews_items_owned</code> by reshaping the data:
first longer and then wider. Replicate this process with the
<code>months_lack_food</code> column in the <code>interviews</code>
dataframe. Create a new dataframe with columns for each of the months
filled with logical vectors (<code>TRUE</code> or <code>FALSE</code>)
and a summary column called <code>number_months_lack_food</code> that
calculates the number of months each household reported a lack of
food.</p>
<p>Note that if the household did not lack food in the previous 12
months, the value input was “none”.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">months_lack_food</span> <span class="op">&lt;-</span> <span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">separate_longer_delim</span><span class="op">(</span><span class="va">months_lack_food</span>, delim <span class="op">=</span> <span class="st">";"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">key_ID</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>months_lack_food_logical <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         number_months_lack_food <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">months_lack_food</span> <span class="op">==</span> <span class="st">"none"</span>, <span class="fl">0</span>, <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">months_lack_food</span>,</span>
<span>              values_from <span class="op">=</span> <span class="va">months_lack_food_logical</span>,</span>
<span>              values_fill <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>months_lack_food_logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="pivoting-longer">Pivoting longer<a class="anchor" aria-label="anchor" href="#pivoting-longer"></a>
</h2>
<hr class="half-width">
<p>The opposing situation could occur if we had been provided with data
in the form of <code>interviews_wide</code>, where the items owned are
column names, but we wish to treat them as values of an
<code>items_owned</code> variable instead.</p>
<p>In this situation we are gathering these columns turning them into a
pair of new variables. One variable includes the column names as values,
and the other variable contains the values in each cell previously
associated with the column names. We will do this in two steps to make
this process a bit clearer.</p>
<p><code>pivot_longer()</code> takes four principal arguments:</p>
<ol style="list-style-type: decimal">
<li>the data</li>
<li>
<em>cols</em> are the names of the columns we use to fill the a new
values variable (or to drop).</li>
<li>the <em>names_to</em> column variable we wish to create from the
<em>cols</em> provided.</li>
<li>the <em>values_to</em> column variable we wish to create and fill
with values associated with the <em>cols</em> provided.</li>
</ol>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_long</span> <span class="op">&lt;-</span> <span class="va">interviews_items_owned</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">bicycle</span><span class="op">:</span><span class="va">car</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"items_owned"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"items_owned_logical"</span><span class="op">)</span></span></code></pre>
</div>
<p>View both <code>interviews_long</code> and
<code>interviews_items_owned</code> and compare their structure.</p>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>We created some summary tables on <code>interviews_items_owned</code>
using <code>count</code> and <code>summarise</code>. We can create the
same tables on <code>interviews_long</code>, but this will require a
different process.</p>
<p>Make a table showing the number of respondents in each village who
owned a particular item, and include all items. The difference between
this format and the wide format is that you can now <code>count</code>
all the items using the <code>items_owned</code> variable.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_long</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">items_owned_logical</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">items_owned</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 47 × 3
# Groups:   village [3]
   village  items_owned         n
   &lt;chr&gt;    &lt;chr&gt;           &lt;int&gt;
 1 Chirodzo bicycle            17
 2 Chirodzo computer            2
 3 Chirodzo cow_cart            6
 4 Chirodzo cow_plough         20
 5 Chirodzo electricity         1
 6 Chirodzo fridge              1
 7 Chirodzo lorry               1
 8 Chirodzo mobile_phone       25
 9 Chirodzo motorcyle          13
10 Chirodzo no_listed_items     3
# ℹ 37 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="applying-what-we-learned-to-clean-our-data">Applying what we learned to clean our data<a class="anchor" aria-label="anchor" href="#applying-what-we-learned-to-clean-our-data"></a>
</h2>
<hr class="half-width">
<p>Now we have simultaneously learned about <code>pivot_longer()</code>
and <code>pivot_wider()</code>, and fixed a problem in the way our data
is structured. In this dataset, we have another column that stores
multiple values in a single cell. Some of the cells in the
<code>months_lack_food</code> column contain multiple months which, as
before, are separated by semi-colons (<code>;</code>).</p>
<p>To create a data frame where each of the columns contain only one
value per cell, we can repeat the steps we applied to
<code>items_owned</code> and apply them to
<code>months_lack_food</code>. Since we will be using this data frame
for the next episode, we will call it
<code>interviews_plotting</code>.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plotting data ##</span></span>
<span><span class="va">interviews_plotting</span> <span class="op">&lt;-</span> <span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co">## pivot wider by items_owned</span></span>
<span>  <span class="fu">separate_longer_delim</span><span class="op">(</span><span class="va">items_owned</span>, delim <span class="op">=</span> <span class="st">";"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">replace_na</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>items_owned <span class="op">=</span> <span class="st">"no_listed_items"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co">## Use of grouped mutate to find number of rows</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">key_ID</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>items_owned_logical <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         number_items <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">items_owned</span> <span class="op">==</span> <span class="st">"no_listed_items"</span>, <span class="fl">0</span>, <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">items_owned</span>,</span>
<span>              values_from <span class="op">=</span> <span class="va">items_owned_logical</span>,</span>
<span>              values_fill <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>items_owned_logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">## pivot wider by months_lack_food</span></span>
<span>  <span class="fu">separate_longer_delim</span><span class="op">(</span><span class="va">months_lack_food</span>, delim <span class="op">=</span> <span class="st">";"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>months_lack_food_logical <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         number_months_lack_food <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">months_lack_food</span> <span class="op">==</span> <span class="st">"none"</span>, <span class="fl">0</span>, <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">months_lack_food</span>,</span>
<span>              values_from <span class="op">=</span> <span class="va">months_lack_food_logical</span>,</span>
<span>              values_fill <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>months_lack_food_logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="exporting-data">Exporting data<a class="anchor" aria-label="anchor" href="#exporting-data"></a>
</h2>
<hr class="half-width">
<p>Now that you have learned how to use
<strong><code>dplyr</code></strong> and
<strong><code>tidyr</code></strong> to wrangle your raw data, you may
want to export these new datasets to share them with your collaborators
or for archival purposes.</p>
<p>Similar to the <code>read_csv()</code> function used for reading CSV
files into R, there is a <code>write_csv()</code> function that
generates CSV files from data frames.</p>
<p>Before using <code>write_csv()</code>, we are going to create a new
folder, <code>data_output</code>, in our working directory that will
store this generated dataset. We don’t want to write generated datasets
in the same directory as our raw data. It’s good practice to keep them
separate. The <code>data</code> folder should only contain the raw,
unaltered data, and should be left alone to make sure we don’t delete or
modify it. In contrast, our script will generate the contents of the
<code>data_output</code> directory, so even if the files it contains are
deleted, we can always re-generate them.</p>
<p>In preparation for our next lesson on plotting, we created a version
of the dataset where each of the columns includes only one data value.
Now we can save this data frame to our <code>data_output</code>
directory.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">write_csv</span><span class="op">(</span><span class="va">interviews_plotting</span>, file <span class="op">=</span> <span class="st">"data_output/interviews_plotting.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use the <code>tidyr</code> package to change the layout of data
frames.</li>
<li>Use <code>pivot_wider()</code> to go from long to wide format.</li>
<li>Use <code>pivot_longer()</code> to go from wide to long format.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-05-ggplot2"><p>Content from <a href="05-ggplot2.html">Data Visualisation with ggplot2</a></p>
<hr>
<p>Last updated on 2025-07-01 |

        <a href="https://github.com/datacarpentry/r-socialsci/edit/main/episodes/05-ggplot2.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 115 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<ul>
<li>This episode is a broad overview of ggplot2 and focuses on (1)
getting familiar with the layering system of ggplot2, (2) using the
argument <code>group</code> in the <code>aes()</code> function, (3)
basic customization of the plots.</li>
<li>The episode depends on data created in the Data Wrangling with tidyr
episode. If you did not get to or through all of the tidyr episode, you
can have the learners access the data by either downloading it or
quickly creating it using the tidyr code below. You will probably want
to copy the code into the Etherpad.</li>
<li>If you did skip the tidyr episode, you might want to go over the
exporting data section in that episode.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are the components of a ggplot?</li>
<li>What are the main differences between R base plots, lattice, and
ggplot?</li>
<li>How do I create scatterplots, boxplots, and barplots?</li>
<li>How can I change the aesthetics (ex. colour, transparency) of my
plot?</li>
<li>How can I create multiple plots at once?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Produce scatter plots, boxplots, and barplots using ggplot.</li>
<li>Set universal plot settings.</li>
<li>Describe what faceting is and apply faceting in ggplot.</li>
<li>Modify the aesthetics of an existing ggplot plot (including axis
labels and colour).</li>
<li>Build complex and customized plots from data in a data frame.</li>
<li>Recognize the differences between base R, lattice, and ggplot
visualizations.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>We start by loading the required package.
<strong><code>ggplot2</code></strong> is also included in the
<strong><code>tidyverse</code></strong> package.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<p>If not still in the workspace, load the data we saved in the previous
lesson.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data_output/interviews_plotting.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 131 Columns: 45
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr   (5): village, respondent_wall_type, memb_assoc, affect_conflicts, inst...
dbl   (8): key_ID, no_membrs, years_liv, rooms, liv_count, no_meals, number_...
lgl  (31): bicycle, television, solar_panel, table, cow_cart, radio, cow_plo...
dttm  (1): interview_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<p>If you were unable to complete the previous lesson or did not save
the data, then you can create it now. Either download it using
<code>read_csv()</code> (Option 1) or create it with the
<strong>dplyr</strong> and <strong>tidyr</strong> code (Option 2).</p>
<div class="tabs">
<nav><div id="nav-tab-1" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-1-1" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-1" type="button" role="tab" aria-controls="nav-tabpanel-1-1" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-1-1">
  Option 1: Download the data
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-2" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-2" type="button" role="tab" aria-controls="nav-tabpanel-1-2" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-2">
  Option 2: Create the data
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-1" class="tab-content">
<div id="nav-tabpanel-1-1" class="tab-pane show active" aria-labelledby="nav-tab-1-1" role="tabpanel">
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/datacarpentry/r-socialsci/main/episodes/data/interviews_plotting.csv"</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div id="nav-tabpanel-1-2" class="tab-pane" aria-labelledby="nav-tab-1-2" role="tabpanel">
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Can be used to load in data from previous lesson!</span></span>
<span><span class="va">interviews_plotting</span> <span class="op">&lt;-</span> <span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co">## pivot wider by items_owned</span></span>
<span>  <span class="fu">separate_longer_delim</span><span class="op">(</span><span class="va">items_owned</span>, delim <span class="op">=</span> <span class="st">";"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">replace_na</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>items_owned <span class="op">=</span> <span class="st">"no_listed_items"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co">## Use of grouped mutate to find number of rows</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">key_ID</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>items_owned_logical <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         number_items <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">items_owned</span> <span class="op">==</span> <span class="st">"no_listed_items"</span>, <span class="fl">0</span>, <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">items_owned</span>,</span>
<span>              values_from <span class="op">=</span> <span class="va">items_owned_logical</span>,</span>
<span>              values_fill <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>items_owned_logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">## pivot wider by months_lack_food</span></span>
<span>  <span class="fu">separate_longer_delim</span><span class="op">(</span><span class="va">months_lack_food</span>, delim <span class="op">=</span> <span class="st">";"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>months_lack_food_logical <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         number_months_lack_food <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">months_lack_food</span> <span class="op">==</span> <span class="st">"none"</span>, <span class="fl">0</span>, <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">months_lack_food</span>,</span>
<span>              values_from <span class="op">=</span> <span class="va">months_lack_food_logical</span>,</span>
<span>              values_fill <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>months_lack_food_logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="visualization-options-in-r">Visualization Options in R<a class="anchor" aria-label="anchor" href="#visualization-options-in-r"></a>
</h2>
<hr class="half-width">
<p>Before we start with <strong><code>ggplot2</code></strong>, it’s
helpful to know that there are several ways to create visualizations in
R. While <strong><code>ggplot2</code></strong> is great for building
complex and highly customizable plots, there are simpler and quicker
alternatives that you might encounter or use depending on the context.
Let’s briefly explore a few of them:</p>
<div class="section level3">
<h3 id="r-base-plots">R Base Plots<a class="anchor" aria-label="anchor" href="#r-base-plots"></a>
</h3>
<p>Base R plots are the simplest form of visualization and are great for
quick, exploratory analysis. You can create plots with very little code,
but customizing them can be cumbersome compared to
<strong><code>ggplot2</code></strong>.</p>
<p>Example of a simple scatterplot in base R using the
<code>no_membrs</code> and <code>liv_count</code> variables:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">interviews_plotting</span><span class="op">$</span><span class="va">no_membrs</span>, <span class="va">interviews_plotting</span><span class="op">$</span><span class="va">liv_count</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Base R Scatterplot"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Number of Household Members"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Number of Livestock Owned"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="lattice">
<strong><code>Lattice</code></strong><a class="anchor" aria-label="anchor" href="#lattice"></a>
</h3>
<p>Lattice is another plotting system in R, which allows for creating
multi-panel plots easily. It’s different from ggplot2 because you define
the entire plot in a single function call, and modifications after
plotting are limited.</p>
<p>Example of a lattice plot using <code>no_membrs</code> and
<code>liv_count</code> split by <code>village</code>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">lattice</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">xyplot</span><span class="op">(</span><span class="va">liv_count</span> <span class="op">~</span> <span class="va">no_membrs</span> <span class="op">|</span> <span class="va">village</span>, data <span class="op">=</span> <span class="va">interviews_plotting</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Lattice Plot: Livestock Count by Household Members"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Number of Household Members"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Number of Livestock Owned"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</section><section><h2 class="section-heading" id="plotting-with-ggplot2">Plotting with <strong><code>ggplot2</code></strong>
<a class="anchor" aria-label="anchor" href="#plotting-with-ggplot2"></a>
</h2>
<hr class="half-width">
<p><strong><code>ggplot2</code></strong> is a plotting package that
makes it simple to create complex plots from data stored in a data
frame. It provides a programmatic interface for specifying what
variables to plot, how they are displayed, and general visual
properties. Therefore, we only need minimal changes if the underlying
data change or if we decide to change from a bar plot to a scatterplot.
This helps in creating publication quality plots with minimal amounts of
adjustments and tweaking.</p>
<p><strong><code>ggplot2</code></strong> functions work best with data
in the ‘long’ format, i.e., a column for every dimension, and a row for
every observation. Well-structured data will save you lots of time when
making figures with <strong><code>ggplot2</code></strong></p>
<p>ggplot graphics are built step by step by adding new elements. Adding
layers in this fashion allows for extensive flexibility and
customization of plots.</p>
<p>Each chart built with ggplot2 must include the following</p>
<ul>
<li><p>Data</p></li>
<li>
<p>Aesthetic mapping (aes)</p>
<ul>
<li>Describes how variables are mapped onto graphical attributes</li>
<li>Visual attribute of data including x-y axes, color, fill, shape, and
alpha</li>
</ul>
</li>
<li>
<p>Geometric objects (geom)</p>
<ul>
<li>Determines how values are rendered graphically, as bars
(<code>geom_bar</code>), scatterplot (<code>geom_point</code>), line
(<code>geom_line</code>), etc.</li>
</ul>
</li>
</ul>
<p>Thus, the template for graphic in ggplot2 is:</p>
<pre><code>&lt;DATA&gt; %&gt;%
    ggplot(aes(&lt;MAPPINGS&gt;)) +
    &lt;GEOM_FUNCTION&gt;()</code></pre>
<p>Remember from the last lesson that the pipe operator
<code>%&gt;%</code> places the result of the previous line(s) into the
first argument of the function. <strong><code>ggplot</code></strong> is
a function that expects a data frame to be the first argument. This
allows for us to change from specifying the <code>data =</code> argument
within the <code>ggplot</code> function and instead pipe the data into
the function.</p>
<ul>
<li>use the <code>ggplot()</code> function and bind the plot to a
specific data frame.</li>
</ul>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<ul>
<li>define a mapping (using the aesthetic (<code>aes</code>) function),
by selecting the variables to be plotted and specifying how to present
them in the graph, e.g. as x/y positions or characteristics such as
size, shape, color, etc.</li>
</ul>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<ul>
<li>
<p>add ‘geoms’ – graphical representations of the data in the plot
(points, lines, bars). <strong><code>ggplot2</code></strong> offers many
different geoms; we will use some common ones today, including:</p>
<ul>
<li>
<code>geom_point()</code> for scatter plots, dot plots, etc.</li>
<li>
<code>geom_boxplot()</code> for, well, boxplots!</li>
<li>
<code>geom_line()</code> for trend lines, time series, etc.</li>
</ul>
</li>
</ul>
<p>To add a geom to the plot use the <code>+</code> operator. Because we
have two continuous variables, let’s use <code>geom_point()</code>
first:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-first-ggplot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The <code>+</code> in the <strong><code>ggplot2</code></strong>
package is particularly useful because it allows you to modify existing
<code>ggplot</code> objects. This means you can easily set up plot
templates and conveniently explore different types of plots, so the
above plot can also be generated with code like this, similar to the
“intermediate steps” approach in the previous lesson:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assign plot to a variable</span></span>
<span><span class="va">interviews_plot</span> <span class="op">&lt;-</span> <span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Draw the plot as a dot plot</span></span>
<span><span class="va">interviews_plot</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div id="notes" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="notes" class="callout-inner">
<h3 class="callout-title">Notes</h3>
<div class="callout-content">
<ul>
<li>Anything you put in the <code>ggplot()</code> function can be seen
by any geom layers that you add (i.e., these are universal plot
settings). This includes the x- and y-axis mapping you set up in
<code>aes()</code>.</li>
<li>You can also specify mappings for a given geom independently of the
mapping defined globally in the <code>ggplot()</code> function.</li>
<li>The <code>+</code> sign used to add new layers must be placed at the
end of the line containing the <em>previous</em> layer. If, instead, the
<code>+</code> sign is added at the beginning of the line containing the
new layer, <strong><code>ggplot2</code></strong> will not add the new
layer and will return an error message.</li>
</ul>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## This is the correct syntax for adding layers</span></span>
<span><span class="va">interviews_plot</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## This will not add the new layer and will return an error message</span></span>
<span><span class="va">interviews_plot</span></span>
<span><span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="building-your-plots-iteratively">Building your plots iteratively<a class="anchor" aria-label="anchor" href="#building-your-plots-iteratively"></a>
</h2>
<hr class="half-width">
<p>Building plots with <strong><code>ggplot2</code></strong> is
typically an iterative process. We start by defining the dataset we’ll
use, lay out the axes, and choose a geom:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-create-ggplot-object-1.png" alt="Scatter plot of number of items owned versus number of household members." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Then, we start modifying this plot to extract more information from
it. For instance, when inspecting the plot we notice that points only
appear at the intersection of whole numbers of <code>no_membrs</code>
and <code>number_items</code>. Also, from a rough estimate, it looks
like there are far fewer dots on the plot than there rows in our
dataframe. This should lead us to believe that there may be multiple
observations plotted on top of each other (e.g. three observations where
<code>no_membrs</code> is 3 and <code>number_items</code> is 1).</p>
<p>There are two main ways to alleviate overplotting issues:</p>
<ol style="list-style-type: decimal">
<li>changing the transparency of the points</li>
<li>jittering the location of the points</li>
</ol>
<p>Let’s first explore option 1, changing the transparency of the
points. What we mean when we say “transparency” we mean the opacity of
point, or your ability to see through the point. We can control the
transparency of the points with the <code>alpha</code> argument to
<code>geom_point</code>. Values of <code>alpha</code> range from 0 to 1,
with lower values corresponding to more transparent colors (an
<code>alpha</code> of 1 is the default value). Specifically, an alpha of
0.1, would make a point one-tenth as opaque as a normal point. Stated
differently ten points stacked on top of each other would correspond to
a normal point.</p>
<p>Here, we change the <code>alpha</code> to 0.5, in an attempt to help
fix the overplotting. While the overplotting isn’t solved, adding
transparency begins to address this problem, as the points where there
are overlapping observations are darker (as opposed to lighter
gray):</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-adding-transparency-1.png" alt="Scatter plot of number of items owned versus number of household members, with transparency added to points." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>That only helped a little bit with the overplotting problem, so let’s
try option two. We can jitter the points on the plot, so that we can see
each point in the locations where there are overlapping points.
Jittering introduces a little bit of randomness into the position of our
points. You can think of this process as taking the overplotted graph
and giving it a tiny shake. The points will move a little bit
side-to-side and up-and-down, but their position from the original plot
won’t dramatically change. Note that this solution is suitable for
plotting integer figures, while for numeric figures with decimals,
geom_jitter() becomes inappropriate because it obscures the true value
of the observation.</p>
<p>We can jitter our points using the <code>geom_jitter()</code>
function instead of the <code>geom_point()</code> function, as seen
below:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_jitter</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-adding-jitter-1.png" alt="Scatter plot of number of items owned versus number of household members, showing jitter." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The <code>geom_jitter()</code> function allows for us to specify the
amount of random motion in the jitter, using the <code>width</code> and
<code>height</code> arguments. When we don’t specify values for
<code>width</code> and <code>height</code>, <code>geom_jitter()</code>
defaults to 40% of the resolution of the data (the smallest change that
can be measured). Hence, if we would like <em>less</em> spread in our
jitter than was default, we should pick values between 0.1 and 0.4.
Experiment with the values to see how your plot changes.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_jitter</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                width <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>                height <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-adding-width-height-1.png" alt="Scatter plot of number of items owned versus number of household members, with jitter and transparency." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>For our final change, we can also add colours for all the points by
specifying a <code>color</code> argument inside the
<code>geom_jitter()</code> function:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_jitter</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                color <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>                width <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>                height <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-adding-colors-1.png" alt="Scatter plot of number of items owned versus number of household members, showing points as blue." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>To colour each village in the plot differently, you could use a
vector as an input to the argument <strong><code>color</code></strong>.
However, because we are now mapping features of the data to a colour,
instead of setting one colour for all points, the colour of the points
now needs to be set inside a call to the
<strong><code>aes</code></strong> function. When we map a variable in
our data to the colour of the points,
<strong><code>ggplot2</code></strong> will provide a different colour
corresponding to the different values of the variable. We will continue
to specify the value of <strong><code>alpha</code></strong>,
<strong><code>width</code></strong>, and
<strong><code>height</code></strong> outside of the
<strong><code>aes</code></strong> function because we are using the same
value for every point. ggplot2 understands both the Commonwealth English
and American English spellings for colour, i.e., you can use either
<code>color</code> or <code>colour</code>. Here is an example where we
color points by the <strong><code>village</code></strong> of the
observation:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_jitter</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">village</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-color-by-species-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>There appears to be a positive trend between number of household
members and number of items owned (from the list provided).
Additionally, this trend does not appear to be different by village.</p>
<div id="notes-1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="notes-1" class="callout-inner">
<h3 class="callout-title">Notes</h3>
<div class="callout-content">
<p>As you will learn, there are multiple ways to plot the a relationship
between variables. Another way to plot data with overlapping points is
to use the <code>geom_count</code> plotting function. The
<code>geom_count()</code> function makes the size of each point
representative of the number of data items of that type and the legend
gives point sizes associated to particular numbers of items.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span>, color <span class="op">=</span> <span class="va">village</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">geom_count</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-color-by-species-notes-1.png" alt="Previous plot with dots colored by village." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>Use what you just learned to create a scatter plot of
<code>rooms</code> by <code>village</code> with the
<code>respondent_wall_type</code> showing in different colours. Does
this seem like a good way to display the relationship between these
variables? What other kinds of plots might you use to show this type of
data?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">rooms</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_jitter</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">respondent_wall_type</span><span class="op">)</span>,</span>
<span>      alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>        width <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>        height <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-scatter-challenge-1.png" alt="Scatter plot showing positive trend between number of household members and number of items owned." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This is not a great way to show this type of data because it is
difficult to distinguish between villages. What other plot types could
help you visualize this relationship better?</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="boxplot">Boxplot<a class="anchor" aria-label="anchor" href="#boxplot"></a>
</h2>
<hr class="half-width">
<p>We can use boxplots to visualize the distribution of rooms for each
wall type:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span>, y <span class="op">=</span> <span class="va">rooms</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-boxplot-1.png" alt="Box plot of number of rooms by wall type." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>By adding points to a boxplot, we can have a better idea of the
number of measurements and of their distribution:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span>, y <span class="op">=</span> <span class="va">rooms</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_boxplot</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_jitter</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>        color <span class="op">=</span> <span class="st">"tomato"</span>,</span>
<span>        width <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>        height <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-boxplot-with-jitter-1.png" alt="Previous plot with dot plot added as additional layer to show individual values. Boxplot layer is transparent." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We can see that muddaub houses and sunbrick houses tend to be smaller
than burntbrick houses.</p>
<p>Notice how the boxplot layer is behind the jitter layer? What do you
need to change in the code to put the boxplot layer in front of the
jitter layer?</p>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>Boxplots are useful summaries, but hide the <em>shape</em> of the
distribution. For example, if the distribution is bimodal, we would not
see it in a boxplot. An alternative to the boxplot is the violin plot,
where the shape (of the density of points) is drawn.</p>
<ul>
<li>Replace the box plot with a violin plot; see
<code>geom_violin()</code>.</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span>, y <span class="op">=</span> <span class="va">rooms</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Groups with fewer than two datapoints have been dropped.
ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes.</code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-violin-plot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<em> (continued)</em>
</h3>
<div class="callout-content">
<p>So far, we’ve looked at the distribution of room number within wall
type. Try making a new plot to explore the distribution of another
variable within wall type.</p>
<ul>
<li>Create a boxplot for <code>liv_count</code> for each wall type.
Overlay the boxplot layer on a jitter layer to show actual
measurements.</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span>, y <span class="op">=</span> <span class="va">liv_count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">geom_boxplot</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">geom_jitter</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-boxplot-exercise-1.png" alt="Box plot of number of livestock owned by wall type, with dot plot added as additional layer to show individual values." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<em> (continued)</em>
</h3>
<div class="callout-content">
<ul>
<li>Add colour to the data points on your boxplot according to whether
the respondent is a member of an irrigation association
(<code>memb_assoc</code>).</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span>, y <span class="op">=</span> <span class="va">liv_count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">memb_assoc</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-boxplot-exercise-factor-1.png" alt="Previous plot with dots colored based on whether respondent was a member of an irrigation association." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="barplots">Barplots<a class="anchor" aria-label="anchor" href="#barplots"></a>
</h2>
<hr class="half-width">
<p>Barplots are also useful for visualizing categorical data. By
default, <code>geom_bar</code> accepts a variable for x, and plots the
number of instances each value of x (in this case, wall type) appears in
the dataset.</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-barplot-1-1.png" alt="Bar plot showing counts of respondent wall types." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We can use the <code>fill</code> aesthetic for the
<code>geom_bar()</code> geom to colour bars by the portion of each count
that is from each village.</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">village</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-barplot-stack-1.png" alt="Stacked bar plot of wall types showing each village as a different color." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This creates a stacked bar chart. These are generally more difficult
to read than side-by-side bars. We can separate the portions of the
stacked bar that correspond to each village and put them side-by-side by
using the <code>position</code> argument for <code>geom_bar()</code> and
setting it to “dodge”.</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">village</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-barplot-dodge-1.png" alt="Bar plot of respondent wall types with each village as a separate bar." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This is a nicer graphic, but we’re more likely to be interested in
the proportion of each housing type in each village than in the actual
count of number of houses of each type (because we might have sampled
different numbers of households in each village). To compare
proportions, we will first create a new data frame
(<code>percent_wall_type</code>) with a new column named “percent”
representing the percent of each house type in each village. We will
remove houses with cement walls, as there was only one in the
dataset.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_wall_type</span> <span class="op">&lt;-</span> <span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="va">respondent_wall_type</span> <span class="op">!=</span> <span class="st">"cement"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">count</span><span class="op">(</span><span class="va">village</span>, <span class="va">respondent_wall_type</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>percent <span class="op">=</span> <span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fu">sum</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Now we can use this new data frame to create our plot showing the
percentage of each house type in each village.</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_wall_type</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">percent</span>, fill <span class="op">=</span> <span class="va">respondent_wall_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-barplot-wall-type-1.png" alt="Side by side bar plot showing percent of respondents in each village with each wall type." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="exercise-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>Create a bar plot showing the proportion of respondents in each
village who are or are not part of an irrigation association
(<code>memb_assoc</code>). Include only respondents who answered that
question in the calculations and plot. Which village had the lowest
proportion of respondents in an irrigation association?</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_memb_assoc</span> <span class="op">&lt;-</span> <span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">memb_assoc</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">village</span>, <span class="va">memb_assoc</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>percent <span class="op">=</span> <span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fu">sum</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">percent_memb_assoc</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">percent</span>, fill <span class="op">=</span> <span class="va">memb_assoc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-barplot-memb-assoc-1.png" alt="Bar plot showing percent of respondents in each village who were part of association." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Ruaca had the lowest proportion of members in an irrigation
association.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="adding-labels-and-titles">Adding Labels and Titles<a class="anchor" aria-label="anchor" href="#adding-labels-and-titles"></a>
</h2>
<hr class="half-width">
<p>By default, the axes labels on a plot are determined by the name of
the variable being plotted. However,
<strong><code>ggplot2</code></strong> offers lots of customization
options, like specifying the axes labels, and adding a title to the plot
with relatively few lines of code. We will add more informative x-and
y-axis labels to our plot, a more explanatory label to the legend, and a
plot title.</p>
<p>The <code>labs</code> function takes the following arguments:</p>
<ul>
<li>
<code>title</code> – to produce a plot title</li>
<li>
<code>subtitle</code> – to produce a plot subtitle (smaller text
placed beneath the title)</li>
<li>
<code>caption</code> – a caption for the plot</li>
<li>
<code>...</code> – any pair of name and value for aesthetics used in
the plot (e.g., <code>x</code>, <code>y</code>, <code>fill</code>,
<code>color</code>, <code>size</code>)</li>
</ul>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_wall_type</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">percent</span>, fill <span class="op">=</span> <span class="va">respondent_wall_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Proportion of wall type by village"</span>,</span>
<span>         fill <span class="op">=</span> <span class="st">"Type of Wall in Home"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Village"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Percent"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-barplot-wall-types-labeled-1.png" alt="Previous plot with plot title and labells added." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="faceting">Faceting<a class="anchor" aria-label="anchor" href="#faceting"></a>
</h2>
<hr class="half-width">
<p>Rather than creating a single plot with side-by-side bars for each
village, we may want to create multiple plot, where each plot shows the
data for a single village. This would be especially useful if we had a
large number of villages that we had sampled, as a large number of
side-by-side bars will become more difficult to read.</p>
<p><strong><code>ggplot2</code></strong> has a special technique called
<em>faceting</em> that allows the user to split one plot into multiple
plots based on a factor included in the dataset. We will use it to split
our barplot of housing type proportion by village so that each village
has its own panel in a multi-panel plot:</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_wall_type</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span>, y <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Proportion of wall type by village"</span>,</span>
<span>         x<span class="op">=</span><span class="st">"Wall Type"</span>,</span>
<span>         y<span class="op">=</span><span class="st">"Percent"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">village</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-barplot-faceting-1.png" alt="Bar plot showing percent of each wall type in each village." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Click the “Zoom” button in your RStudio plots pane to view a larger
version of this plot.</p>
<p>Usually plots with white background look more readable when printed.
We can set the background to white using the function
<code>theme_bw()</code>. Additionally, you can remove the grid:</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_wall_type</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span>, y <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Proportion of wall type by village"</span>,</span>
<span>         x<span class="op">=</span><span class="st">"Wall Type"</span>,</span>
<span>         y<span class="op">=</span><span class="st">"Percent"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">village</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-barplot-theme-bw-1.png" alt="Bar plot showing percent of each wall type in each village, with black and white theme applied." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>What if we wanted to see the proportion of respondents in each
village who owned a particular item? We can calculate the percent of
people in each village who own each item and then create a faceted
series of bar plots where each plot is a particular item. First we need
to calculate the percentage of people in each village who own each
item:</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_items</span> <span class="op">&lt;-</span> <span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="va">bicycle</span><span class="op">:</span><span class="va">no_listed_items</span>, <span class="op">~</span> <span class="fu">sum</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">/</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">bicycle</span><span class="op">:</span><span class="va">no_listed_items</span>, names_to <span class="op">=</span> <span class="st">"items"</span>, values_to <span class="op">=</span> <span class="st">"percent"</span><span class="op">)</span></span></code></pre>
</div>
<p>To calculate this percentage data frame, we needed to use the
<code>across()</code> function within a <code>summarize()</code>
operation. Unlike the previous example with a single wall type variable,
where each response was exactly one of the types specified, people can
(and do) own more than one item. So there are multiple columns of data
(one for each item), and the percentage calculation needs to be repeated
for each column.</p>
<p>Combining <code>summarize()</code> with <code>across()</code> allows
us to specify first, the columns to be summarized
(<code>bicycle:no_listed_items</code>) and then the calculation. Because
our calculation is a bit more complex than is available in a built-in
function, we define a new formula:</p>
<ul>
<li>
<code>~</code> indicates that we are defining a formula,</li>
<li>
<code>sum(.x)</code> gives the number of people owning that item by
counting the number of <code>TRUE</code> values (<code>.x</code> is
shorthand for the column being operated on),</li>
<li>and <code>n()</code> gives the current group size.</li>
</ul>
<p>After the <code>summarize()</code> operation, we have a table of
percentages with each item in its own column, so a
<code>pivot_longer()</code> is required to transform the table into an
easier format for plotting. Using this data frame, we can now create a
multi-paneled bar plot.</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_items</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">items</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-percent-items-barplot-1.png" alt="Multi-panel bar chart showing percent  of respondents in each village and who owned each item, with no grids behid bars." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="ggplot2-themes">
<strong><code>ggplot2</code></strong> themes<a class="anchor" aria-label="anchor" href="#ggplot2-themes"></a>
</h2>
<hr class="half-width">
<p>In addition to <code>theme_bw()</code>, which changes the plot
background to white, <strong><code>ggplot2</code></strong> comes with
several other themes which can be useful to quickly change the look of
your visualization. The complete list of themes is available at <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">https://ggplot2.tidyverse.org/reference/ggtheme.html</a>.
<code>theme_minimal()</code> and <code>theme_light()</code> are popular,
and <code>theme_void()</code> can be useful as a starting point to
create a new hand-crafted theme.</p>
<p>The <a href="https://jrnold.github.io/ggthemes/reference/index.html" class="external-link">ggthemes</a>
package provides a wide variety of options (including an Excel 2003
theme). The <a href="https://exts.ggplot2.tidyverse.org/" class="external-link"><strong><code>ggplot2</code></strong>
extensions website</a> provides a list of packages that extend the
capabilities of <strong><code>ggplot2</code></strong>, including
additional themes.</p>
<div id="exercise-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-3" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>Experiment with at least two different themes. Build the previous
plot using each of those themes. Which do you like best?</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="customization">Customization<a class="anchor" aria-label="anchor" href="#customization"></a>
</h2>
<hr class="half-width">
<p>Take a look at the <a href="https://github.com/rstudio/cheatsheets/blob/main/data-visualization-2.1.pdf" class="external-link"><strong><code>ggplot2</code></strong>
cheat sheet</a>, and think of ways you could improve the plot.</p>
<p>Now, let’s change names of axes to something more informative than
‘village’ and ‘percent’ and add a title to the figure:</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_items</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">items</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Percent of respondents in each village who owned each item"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Village"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Percent of Respondents"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-ggplot-customization-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The axes have more informative names, but their readability can be
improved by increasing the font size:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_items</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">items</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Percent of respondents in each village who owned each item"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Village"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Percent of Respondents"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-ggplot-customization-font-size-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Note that it is also possible to change the fonts of your plots. If
you are on Windows, you may have to install the <a href="https://github.com/wch/extrafont" class="external-link"><strong><code>extrafont</code></strong>
package</a>, and follow the instructions included in the README for this
package.</p>
<p>After our manipulations, you may notice that the values on the x-axis
are still not properly readable. Let’s change the orientation of the
labels and adjust them vertically and horizontally so they don’t
overlap. You can use a 90-degree angle, or experiment to find the
appropriate angle for diagonally oriented labels. With a larger font,
the title also runs off. We can add “\n” in the string for the title to
insert a new line:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_items</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">items</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Percent of respondents in each village \n who owned each item"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Village"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Percent of Respondents"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey20"</span>, size <span class="op">=</span> <span class="fl">12</span>, angle <span class="op">=</span> <span class="fl">45</span>,</span>
<span>                                     hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>          axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey20"</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>          text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-ggplot-customization-label-orientation-1.png" alt="Multi-panel bar charts showing percent of respondents in each village and who owned each item, with grids behind the bars." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>If you like the changes you created better than the default theme,
you can save them as an object to be able to easily apply them to other
plots you may create. We can also add
<code>plot.title = element_text(hjust = 0.5)</code> to centre the
title:</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grey_theme</span> <span class="op">&lt;-</span> <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey20"</span>, size <span class="op">=</span> <span class="fl">12</span>,</span>
<span>                                               angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                                               vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                    axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey20"</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                    text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>                    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">percent_items</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">items</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Percent of respondents in each village \n who owned each item"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Village"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Percent of Respondents"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">grey_theme</span></span></code></pre>
</div>
<figure><img src="../fig/05-ggplot2-rendered-ggplot-custom-themes-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="exercise-4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-4" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>With all of this information in hand, please take another five
minutes to either improve one of the plots generated in this exercise or
create a beautiful graph of your own. Use the RStudio <a href="https://github.com/rstudio/cheatsheets/blob/main/data-visualization-2.1.pdf" class="external-link"><strong><code>ggplot2</code></strong>
cheat sheet</a> for inspiration. Here are some ideas:</p>
<ul>
<li>See if you can make the bars white with black outline.</li>
<li>Try using a different colour palette (see <a href="https://www.cookbook-r.com/Graphs/Colors_(ggplot2)/" class="external-link">http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/</a>).</li>
</ul>
</div>
</div>
</div>
<p>After creating your plot, you can save it to a file in your favourite
format. The Export tab in the <strong>Plot</strong> pane in RStudio will
save your plots at low resolution, which will not be accepted by many
journals and will not scale well for posters.</p>
<p>Instead, use the <code>ggsave()</code> function, which allows you to
easily change the dimension and resolution of your plot by adjusting the
appropriate arguments (<code>width</code>, <code>height</code> and
<code>dpi</code>).</p>
<p>Make sure you have the <code>fig_output/</code> folder in your
working directory.</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_plot</span> <span class="op">&lt;-</span> <span class="va">percent_items</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">items</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Percent of respondents in each village \n who owned each item"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Village"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Percent of Respondents"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey20"</span>, size <span class="op">=</span> <span class="fl">12</span>, angle <span class="op">=</span> <span class="fl">45</span>,</span>
<span>                                     hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>          axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey20"</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>          text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>          plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="st">"fig_output/name_of_file.png"</span>, <span class="va">my_plot</span>, width <span class="op">=</span> <span class="fl">15</span>, height <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<p>Note: The parameters <code>width</code> and <code>height</code> also
determine the font size in the saved plot.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>
<code>ggplot2</code> is a flexible and useful tool for creating
plots in R.</li>
<li>The data set and coordinate system can be defined using the
<code>ggplot</code> function.</li>
<li>Additional layers, including geoms, are added using the
<code>+</code> operator.</li>
<li>Boxplots are useful for visualizing the distribution of a continuous
variable.</li>
<li>Barplots are useful for visualizing categorical data.</li>
<li>Faceting allows you to generate multiple plots based on a
categorical variable.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-06-rmarkdown"><p>Content from <a href="06-rmarkdown.html">Getting started with R Markdown (Optional)</a></p>
<hr>
<p>Last updated on 2025-07-01 |

        <a href="https://github.com/datacarpentry/r-socialsci/edit/main/episodes/06-rmarkdown.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<ul>
<li>This is an optional lesson intended to introduce learners to R
Markdown.</li>
<li>While it is listed after the core lessons, some instructors may
prefer to teach it early in the workshop, depending on the
audience.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is R Markdown?</li>
<li>How can I integrate my R code with text and plots?</li>
<li>How can I convert .Rmd files to .html?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Create a .Rmd document containing R code, text, and plots</li>
<li>Create a YAML header to control output</li>
<li>Understand basic syntax of (R)Markdown</li>
<li>Customise code chunks to control formatting</li>
<li>Use code chunks and in-line code to create dynamic, reproducible
documents</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="r-markdown">R Markdown<a class="anchor" aria-label="anchor" href="#r-markdown"></a>
</h2>
<hr class="half-width">
<p>R Markdown is a flexible type of document that allows you to
seamlessly combine executable R code, and its output, with text in a
single document. These documents can be readily converted to multiple
static and dynamic output formats, including PDF (.pdf), Word (.docx),
and HTML (.html).</p>
<p>The benefit of a well-prepared R Markdown document is full
reproducibility. This also means that, if you notice a data
transcription error, or you are able to add more data to your analysis,
you will be able to recompile the report without making any changes in
the actual document.</p>
<p>The <strong>rmarkdown</strong> package comes pre-installed with
RStudio, so no action is necessary.</p>
<figure><img src="../fig/rmarkdown_wizards.png" alt="R Markdown wizard monsters creating a R Markdown document from a recipe. Art by Allison Horst" width="100%" style="display: block; margin: auto;" class="figure"><figcaption>
Image credit:
<a href="https://github.com/allisonhorst/stats-illustrations" class="external-link">Allison
Horst</a>
</figcaption></figure></section><section><h2 class="section-heading" id="creating-an-r-markdown-file">Creating an R Markdown file<a class="anchor" aria-label="anchor" href="#creating-an-r-markdown-file"></a>
</h2>
<hr class="half-width">
<p>To create a new R Markdown document in RStudio, click File -&gt; New
File -&gt; R Markdown:</p>
<figure><img src="../fig/new-rmd.png" alt="Screenshot of the New R Markdown file dialogue box in RStudio" class="figure mx-auto d-block"></figure><p>Then click on ‘Create Empty Document’. Normally you could enter the
title of your document, your name (Author), and select the type of
output, but we will be learning how to start from a blank document.</p>
</section><section><h2 class="section-heading" id="basic-components-of-r-markdown">Basic components of R Markdown<a class="anchor" aria-label="anchor" href="#basic-components-of-r-markdown"></a>
</h2>
<hr class="half-width">
<p>To control the output, a YAML (YAML Ain’t Markup Language) header is
needed:</p>
<pre><code>---
title: "My Awesome Report"
author: "Emmet Brickowski"
date: ""
output: html_document
---</code></pre>
<p>The header is defined by the three hyphens at the beginning
(<code>---</code>) and the three hyphens at the end
(<code>---</code>).</p>
<p>In the YAML, the only required field is the <code>output:</code>,
which specifies the type of output you want. This can be an
<code>html_document</code>, a <code>pdf_document</code>, or a
<code>word_document</code>. We will start with an HTML doument and
discuss the other options later.</p>
<p>The rest of the fields can be deleted, if you don’t need them. After
the header, to begin the body of the document, you start typing after
the end of the YAML header (i.e. after the second <code>---</code>).</p>
</section><section><h2 class="section-heading" id="markdown-syntax">Markdown syntax<a class="anchor" aria-label="anchor" href="#markdown-syntax"></a>
</h2>
<hr class="half-width">
<p>Markdown is a popular markup language that allows you to add
formatting elements to text, such as <strong>bold</strong>,
<em>italics</em>, and <code>code</code>. The formatting will not be
immediately visible in a markdown (.md) document, like you would see in
a Word document. Rather, you add Markdown syntax to the text, which can
then be converted to various other files that can translate the Markdown
syntax. Markdown is useful because it is lightweight, flexible, and
platform independent.</p>
<p>Some platforms provide a real time preview of the formatting, like
RStudio’s visual markdown editor (available from version 1.4).</p>
<p>First, let’s create a heading! A <code>#</code> in front of text
indicates to Markdown that this text is a heading. Adding more
<code>#</code>s make the heading smaller, i.e. one <code>#</code> is a
first level heading, two <code>##</code>s is a second level heading,
etc. upto the 6th level heading.</p>
<pre><code><span><span class="co"># Title</span></span>
<span><span class="co">## Section</span></span>
<span><span class="co">### Sub-section</span></span>
<span><span class="co">#### Sub-sub section</span></span>
<span><span class="co">##### Sub-sub-sub section</span></span>
<span><span class="co">###### Sub-sub-sub-sub section</span></span></code></pre>
<p>(only use a level if the one above is also in use)</p>
<p>Since we have already defined our title in the YAML header, we will
use a section heading to create an Introduction section.</p>
<pre><code><span><span class="co">## Introduction</span></span></code></pre>
<p>You can make things <strong>bold</strong> by surrounding the word
with double asterisks, <code>**bold**</code>, or double underscores,
<code>__bold__</code>; and <em>italicize</em> using single asterisks,
<code>*italics*</code>, or single underscores,
<code>_italics_</code>.</p>
<p>You can also combine <strong>bold</strong> and <em>italics</em> to
write something <strong><em>really</em></strong> important with
triple-asterisks, <code>***really***</code>, or underscores,
<code>___really___</code>; and, if you’re feeling bold (pun intended),
you can also use a combination of asterisks and underscores,
<code>**_really_**</code>, <code>**_really_**</code>.</p>
<p>To create <code>code-type</code> font, surround the word with
backticks, <code>`code-type`</code>.</p>
<p>Now that we’ve learned a couple of things, it might be useful to
implement them:</p>
<pre><code>## Introduction

This report uses the **tidyverse** package along with the *SAFI* dataset,
which has columns that include:</code></pre>
<p>Then we can create a list for the variables using <code>-</code>,
<code>+</code>, or <code>*</code> keys.</p>
<pre><code>## Introduction

This report uses the **tidyverse** package along with the *SAFI* dataset,
which has columns that include:

- village
- interview_date
- no_members
- years_liv
- respondent_wall_type
- rooms</code></pre>
<p>You can also create an ordered list using numbers:</p>
<pre><code>1. village
2. interview_date
3. no_members
4. years_liv
5. respondent_wall_type
6. rooms</code></pre>
<p>And nested items by tab-indenting:</p>
<pre><code>- village
  + Name of village
- interview_date
  + Date of interview
- no_members
  + How many family members lived in a house
- years_liv
  + How many years respondent has lived in village or neighbouring village
- respondent_wall_type
  + Type of wall of house
- rooms
  + Number of rooms in house</code></pre>
<p>For more Markdown syntax see <a href="https://www.markdownguide.org/basic-syntax" class="external-link">the following
reference guide</a>.</p>
<p>Now we can render the document into HTML by clicking the
<strong>Knit</strong> button in the top of the Source pane (top left),
or use the keyboard shortcut
<kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>K</kbd> on Windows and Linux, and
<kbd>Cmd</kbd>+<kbd>Shift</kbd>+<kbd>K</kbd> on Mac. If you haven’t
saved the document yet, you will be prompted to do so when you
<strong>Knit</strong> for the first time.</p>
<figure><img src="../fig/rmd-rmd_to_html.png" alt="The 'knitting' process: First, R Markdown is converted to Markdown, which is then converted (via pandoc) to .html, .pdf, .docx, etc." class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="writing-an-r-markdown-report">Writing an R Markdown report<a class="anchor" aria-label="anchor" href="#writing-an-r-markdown-report"></a>
</h2>
<hr class="half-width">
<p>Now we will add some R code from our previous data wrangling and
visualisation, which means we need to make sure
<strong>tidyverse</strong> is loaded. It is not enough to load
<strong>tidyverse</strong> from the console, we will need to load it
within our R Markdown document. The same applies to our data. To load
these, we will need to create a ‘code chunk’ at the top of our document
(below the YAML header).</p>
<p>A code chunk can be inserted by clicking Code &gt; Insert Chunk, or
by using the keyboard shortcuts
<kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>I</kbd> on Windows and Linux, and
<kbd>Cmd</kbd>+<kbd>Option</kbd>+<kbd>I</kbd> on Mac.</p>
<p>The syntax of a code chunk is:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="in">```{r chunk-name}</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="in">"Here is where you place the R code that you want to run."</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="in">```</span></span></code></pre>
</div>
<p>An R Markdown document knows that this text is not part of the report
from the <code>```</code> that begins and ends the chunk. It also knows
that the code inside of the chunk is R code from the <code>r</code>
inside of the curly braces (<code>{}</code>). After the <code>r</code>
you can add a name for the code chunk . Naming a chunk is optional, but
recommended. Each chunk name must be unique, and only contain
alphanumeric characters and <code>-</code>.</p>
<p>To load <strong>tidyverse</strong> and our
<code>SAFI_clean.csv</code> file, we will insert a chunk and call it
‘setup’. Since we don’t want this code or the output to show in our
knitted HTML document, we add an <code>include = FALSE</code> option
after the code chunk name (<code>{r setup, include = FALSE}</code>).</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="in">```{r setup, include = FALSE}</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="in">library(here)</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="in">interviews &lt;- read_csv(here("data/SAFI_clean.csv"), na = "NULL")</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="in">```</span></span></code></pre>
</div>
<div id="important-note" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="important-note" class="callout-inner">
<h3 class="callout-title">Important Note!</h3>
<div class="callout-content">
<p>The file paths you give in a .Rmd document, e.g. to load a .csv file,
are relative to the .Rmd document, <strong>not</strong> the project
root.</p>
<p>As suggested in the Starting with Data episode, we highly recommend
the use of the <code>here()</code> function to keep the file paths
consistent within your project.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="insert-table">Insert table<a class="anchor" aria-label="anchor" href="#insert-table"></a>
</h2>
<hr class="half-width">
<p>Next, we will re-create a table from the Data Wrangling episode which
shows the average household size grouped by <code>village</code> and
<code>memb_assoc</code>. We can do this by creating a new code chunk and
calling it ‘interview-tbl’. Or, you can come up with something more
creative (just remember to stick to the naming rules).</p>
<p>It isn’t necessary to <strong>Knit</strong> your document every time
you want to see the output. Instead you can run the code chunk with the
green triangle in the top right corner of the the chunk, or with the
keyboard shortcuts: <kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>C</kbd> on
Windows and Linux, or <kbd>Cmd</kbd>+<kbd>Option</kbd>+<kbd>C</kbd> on
Mac.</p>
<p>To make sure the table is formatted nicely in our output document, we
will need to use the <code>kable()</code> function from the
<strong>knitr</strong> package. The <code>kable()</code> function takes
the output of your R code and knits it into a nice looking HTML table.
You can also specify different aspects of the table, e.g. the column
names, a caption, etc.</p>
<p>Run the code chunk to make sure you get the desired output.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">memb_assoc</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span>, <span class="va">memb_assoc</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span>mean_no_membrs <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu">kable</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"We can also add a caption."</span>, </span>
<span>               col.names <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Village"</span>, <span class="st">"Member Association"</span>, </span>
<span>                             <span class="st">"Mean Number of Members"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<table class="table">
<caption>We can also add a caption.</caption>
<thead><tr class="header">
<th align="left">Village</th>
<th align="left">Member Association</th>
<th align="right">Mean Number of Members</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Chirodzo</td>
<td align="left">no</td>
<td align="right">8.062500</td>
</tr>
<tr class="even">
<td align="left">Chirodzo</td>
<td align="left">yes</td>
<td align="right">7.818182</td>
</tr>
<tr class="odd">
<td align="left">God</td>
<td align="left">no</td>
<td align="right">7.133333</td>
</tr>
<tr class="even">
<td align="left">God</td>
<td align="left">yes</td>
<td align="right">8.000000</td>
</tr>
<tr class="odd">
<td align="left">Ruaca</td>
<td align="left">no</td>
<td align="right">7.178571</td>
</tr>
<tr class="even">
<td align="left">Ruaca</td>
<td align="left">yes</td>
<td align="right">9.500000</td>
</tr>
</tbody>
</table>
<p>Many different R packages can be used to generate tables. Some of the
more commonly used options are listed in the table below.</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="19%">
<col width="59%">
</colgroup>
<thead><tr class="header">
<th>Name</th>
<th>Creator(s)</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><a href="https://condformat.sergioller.com/index.html" class="external-link">condformat</a></td>
<td><a href="https://cran.rstudio.com/web/packages/condformat/index.html" class="external-link">Oller
Moreno (2022)</a></td>
<td>Apply and visualize conditional formatting to data frames in R. It
renders a data frame with cells formatted according to criteria defined
by rules, using a tidy evaluation syntax.</td>
</tr>
<tr class="even">
<td><a href="https://rstudio.github.io/DT/" class="external-link">DT</a></td>
<td><a href="https://cran.r-project.org/web/packages/DT/index.html" class="external-link">Xie
et al. (2023)</a></td>
<td>Data objects in R can be rendered as HTML tables using the
JavaScript library ‘DataTables’ (typically via R Markdown or Shiny). The
‘DataTables’ library has been included in this R package.</td>
</tr>
<tr class="odd">
<td><a href="https://github.com/renkun-ken/formattable" class="external-link">formattable</a></td>
<td><a href="https://cran.r-project.org/web/packages/formattable/index.html" class="external-link">Ren
and Russell (2021)</a></td>
<td>Provides functions to create formattable vectors and data frames.
‘Formattable’ vectors are printed with text formatting, and formattable
data frames are printed with multiple types of formatting in HTML to
improve the readability of data presented in tabular form rendered on
web pages.</td>
</tr>
<tr class="even">
<td><a href="https://davidgohel.github.io/flextable/" class="external-link">flextable</a></td>
<td><a href="https://cran.r-project.org/web/packages/flextable/index.html" class="external-link">Gohel
and Skintzos (2023)</a></td>
<td>Use a grammar for creating and customizing pretty tables. The
following formats are supported: ‘HTML’, ‘PDF’, ‘RTF’, ‘Microsoft Word’,
‘Microsoft PowerPoint’ and R ‘Grid Graphics’. ‘R Markdown’, ‘Quarto’,
and the package ‘officer’ can be used to produce the result files.</td>
</tr>
<tr class="odd">
<td><a href="https://gt.rstudio.com/" class="external-link">gt</a></td>
<td><a href="https://cloud.r-project.org/web/packages/gt/index.html" class="external-link">Iannone et
al. (2022)</a></td>
<td>Build display tables from tabular data with an easy-to-use set of
functions. With its progressive approach, we can construct display
tables with cohesive table parts. Table values can be formatted using
any of the included formatting functions.</td>
</tr>
<tr class="even">
<td><a href="https://hughjonesd.github.io/huxtable/" class="external-link">huxtable</a></td>
<td><a href="https://cran.r-project.org/web/packages/huxtable/index.html" class="external-link">Hugh-Jones
(2022)</a></td>
<td>Creates styled tables for data presentation. Export to HTML, LaTeX,
RTF, ‘Word’, ‘Excel’, and ‘PowerPoint’. Simple, modern interface to
manipulate borders, size, position, captions, colours, text styles and
number formatting.</td>
</tr>
<tr class="odd">
<td><a href="https://rapporter.github.io/pander/" class="external-link">pander</a></td>
<td><a href="https://cran.r-project.org/web/packages/pander/index.html" class="external-link">Daróczi
and Tsegelskyi (2022)</a></td>
<td>Contains some functions catching all messages, ‘stdout’ and other
useful information while evaluating R code and other helpers to return
user specified text elements (e.g., header, paragraph, table, image,
lists etc.) in ‘pandoc’ markdown or several types of R objects similarly
automatically transformed to markdown format.</td>
</tr>
<tr class="even">
<td><a href="https://pixiedust.github.io/pixiedust/" class="external-link">pixiedust</a></td>
<td><a href="https://cran.rstudio.com/web/packages/pixiedust/index.html" class="external-link">Nutter
and Kretch (2021)</a></td>
<td>‘pixiedust’ provides tidy data frames with a programming interface
intended to be similar to ’ggplot2’s system of layers with fine-tuned
control over each cell of the table.</td>
</tr>
<tr class="odd">
<td><a href="https://glin.github.io/reactable/" class="external-link">reactable</a></td>
<td><a href="https://cran.r-project.org/web/packages/reactable/index.html" class="external-link">Lin
et al. (2023)</a></td>
<td>Interactive data tables for R, based on the ‘React Table’ JavaScript
library. Provides an HTML widget that can be used in ‘R Markdown’ or
‘Quarto’ documents, ‘Shiny’ applications, or viewed from an R
console.</td>
</tr>
<tr class="even">
<td><a href="http://jrowen.github.io/rhandsontable/" class="external-link">rhandsontable</a></td>
<td><a href="https://cran.r-project.org/web/packages/rhandsontable/index.html" class="external-link">Owen
et al. (2021)</a></td>
<td>An R interface to the ‘Handsontable’ JavaScript library, which is a
minimalist Excel-like data grid editor.</td>
</tr>
<tr class="odd">
<td><a href="https://github.com/cran/stargazer" class="external-link">stargazer</a></td>
<td><a href="https://cran.r-project.org/web/packages/stargazer/index.html" class="external-link">Hlavac
(2022)</a></td>
<td>Produces LaTeX code, HTML/CSS code and ASCII text for well-formatted
tables that hold regression analysis results from several models
side-by-side, as well as summary statistics.</td>
</tr>
<tr class="even">
<td><a href="https://github.com/dmurdoch/tables" class="external-link">tables</a></td>
<td><a href="https://cran.r-project.org/web/packages/tables/index.html" class="external-link">Murdoch
(2022)</a></td>
<td>Computes and displays complex tables of summary statistics. Output
may be in LaTeX, HTML, plain text, or an R matrix for further
processing.</td>
</tr>
<tr class="odd">
<td><a href="https://github.com/spgarbet/tangram" class="external-link">tangram</a></td>
<td><a href="https://cran.r-project.org/web/packages/tangram/index.html" class="external-link">Garbett
et al. (2023)</a></td>
<td>Provides an extensible formula system to quickly and easily create
production quality tables. The processing steps are a formula parser,
statistical content generation from data defined by a formula, and
rendering into a table.</td>
</tr>
<tr class="even">
<td><a href="https://github.com/cran/xtable" class="external-link">xtable</a></td>
<td><a href="https://cran.r-project.org/web/packages/xtable/index.html" class="external-link">Dahl et
al. (2019)</a></td>
<td>Coerce data to LaTeX and HTML tables.</td>
</tr>
<tr class="odd">
<td><a href="https://github.com/cardiomoon/ztable" class="external-link">ztable</a></td>
<td><a href="https://cran.r-project.org/web/packages/ztable/index.html" class="external-link">Moon
(2021)</a></td>
<td>Makes zebra-striped tables (tables with alternating row colors) in
LaTeX and HTML formats easily from a data.frame, matrix, lm, aov, anova,
glm, coxph, nls, fitdistr, mytable and cbind.mytable objects.</td>
</tr>
</tbody>
</table></section><section><h2 class="section-heading" id="customising-chunk-output">Customising chunk output<a class="anchor" aria-label="anchor" href="#customising-chunk-output"></a>
</h2>
<hr class="half-width">
<p>We mentioned using <code>include = FALSE</code> in a code chunk to
prevent the code and output from printing in the knitted document. There
are additional options available to customise how the code-chunks are
presented in the output document. The options are entered in the code
chunk after <code>chunk-name</code> and separated by commas,
e.g. <code>{r chunk-name, eval = FALSE, echo = TRUE}</code>.</p>
<table class="table">
<colgroup>
<col width="5%">
<col width="5%">
<col width="88%">
</colgroup>
<thead><tr class="header">
<th>Option</th>
<th>Options</th>
<th>Output</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>eval</code></td>
<td>
<code>TRUE</code> or <code>FALSE</code>
</td>
<td>Whether or not the code within the code chunk should be run.</td>
</tr>
<tr class="even">
<td><code>echo</code></td>
<td>
<code>TRUE</code> or <code>FALSE</code>
</td>
<td>Choose if you want to show your code chunk in the output document.
<code>echo = TRUE</code> will show the code chunk.</td>
</tr>
<tr class="odd">
<td><code>include</code></td>
<td>
<code>TRUE</code> or <code>FALSE</code>
</td>
<td>Choose if the output of a code chunk should be included in the
document. <code>FALSE</code> means that your code will run, but will not
show up in the document.</td>
</tr>
<tr class="even">
<td><code>warning</code></td>
<td>
<code>TRUE</code> or <code>FALSE</code>
</td>
<td>Whether or not you want your output document to display potential
warning messages produced by your code.</td>
</tr>
<tr class="odd">
<td><code>message</code></td>
<td>
<code>TRUE</code> or <code>FALSE</code>
</td>
<td>Whether or not you want your output document to display potential
messages produced by your code.</td>
</tr>
<tr class="even">
<td><code>fig.align</code></td>
<td>
<code>default</code>, <code>left</code>, <code>right</code>,
<code>center</code>
</td>
<td>Where the figure from your R code chunk should be output on the
page</td>
</tr>
</tbody>
</table>
<div id="tip" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip" class="callout-inner">
<h3 class="callout-title">Tip</h3>
<div class="callout-content">
<ul>
<li>The default settings for the above chunk options are all
<code>TRUE</code>.</li>
<li>The default settings can be modified per chunk, or with
<code>knitr::opts_chunk$set()</code>,</li>
<li>Entering <code>knitr::opts_chunk$set(echo = FALSE)</code> will
change the default of value of <code>echo</code> to <code>FALSE</code>
for <strong>every</strong> code chunk in the document.</li>
</ul>
</div>
</div>
</div>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>Play around with the different options in the chunk with the code for
the table, and re-<strong>Knit</strong> to see what each option does to
the output.</p>
<p>What happens if you use <code>eval = FALSE</code> and
<code>echo = FALSE</code>? What is the difference between this and
<code>include = FALSE</code>?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Solution to Exercise </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Create a chunk with <code>{r eval = FALSE, echo = FALSE}</code>, then
create another chunk with <code>{r include = FALSE}</code> to compare.
<code>eval = FALSE</code> and <code>echo = FALSE</code> will neither run
the code in the chunk, nor show the code in the knitted document. The
code chunk essentially doesn’t exist in the knitted document as it was
never run. Whereas <code>include = FALSE</code> will run the code and
store the output for later use.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="in-line-r-code">In-line R code<a class="anchor" aria-label="anchor" href="#in-line-r-code"></a>
</h2>
<hr class="half-width">
<p>Now we will use some in-line R code to present some descriptive
statistics. To use in-line R-code, we use the same backticks that we
used in the Markdown section, with an <code>r</code> to specify that we
are generating R-code. The difference between in-line code and a code
chunk is the number of backticks. In-line R code uses one backtick
(<code>`r`</code>), whereas code chunks use three backticks
(<code>```r```</code>).</p>
<p>For example, today’s date is <code>`r Sys.Date()`</code>, will be
rendered as: today’s date is 2025-07-01.<br>
The code will display today’s date in the output document (well,
technically the date the document was last knitted).</p>
<p>The best way to use in-line R code, is to minimise the amount of code
you need to produce the in-line output by preparing the output in code
chunks. Let’s say we’re interested in presenting the average household
size in a village.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a summary data frame with the mean household size by village</span></span>
<span><span class="va">mean_household</span> <span class="op">&lt;-</span> <span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span>mean_no_membrs <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># and select the village we want to use</span></span>
<span><span class="va">mean_chirodzo</span> <span class="op">&lt;-</span> <span class="va">mean_household</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">village</span> <span class="op">==</span> <span class="st">"Chirodzo"</span><span class="op">)</span></span></code></pre>
</div>
<p>Now we can make an informative statement on the means of each
village, and include the mean values as in-line R-code. For example:</p>
<p>The average household size in the village of Chirodzo is
<code>`r round(mean_chirodzo$mean_no_membrs, 2)`</code></p>
<p>becomes…</p>
<p>The average household size in the village of Chirodzo is 7.08.</p>
<p>Because we are using in-line R code instead of the actual values, we
have created a dynamic document that will automatically update if we
make changes to the dataset and/or code chunks.</p>
</section><section><h2 class="section-heading" id="plots">Plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h2>
<hr class="half-width">
<p>Finally, we will also include a plot, so our document is a little
more colourful and a little less boring. We will use the
<code>interview_plotting</code> data from the previous episode.</p>
<p>If you were unable to complete the previous lesson or did not save
the data, then you can create it in a new code chunk.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Not run, but can be used to load in data from previous lesson!</span></span>
<span><span class="va">interviews_plotting</span> <span class="op">&lt;-</span> <span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co">## pivot wider by items_owned</span></span>
<span>  <span class="fu">separate_rows</span><span class="op">(</span><span class="va">items_owned</span>, sep <span class="op">=</span> <span class="st">";"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co">## if there were no items listed, changing NA to no_listed_items</span></span>
<span>  <span class="fu">replace_na</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>items_owned <span class="op">=</span> <span class="st">"no_listed_items"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>items_owned_logical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">items_owned</span>, </span>
<span>              values_from <span class="op">=</span> <span class="va">items_owned_logical</span>, </span>
<span>              values_fill <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>items_owned_logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co">## pivot wider by months_lack_food</span></span>
<span>  <span class="fu">separate_rows</span><span class="op">(</span><span class="va">months_lack_food</span>, sep <span class="op">=</span> <span class="st">";"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>months_lack_food_logical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">months_lack_food</span>, </span>
<span>              values_from <span class="op">=</span> <span class="va">months_lack_food_logical</span>, </span>
<span>              values_fill <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>months_lack_food_logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co">## add some summary columns</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>number_months_lack_food <span class="op">=</span> <span class="fu">rowSums</span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">.</span>, <span class="va">Jan</span><span class="op">:</span><span class="va">May</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>number_items <span class="op">=</span> <span class="fu">rowSums</span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">.</span>, <span class="va">bicycle</span><span class="op">:</span><span class="va">car</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>Create a new code chunk for the plot, and copy the code from any of
the plots we created in the previous episode to produce a plot in the
chunk. I recommend one of the colourful plots.</p>
<p>If you are feeling adventurous, you can also create a new plot with
the <code>interviews_plotting</code> data frame.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Solution to Exercise </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">village</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/06-rmarkdown-rendered-my-fancy-plot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<p>We can also create a caption with the chunk option
<code>fig.cap</code>.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">MARKDOWN<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode markdown" tabindex="0"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="in">```{r chunk-name, fig.cap = "I made this plot while attending an</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="in">awesome Data Carpentries workshop where I learned a ton of cool stuff!"}</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="in">Code for plot</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="in">```</span></span></code></pre>
</div>
<p>…or, ideally, something more informative.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">village</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Type of Wall in Home"</span>, y <span class="op">=</span> <span class="st">"Count"</span>, fill <span class="op">=</span> <span class="st">"Village Name"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_d</span><span class="op">(</span><span class="op">)</span> <span class="co"># add colour deficient friendly palette</span></span></code></pre>
</div>
<figure style="text-align: center"><img src="../fig/06-rmarkdown-rendered-caption-plot-1.png" alt="I made this plot while attending an awesome Data Carpentries workshop where I learned a ton of cool stuff!" class="figure mx-auto d-block"><figcaption>
I made this plot while attending an awesome Data Carpentries workshop
where I learned a ton of cool stuff!
</figcaption></figure></section><section><h2 class="section-heading" id="other-output-options">Other output options<a class="anchor" aria-label="anchor" href="#other-output-options"></a>
</h2>
<hr class="half-width">
<p>You can convert R Markdown to a PDF or a Word document (among
others). Click the little triangle next to the <strong>Knit</strong>
button to get a drop-down menu. Or you could put
<code>pdf_document</code> or <code>word_document</code> in the initial
header of the file.</p>
<pre><code>---
title: "My Awesome Report"
author: "Emmet Brickowski"
date: ""
output: word_document
---</code></pre>
<div id="note-creating-pdf-documents" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note-creating-pdf-documents" class="callout-inner">
<h3 class="callout-title">Note: Creating PDF documents</h3>
<div class="callout-content">
<p>Creating .pdf documents may require installation of some extra
software. The R package <code>tinytex</code> provides some tools to help
make this process easier for R users. With <code>tinytex</code>
installed, run <code>tinytex::install_tinytex()</code> to install the
required software (you’ll only need to do this once) and then when you
<strong>Knit</strong> to pdf <code>tinytex</code> will automatically
detect and install any additional LaTeX packages that are needed to
produce the pdf document. Visit the <a href="https://yihui.org/tinytex/" class="external-link">tinytex website</a> for more
information.</p>
</div>
</div>
</div>
<div id="note-inserting-citations-into-an-r-markdown-file" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note-inserting-citations-into-an-r-markdown-file" class="callout-inner">
<h3 class="callout-title">Note: Inserting citations into an R Markdown file</h3>
<div class="callout-content">
<p>It is possible to insert citations into an R Markdown file using the
editor toolbar. The editor toolbar includes commonly seen formatting
buttons generally seen in text editors (e.g., bold and italic buttons).
The toolbar is accessible by using the settings dropdown menu (next to
the ‘Knit’ dropdown menu) to select ‘Use Visual Editor’, also accessible
through the shortcut ‘Crtl+Shift+F4’. From here, clicking ‘Insert’
allows ‘Citation’ to be selected (shortcut: ‘Crtl+Shift+F8’). For
example, searching ‘10.1007/978-3-319-24277-4’ in ‘From DOI’ and
inserting will provide the citation for <code>ggplot2</code> <span class="citation">[@wickham2016]</span>. This will also save the
citation(s) in ‘references.bib’ in the current working directory. Visit
the <a href="https://rstudio.github.io/visual-markdown-editing/" class="external-link">R
Studio website</a> for more information. Tip: obtaining citation
information from relevant packages can be done by using
<code>citation("package")</code>.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<hr class="half-width">
<ul>
<li><a href="https://kbroman.org/knitr_knutshell" class="external-link">Knitr in a knutshell
tutorial</a></li>
<li>
<a href="https://www.amazon.com/exec/obidos/ASIN/1482203537/7210-20" class="external-link">Dynamic
Documents with R and knitr</a> (book)</li>
<li><a href="https://rmarkdown.rstudio.com" class="external-link">R Markdown
documentation</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/blob/master/rmarkdown-2.0.pdf" class="external-link">R
Markdown cheat sheet</a></li>
<li><a href="https://www.rstudio.com/resources/webinars/getting-started-with-r-markdown/" class="external-link">Getting
started with R Markdown</a></li>
<li><a href="https://commonmark.org/help/tutorial/" class="external-link">Markdown
tutorial</a></li>
<li>
<a href="https://bookdown.org/yihui/rmarkdown/" class="external-link">R Markdown: The
Definitive Guide</a> (book by Rstudio team)</li>
<li><a href="https://www.rstudio.com/resources/webinars/reproducible-reporting/" class="external-link">Reproducible
Reporting</a></li>
<li><a href="https://www.rstudio.com/resources/webinars/introducing-bookdown/" class="external-link">Introducing
Bookdown</a></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>R Markdown is a useful language for creating reproducible documents
combining text and executable R-code.</li>
<li>Specify chunk options to control formatting of the output
document</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-07-json"><p>Content from <a href="07-json.html">Processing JSON data (Optional)</a></p>
<hr>
<p>Last updated on 2025-07-01 |

        <a href="https://github.com/datacarpentry/r-socialsci/edit/main/episodes/07-json.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<ul>
<li>This is an optional lessons intended to introduce learners to JSON
data, as well as how to read JSON data into R and how to convert the
data into a data frame or array.</li>
<li>Note that his lesson was community-contributed and remains a work in
progress. As such, it could benefit from feedback from instructors
and/or workshop participants.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is JSON format?</li>
<li>How can I convert JSON to an R dataframe?</li>
<li>How can I convert an array of JSON record into a table?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe the JSON data format</li>
<li>Understand where JSON is typically used</li>
<li>Appreciate some advantages of using JSON over tabular data</li>
<li>Appreciate some disadvantages of processing JSON documents</li>
<li>Use the jsonLite package to read a JSON file</li>
<li>Display formatted JSON as dataframe</li>
<li>Select and display nested dataframe fields from a JSON document</li>
<li>Write tabular data from selected elements from a JSON document to a
csv file</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="the-json-data-format">The JSON data format<a class="anchor" aria-label="anchor" href="#the-json-data-format"></a>
</h2>
<hr class="half-width">
<p>The JSON data format was designed as a way of allowing different
machines or processes within machines to communicate with each other by
sending messages constructed in a well defined format. JSON is now the
preferred data format used by APIs (Application Programming
Interfaces).</p>
<p>The JSON format although somewhat verbose is not only Human readable
but it can also be mapped very easily to an R dataframe.</p>
<p>We are going to read a file of data formatted as JSON, convert it
into a dataframe in R then selectively create a csv file from the
extracted data.</p>
<p>The JSON file we are going to use is the <a href="../data/SAFI.json">SAFI.json</a> file. This is the output file from
an electronic survey system called ODK. The JSON represents the answers
to a series of survey questions. The questions themselves have been
replaced with unique Keys, the values are the answers.</p>
<p>Because detailed surveys are by nature nested structures making it
possible to record different levels of detail or selectively ask a set
of specific questions based on the answer given to a previous question,
the structure of the answers for the survey can not only be complex and
convoluted, it could easily be different from one survey respondent’s
set of answers to another.</p>
<div class="section level3">
<h3 id="advantages-of-json">Advantages of JSON<a class="anchor" aria-label="anchor" href="#advantages-of-json"></a>
</h3>
<ul>
<li>Very popular data format for APIs (e.g. results from an Internet
search)</li>
<li>Human readable</li>
<li>Each record (or document as they are called) is self contained. The
equivalent of the column name and column values are in every
record.</li>
<li>Documents do not all have to have the same structure within the same
file</li>
<li>Document structures can be complex and nested</li>
</ul>
</div>
<div class="section level3">
<h3 id="disadvantages-of-json">Disadvantages of JSON<a class="anchor" aria-label="anchor" href="#disadvantages-of-json"></a>
</h3>
<ul>
<li>It is more verbose than the equivalent data in csv format</li>
<li>Can be more difficult to process and display than csv formatted
data</li>
</ul>
</div>
</section><section><h2 class="section-heading" id="use-the-json-package-to-read-a-json-file">Use the JSON package to read a JSON file<a class="anchor" aria-label="anchor" href="#use-the-json-package-to-read-a-json-file"></a>
</h2>
<hr class="half-width">
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">jsonlite</span><span class="op">)</span></span></code></pre>
</div>
<p>As with reading in a CSV, you have a couple of options for how to
access the JSON file.</p>
<p>You can read the JSON file directly into R with
<code>read_json()</code> or the comparable <code>fromJSON()</code>
function, though this does not download the file.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">json_data</span> <span class="op">&lt;-</span> <span class="fu">read_json</span><span class="op">(</span></span>
<span>  <span class="st">"https://raw.githubusercontent.com/datacarpentry/r-socialsci/main/episodes/data/SAFI.json"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<p>To download the file you can copy and paste the contents of the file
on <a href="https://github.com/datacarpentry/r-socialsci/blob/main/episodes/data/SAFI.json" class="external-link">GitHub</a>,
creating a <code>SAFI.json</code> file in your <code>data</code>
directory, or you can download the file with R.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">download.file</span><span class="op">(</span></span>
<span>  <span class="st">"https://raw.githubusercontent.com/datacarpentry/r-socialsci/main/episodes/data/SAFI.json"</span>,</span>
<span>   <span class="st">"data/SAFI.json"</span>, mode <span class="op">=</span> <span class="st">"wb"</span><span class="op">)</span></span></code></pre>
</div>
<p>Once you have the data downloaded, you can read it into R with
<code>read_json()</code>:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">json_data</span> <span class="op">&lt;-</span> <span class="fu">read_json</span><span class="op">(</span><span class="st">"data/SAFI.json"</span><span class="op">)</span></span></code></pre>
</div>
<p>We can see that a new object called json_data has appeared in our
Environment. It is described as a Large list (131 elements). In this
current form, our data is messy. You can have a glimpse of it with the
<code>head()</code> or <code>view()</code> functions. It will look not
much more structured than if you were to open the JSON file with a text
editor.</p>
<p>This is because, by default, the <code>read_json()</code> function’s
parameter <code>simplifyVector</code>, which specifies whether or not to
simplify vectors is set to FALSE. This means that the default setting
does not simplify nested lists into vectors and data frames. However, we
can set this to TRUE, and our data will be read directly as a
dataframe:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">json_data</span> <span class="op">&lt;-</span> <span class="fu">read_json</span><span class="op">(</span><span class="st">"data/SAFI.json"</span>, simplifyVector <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<p>Now we can see we have this json data in a dataframe format. For
consistency with the rest of the lesson, let’s coerce it to be a tibble
and use <code>glimpse</code> to take a peek inside (these functions were
loaded by <code><a href="https://tidyverse.tidyverse.org" class="external-link">library(tidyverse)</a></code>):</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">json_data</span> <span class="op">&lt;-</span> <span class="va">json_data</span> <span class="op">%&gt;%</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">glimpse</span><span class="op">(</span><span class="va">json_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 131
Columns: 74
$ C06_rooms                      &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 3, 1, 5, 1, 3, 1, …
$ B19_grand_liv                  &lt;chr&gt; "no", "yes", "no", "no", "yes", "no", "…
$ A08_ward                       &lt;chr&gt; "ward2", "ward2", "ward2", "ward2", "wa…
$ E01_water_use                  &lt;chr&gt; "no", "yes", "no", "no", "no", "no", "y…
$ B18_sp_parents_liv             &lt;chr&gt; "yes", "yes", "no", "no", "no", "no", "…
$ B16_years_liv                  &lt;int&gt; 4, 9, 15, 6, 40, 3, 38, 70, 6, 23, 20, …
$ E_yes_group_count              &lt;chr&gt; NA, "3", NA, NA, NA, NA, "4", "2", "3",…
$ F_liv                          &lt;list&gt; [&lt;data.frame[1 x 2]&gt;], [&lt;data.frame[3 …
$ `_note2`                       &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ instanceID                     &lt;chr&gt; "uuid:ec241f2c-0609-46ed-b5e8-fe575f6ce…
$ B20_sp_grand_liv               &lt;chr&gt; "yes", "yes", "no", "no", "no", "no", "…
$ F10_liv_owned_other            &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ `_note1`                       &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ F12_poultry                    &lt;chr&gt; "yes", "yes", "yes", "yes", "yes", "no"…
$ D_plots_count                  &lt;chr&gt; "2", "3", "1", "3", "2", "1", "4", "2",…
$ C02_respondent_wall_type_other &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ C02_respondent_wall_type       &lt;chr&gt; "muddaub", "muddaub", "burntbricks", "b…
$ C05_buildings_in_compound      &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 2, 2, 1, …
$ `_remitters`                   &lt;list&gt; [&lt;data.frame[0 x 0]&gt;], [&lt;data.frame[0 …
$ E18_months_no_water            &lt;list&gt; &lt;NULL&gt;, &lt;"Aug", "Sept"&gt;, &lt;NULL&gt;, &lt;NULL…
$ F07_use_income                 &lt;chr&gt; NA, "AlimentaÃ§Ã£o e pagamento de educa…
$ G01_no_meals                   &lt;int&gt; 2, 2, 2, 2, 2, 2, 3, 2, 3, 3, 2, 3, 2, …
$ E17_no_enough_water            &lt;chr&gt; NA, "yes", NA, NA, NA, NA, "yes", "yes"…
$ F04_need_money                 &lt;chr&gt; NA, "no", NA, NA, NA, NA, "no", "no", "…
$ A05_end                        &lt;chr&gt; "2017-04-02T17:29:08.000Z", "2017-04-02…
$ C04_window_type                &lt;chr&gt; "no", "no", "yes", "no", "no", "no", "n…
$ E21_other_meth                 &lt;chr&gt; NA, "no", NA, NA, NA, NA, "no", "no", "…
$ D_no_plots                     &lt;int&gt; 2, 3, 1, 3, 2, 1, 4, 2, 3, 2, 2, 2, 4, …
$ F05_money_source               &lt;list&gt; &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;…
$ A07_district                   &lt;chr&gt; "district1", "district1", "district1", …
$ C03_respondent_floor_type      &lt;chr&gt; "earth", "earth", "cement", "earth", "e…
$ E_yes_group                    &lt;list&gt; [&lt;data.frame[0 x 0]&gt;], [&lt;data.frame[3 …
$ A01_interview_date             &lt;chr&gt; "2016-11-17", "2016-11-17", "2016-11-17…
$ B11_remittance_money           &lt;chr&gt; "no", "no", "no", "no", "no", "no", "no…
$ A04_start                      &lt;chr&gt; "2017-03-23T09:49:57.000Z", "2017-04-02…
$ D_plots                        &lt;list&gt; [&lt;data.frame[2 x 8]&gt;], [&lt;data.frame[3 …
$ F_items                        &lt;list&gt; [&lt;data.frame[3 x 3]&gt;], [&lt;data.frame[2 …
$ F_liv_count                    &lt;chr&gt; "1", "3", "1", "2", "4", "1", "1", "2",…
$ F10_liv_owned                  &lt;list&gt; "poultry", &lt;"oxen", "cows", "goats"&gt;, …
$ B_no_membrs                    &lt;int&gt; 3, 7, 10, 7, 7, 3, 6, 12, 8, 12, 6, 7, …
$ F13_du_look_aftr_cows          &lt;chr&gt; "no", "no", "no", "no", "no", "no", "no…
$ E26_affect_conflicts           &lt;chr&gt; NA, "once", NA, NA, NA, NA, "never", "n…
$ F14_items_owned                &lt;list&gt; &lt;"bicycle", "television", "solar_panel…
$ F06_crops_contr                &lt;chr&gt; NA, "more_half", NA, NA, NA, NA, "more_…
$ B17_parents_liv                &lt;chr&gt; "no", "yes", "no", "no", "yes", "no", "…
$ G02_months_lack_food           &lt;list&gt; "Jan", &lt;"Jan", "Sept", "Oct", "Nov", "…
$ A11_years_farm                 &lt;dbl&gt; 11, 2, 40, 6, 18, 3, 20, 16, 16, 22, 6,…
$ F09_du_labour                  &lt;chr&gt; "no", "no", "yes", "yes", "no", "yes", …
$ E_no_group_count               &lt;chr&gt; "2", NA, "1", "3", "2", "1", NA, NA, NA…
$ E22_res_change                 &lt;list&gt; &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;…
$ E24_resp_assoc                 &lt;chr&gt; NA, "no", NA, NA, NA, NA, NA, "yes", NA…
$ A03_quest_no                   &lt;chr&gt; "01", "01", "03", "04", "05", "6", "7",…
$ `_members`                     &lt;list&gt; [&lt;data.frame[3 x 12]&gt;], [&lt;data.frame[7…
$ A06_province                   &lt;chr&gt; "province1", "province1", "province1", …
$ `gps:Accuracy`                 &lt;dbl&gt; 14, 19, 13, 5, 10, 12, 11, 9, 11, 14, 1…
$ E20_exper_other                &lt;chr&gt; NA, "yes", NA, NA, NA, NA, "yes", "yes"…
$ A09_village                    &lt;chr&gt; "village2", "village2", "village2", "vi…
$ C01_respondent_roof_type       &lt;chr&gt; "grass", "grass", "mabatisloping", "mab…
$ `gps:Altitude`                 &lt;dbl&gt; 698, 690, 674, 679, 689, 692, 709, 700,…
$ `gps:Longitude`                &lt;dbl&gt; 33.48346, 33.48342, 33.48345, 33.48342,…
$ E23_memb_assoc                 &lt;chr&gt; NA, "yes", NA, NA, NA, NA, "no", "yes",…
$ E19_period_use                 &lt;dbl&gt; NA, 2, NA, NA, NA, NA, 10, 10, 6, 22, N…
$ E25_fees_water                 &lt;chr&gt; NA, "no", NA, NA, NA, NA, "no", "no", "…
$ C07_other_buildings            &lt;chr&gt; "no", "no", "no", "no", "no", "no", "ye…
$ observation                    &lt;chr&gt; "None", "Estes primeiros inquÃ©ritos na…
$ `_note`                        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ A12_agr_assoc                  &lt;chr&gt; "no", "yes", "no", "no", "no", "no", "n…
$ G03_no_food_mitigation         &lt;list&gt; &lt;"na", "rely_less_food", "reduce_meals…
$ F05_money_source_other         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ `gps:Latitude`                 &lt;dbl&gt; -19.11226, -19.11248, -19.11211, -19.11…
$ E_no_group                     &lt;list&gt; [&lt;data.frame[2 x 6]&gt;], [&lt;data.frame[0 …
$ F14_items_owned_other          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ F08_emply_lab                  &lt;chr&gt; "no", "yes", "no", "no", "no", "no", "n…
$ `_members_count`               &lt;chr&gt; "3", "7", "10", "7", "7", "3", "6", "12…</code></pre>
</div>
<p>Looking good, but you might notice that actually we have a variable,
<em>F_liv</em> that is a list of dataframes! It is very important to
know what you are expecting from your data to be able to look for things
like this. For example, if you are getting your JSON from an API, have a
look at the API documentation, so you know what to look for.</p>
<p>Often when we have a very large number of columns, it can become
difficult to determine all the variables which may require some special
attention, like lists. Fortunately, we can use special verbs like
<code>where</code> to quickly select all the list columns.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">json_data</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.list</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">glimpse</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 131
Columns: 14
$ F_liv                  &lt;list&gt; [&lt;data.frame[1 x 2]&gt;], [&lt;data.frame[3 x 2]&gt;], …
$ `_remitters`           &lt;list&gt; [&lt;data.frame[0 x 0]&gt;], [&lt;data.frame[0 x 0]&gt;], …
$ E18_months_no_water    &lt;list&gt; &lt;NULL&gt;, &lt;"Aug", "Sept"&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL…
$ F05_money_source       &lt;list&gt; &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;…
$ E_yes_group            &lt;list&gt; [&lt;data.frame[0 x 0]&gt;], [&lt;data.frame[3 x 14]&gt;],…
$ D_plots                &lt;list&gt; [&lt;data.frame[2 x 8]&gt;], [&lt;data.frame[3 x 8]&gt;], …
$ F_items                &lt;list&gt; [&lt;data.frame[3 x 3]&gt;], [&lt;data.frame[2 x 3]&gt;], …
$ F10_liv_owned          &lt;list&gt; "poultry", &lt;"oxen", "cows", "goats"&gt;, "none", …
$ F14_items_owned        &lt;list&gt; &lt;"bicycle", "television", "solar_panel", "tabl…
$ G02_months_lack_food   &lt;list&gt; "Jan", &lt;"Jan", "Sept", "Oct", "Nov", "Dec"&gt;, &lt;…
$ E22_res_change         &lt;list&gt; &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;…
$ `_members`             &lt;list&gt; [&lt;data.frame[3 x 12]&gt;], [&lt;data.frame[7 x 12]&gt;]…
$ G03_no_food_mitigation &lt;list&gt; &lt;"na", "rely_less_food", "reduce_meals", "day_…
$ E_no_group             &lt;list&gt; [&lt;data.frame[2 x 6]&gt;], [&lt;data.frame[0 x 0]&gt;], …</code></pre>
</div>
<p>So what can we do about <em>F_liv</em>, the column of dataframes?
Well first things first, we can access each one. For example to access
the dataframe in the first row, we can use the bracket (<code>[</code>)
subsetting. Here we use single bracket, but you could also use double
bracket (<code>[[</code>). The <code>[[</code> form allows only a single
element to be selected using integer or character indices, whereas
<code>[</code> allows indexing by vectors.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">json_data</span><span class="op">$</span><span class="va">F_liv</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[1]]
  F11_no_owned F_curr_liv
1            1    poultry</code></pre>
</div>
<p>We can also choose to view the nested dataframes at all the rows of
our main dataframe where a particular condition is met (for example
where the value for the variable <em>C06_rooms</em> is equal to 4):</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">json_data</span><span class="op">$</span><span class="va">F_liv</span><span class="op">[</span><span class="fu">which</span><span class="op">(</span><span class="va">json_data</span><span class="op">$</span><span class="va">C06_rooms</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[1]]
  F11_no_owned F_curr_liv
1            3       oxen
2            2       cows
3            5      goats

[[2]]
  F11_no_owned F_curr_liv
1            4       oxen
2            5       cows
3            3      goats

[[3]]
data frame with 0 columns and 0 rows

[[4]]
  F11_no_owned F_curr_liv
1            4       oxen
2            4       cows
3            4      goats
4            1      sheep

[[5]]
  F11_no_owned F_curr_liv
1            2       cows</code></pre>
</div>
</section><section><h2 class="section-heading" id="write-the-json-file-to-csv">Write the JSON file to csv<a class="anchor" aria-label="anchor" href="#write-the-json-file-to-csv"></a>
</h2>
<hr class="half-width">
<p>If we try to write our json_data dataframe to a csv as we would
usually in a regular dataframe, we won’t get the desired result. Using
the <code>write_csv</code> function from the <a href="https://readr.tidyverse.org" class="external-link">readr</a>
package won’t give you an error for list columns, but you’ll only see
missing (i.e. <code>NA</code>) values in these columns. Let’s try it out
to confirm:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">write_csv</span><span class="op">(</span><span class="va">json_data</span>, <span class="st">"json_data_with_list_columns.csv"</span><span class="op">)</span></span>
<span><span class="fu">read_csv</span><span class="op">(</span><span class="st">"json_data_with_list_columns.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p>To write out as a csv while maintaining the data within the list
columns, we will need to “flatten” these columns. One way to do this is
to convert these list columns into character types. (However, we don’t
want to change the data types for any of the other columns). Here’s one
way to do this using tidyverse. This command only applies the
<code>as.character</code> command to those columns ‘where’
<code>is.list</code> is <code>TRUE</code>.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flattened_json_data</span> <span class="op">&lt;-</span> <span class="va">json_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.list</span><span class="op">)</span>, <span class="va">as.character</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">flattened_json_data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 131 × 74
   C06_rooms B19_grand_liv A08_ward E01_water_use B18_sp_parents_liv
       &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;    &lt;chr&gt;         &lt;chr&gt;
 1         1 no            ward2    no            yes
 2         1 yes           ward2    yes           yes
 3         1 no            ward2    no            no
 4         1 no            ward2    no            no
 5         1 yes           ward2    no            no
 6         1 no            ward2    no            no
 7         1 yes           ward2    yes           no
 8         3 yes           ward1    yes           yes
 9         1 yes           ward2    yes           no
10         5 no            ward2    yes           no
# ℹ 121 more rows
# ℹ 69 more variables: B16_years_liv &lt;int&gt;, E_yes_group_count &lt;chr&gt;,
#   F_liv &lt;chr&gt;, `_note2` &lt;lgl&gt;, instanceID &lt;chr&gt;, B20_sp_grand_liv &lt;chr&gt;,
#   F10_liv_owned_other &lt;lgl&gt;, `_note1` &lt;lgl&gt;, F12_poultry &lt;chr&gt;,
#   D_plots_count &lt;chr&gt;, C02_respondent_wall_type_other &lt;lgl&gt;,
#   C02_respondent_wall_type &lt;chr&gt;, C05_buildings_in_compound &lt;int&gt;,
#   `_remitters` &lt;chr&gt;, E18_months_no_water &lt;chr&gt;, F07_use_income &lt;chr&gt;, …</code></pre>
</div>
<p>Now you can write this to a csv file:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">write_csv</span><span class="op">(</span><span class="va">flattened_json_data</span>, <span class="st">"data_output/json_data_with_flattened_list_columns.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p>Note: this means that when you read this csv back into R, the column
of the nested dataframes will now be read in as a character vector.
Converting it back to list to extract elements might be complicated, so
it is probably better to keep storing these data in a JSON format if you
will have to do this.</p>
<p>You can also write out the individual nested dataframes to a csv. For
example:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">write_csv</span><span class="op">(</span><span class="va">json_data</span><span class="op">$</span><span class="va">F_liv</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"data_output/F_liv_row1.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>JSON is a popular data format for transferring data used by a great
many Web based APIs</li>
<li>The complex structure of a JSON document means that it cannot easily
be ‘flattened’ into tabular data</li>
<li>We can use R code to extract values of interest and place them in a
csv file</li>
</ul>
</div>
</div>
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/datacarpentry/r-socialsci/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/datacarpentry/r-socialsci/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/datacarpentry/r-socialsci/" class="external-link">Source</a></p>
				<p><a href="https://github.com/datacarpentry/r-socialsci/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.12" class="external-link">sandpaper (0.16.12)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.6" class="external-link">varnish (1.0.6)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://datacarpentry.org/r-socialsci/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://datacarpentry.org/r-socialsci/instructor/aio.html",
  "identifier": "https://datacarpentry.org/r-socialsci/instructor/aio.html",
  "dateCreated": "2017-05-25",
  "dateModified": "2025-07-29",
  "datePublished": "2025-07-29"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

